<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="zh-cn" lang="zh-cn" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="keywords" content="Code:USACO/calfflac/C++" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="NOCOW (中文(简体))" />
<link title="Creative Commons" type="application/rdf+xml" href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;action=creativecommons" rel="meta" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
		<title>NOCOW - Code:USACO/calfflac/C++</title>
		<style type="text/css" media="screen,projection">/*<![CDATA[*/ @import "/skins/monobook/main.css?42b"; /*]]>*/</style>
		<link rel="stylesheet" type="text/css" media="print" href="/skins/common/commonPrint.css?42b" />
		<link rel="stylesheet" type="text/css" media="handheld" href="/skins/monobook/handheld.css?42b" />
		<!--[if lt IE 5.5000]><style type="text/css">@import "/skins/monobook/IE50Fixes.css?42b";</style><![endif]-->
		<!--[if IE 5.5000]><style type="text/css">@import "/skins/monobook/IE55Fixes.css?42b";</style><![endif]-->
		<!--[if IE 6]><style type="text/css">@import "/skins/monobook/IE60Fixes.css?42b";</style><![endif]-->
		<!--[if IE 7]><style type="text/css">@import "/skins/monobook/IE70Fixes.css?42b";</style><![endif]-->
		<!--[if lt IE 7]><script type="text/javascript" src="/skins/common/IEFixes.js?42b"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->
		
		<script type= "text/javascript">/*<![CDATA[*/
var skin = "monobook";
var stylepath = "/skins";
var wgArticlePath = "/index.php/$1";
var wgScriptPath = "";
var wgServer = "http://www.nocow.cn";
var wgCanonicalNamespace = "Code";
var wgCanonicalSpecialPageName = false;
var wgNamespaceNumber = 104;
var wgPageName = "Code:USACO/calfflac/C++";
var wgTitle = "USACO/calfflac/C++";
var wgArticleId = "2408";
var wgIsArticle = true;
var wgUserName = null;
var wgUserLanguage = "zh-cn";
var wgContentLanguage = "zh-cn";
var wgBreakFrames = false;
var wgCurRevisionId = "13824";
/*]]>*/</script>
                
		<script type="text/javascript" src="/skins/common/wikibits.js?42b"><!-- wikibits js --></script>
		<script type="text/javascript" src="/index.php?title=-&amp;action=raw&amp;gen=js"><!-- site js --></script>
		<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Common.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/index.php?title=MediaWiki:Monobook.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
@import "/index.php?title=-&action=raw&gen=css&maxage=18000";
/*]]>*/</style>
		<!-- Head Scripts -->
			</head>
<body  class="mediawiki ns-104 ltr page-Code_USACO_calfflac_C">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
<!--div style="text-align:center;font-size:85%;font-weight:bold" id=headlinemessage>NOCOW近期对条目的命名进行了一些整理，一些链接可能失效，为此带来的不便请大家谅解。创建条目时也请遵循新的命名规范，谢谢合作。</div-->
		<a name="top" id="top"></a>
				<h1 class="firstHeading">Code:USACO/calfflac/C++</h1>
		<div id="bodyContent">
			<h3 id="siteSub">来自&quot;NOCOW&quot;</h3>
			<div id="contentSub"></div>
									<div id="jump-to-nav">跳转到: <a href="#column-one">导航</a>, <a href="#searchInput">搜索</a></div>			<!-- start content -->
			<pre class="c"><span style="color: #808080; font-style: italic;">/*
ID: MasterRay
LANG: C++
TASK: calfflac
*/</span>
&nbsp;
<span style="color: #339933;">#include &lt;algorithm&gt;</span>
<span style="color: #339933;">#include &lt;cstdio&gt;</span>
using namespace std;
&nbsp;
<span style="color: #993333;">char</span> a<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">40002</span><span style="color: #66cc66;">&#93;</span>, b<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20001</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> arr<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">4</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">40002</span><span style="color: #66cc66;">&#93;</span>, h<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">40002</span><span style="color: #66cc66;">&#93;</span>, idx<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20000</span><span style="color: #66cc66;">&#93;</span>, *sa;
&nbsp;
<span style="color: #993333;">void</span> F<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">char</span> a<span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span>, <span style="color: #993333;">int</span> n<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> *rank = arr<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>, *nsa = arr<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#93;</span>, *cnt = arr<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">3</span><span style="color: #66cc66;">&#93;</span>;
	sa = arr<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>;
	fill_n<span style="color: #66cc66;">&#40;</span>cnt, <span style="color: #cc66cc;">256</span>, <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
		++cnt<span style="color: #66cc66;">&#91;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt; <span style="color: #cc66cc;">256</span>; ++i<span style="color: #66cc66;">&#41;</span>
		cnt<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> += cnt<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = n; --i &gt;= <span style="color: #cc66cc;">0</span>; <span style="color: #66cc66;">&#41;</span>
		sa<span style="color: #66cc66;">&#91;</span>--cnt<span style="color: #66cc66;">&#91;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = i;
	rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= a<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
			++rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> k = <span style="color: #cc66cc;">1</span>; k &lt; n &amp;&amp; rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>n<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= n<span style="color: #cc66cc;">-1</span>; k *= <span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
			cnt<span style="color: #66cc66;">&#91;</span>rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = i;
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = n; --i &gt;= <span style="color: #cc66cc;">0</span>; <span style="color: #66cc66;">&#41;</span>
			<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &gt;= k<span style="color: #66cc66;">&#41;</span>
				nsa<span style="color: #66cc66;">&#91;</span>cnt<span style="color: #66cc66;">&#91;</span>rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>-k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>--<span style="color: #66cc66;">&#93;</span> = sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>-k;
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = n-k; i &lt; n-k/<span style="color: #cc66cc;">2</span>; ++i<span style="color: #66cc66;">&#41;</span>
			nsa<span style="color: #66cc66;">&#91;</span>cnt<span style="color: #66cc66;">&#91;</span>rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = i;
		swap<span style="color: #66cc66;">&#40;</span>sa, nsa<span style="color: #66cc66;">&#41;</span>;
		cnt<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #cc66cc;">0</span>;
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			cnt<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = cnt<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
			<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> || rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>+k<span style="color: #66cc66;">&#93;</span>&nbsp;!= rank<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>+k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
				++cnt<span style="color: #66cc66;">&#91;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
		<span style="color: #66cc66;">&#125;</span>
		swap<span style="color: #66cc66;">&#40;</span>rank, cnt<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #66cc66;">&#125;</span>
	h<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span> = <span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> k = <span style="color: #cc66cc;">0</span>, i = <span style="color: #cc66cc;">0</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> j = sa<span style="color: #66cc66;">&#91;</span>rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>; a<span style="color: #66cc66;">&#91;</span>j+k<span style="color: #66cc66;">&#93;</span> == a<span style="color: #66cc66;">&#91;</span>i+k<span style="color: #66cc66;">&#93;</span>; ++k<span style="color: #66cc66;">&#41;</span>;
			h<span style="color: #66cc66;">&#91;</span>rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = k;
			<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>k<span style="color: #66cc66;">&#41;</span> --k;
		<span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> main<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	freopen<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.in&quot;</span>, <span style="color: #ff0000;">&quot;r&quot;</span>, stdin<span style="color: #66cc66;">&#41;</span>;
	freopen<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.out&quot;</span>, <span style="color: #ff0000;">&quot;w&quot;</span>, stdout<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #993333;">int</span> size = <span style="color: #cc66cc;">0</span>, n, max_h = <span style="color: #cc66cc;">0</span>, res = <span style="color: #cc66cc;">-1</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; <span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> = getchar<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>&nbsp;!= EOF; ++i<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; b<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>; ++i<span style="color: #66cc66;">&#41;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>isalpha<span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			a<span style="color: #66cc66;">&#91;</span>size<span style="color: #66cc66;">&#93;</span> = tolower<span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
			idx<span style="color: #66cc66;">&#91;</span>size++<span style="color: #66cc66;">&#93;</span> = i;
		<span style="color: #66cc66;">&#125;</span>
	n = size*<span style="color: #cc66cc;">2</span><span style="color: #cc66cc;">+2</span>;
	a<span style="color: #66cc66;">&#91;</span>size<span style="color: #66cc66;">&#93;</span> = <span style="color: #ff0000;">'<span style="color: #000099; font-weight: bold;">\1</span>'</span>;
	reverse_copy<span style="color: #66cc66;">&#40;</span>a, a+size, a+size<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #808080; font-style: italic;">//a[n] = '\0';</span>
	F<span style="color: #66cc66;">&#40;</span>a, n<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt; n; ++i<span style="color: #66cc66;">&#41;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &lt; size<span style="color: #66cc66;">&#41;</span> ^ <span style="color: #66cc66;">&#40;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span> &lt; size<span style="color: #66cc66;">&#41;</span>
			&amp;&amp; <span style="color: #66cc66;">&#40;</span>h<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &gt; max_h || h<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> == max_h &amp;&amp; min<span style="color: #66cc66;">&#40;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>, sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span> &lt; res<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
			max_h = h<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>, res = min<span style="color: #66cc66;">&#40;</span>sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>, sa<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
	<a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a><span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;%d<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>, max_h<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span>res = idx<span style="color: #66cc66;">&#91;</span>res<span style="color: #66cc66;">&#93;</span>; max_h; ++res<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		putchar<span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>res<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>isalpha<span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>res<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> --max_h;
	<span style="color: #66cc66;">&#125;</span>
	putchar<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'<span style="color: #000099; font-weight: bold;">\n</span>'</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span></pre>
程序一:<pre class="c"><span style="color: #808080; font-style: italic;">/*
    ID&nbsp;: Your ID
    PROG&nbsp;: calfflac
    LANG&nbsp;: C++
*/</span>
<span style="color: #339933;">#include &lt;iostream&gt;</span>
<span style="color: #339933;">#include &lt;stdio.h&gt;</span>
<span style="color: #993333;">char</span> a<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20001</span><span style="color: #66cc66;">&#93;</span>, b<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20001</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> n, m, t<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20001</span><span style="color: #66cc66;">&#93;</span>, left, right, max;
<span style="color: #993333;">void</span> check<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> l, <span style="color: #993333;">int</span> r<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
     <span style="color: #b1b100;">while</span> <span style="color: #66cc66;">&#40;</span>l &gt;= <span style="color: #cc66cc;">1</span> &amp;&amp; r &lt;= n<span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
        <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>b<span style="color: #66cc66;">&#91;</span>l<span style="color: #66cc66;">&#93;</span> == b<span style="color: #66cc66;">&#91;</span>r<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
        <span style="color: #66cc66;">&#123;</span>
           l--; r++;
        <span style="color: #66cc66;">&#125;</span>
        <span style="color: #b1b100;">else</span> <span style="color: #000000; font-weight: bold;">break</span>;
     <span style="color: #66cc66;">&#125;</span>
     <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>r - l - <span style="color: #cc66cc;">1</span> &gt; max<span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
        max = r - l - <span style="color: #cc66cc;">1</span>;
        left = t<span style="color: #66cc66;">&#91;</span>l + <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;
        right = t<span style="color: #66cc66;">&#91;</span>r - <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;
     <span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span>
<span style="color: #993333;">int</span> main<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">void</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
    freopen <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.in&quot;</span>, <span style="color: #ff0000;">&quot;r&quot;</span>,  stdin<span style="color: #66cc66;">&#41;</span>;
    freopen <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.out&quot;</span>, <span style="color: #ff0000;">&quot;w&quot;</span>, stdout<span style="color: #66cc66;">&#41;</span>;
    <span style="color: #993333;">char</span> ch;
    <span style="color: #b1b100;">while</span> <span style="color: #66cc66;">&#40;</span>scanf <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;%c&quot;</span>, &amp;ch<span style="color: #66cc66;">&#41;</span>&nbsp;!= EOF<span style="color: #66cc66;">&#41;</span>
    <span style="color: #66cc66;">&#123;</span>
       n++;
       a<span style="color: #66cc66;">&#91;</span>n<span style="color: #66cc66;">&#93;</span> = ch;
    <span style="color: #66cc66;">&#125;</span>
    <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt;= n; i++<span style="color: #66cc66;">&#41;</span>
      <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &gt;= <span style="color: #ff0000;">'a'</span> &amp;&amp; a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &lt;= <span style="color: #ff0000;">'z'</span><span style="color: #66cc66;">&#41;</span> || <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &gt;= <span style="color: #ff0000;">'A'</span> &amp;&amp; a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &lt;= <span style="color: #ff0000;">'Z'</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
         <span style="color: #66cc66;">&#123;</span>
            m++;
            <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &gt;= <span style="color: #cc66cc;">97</span><span style="color: #66cc66;">&#41;</span> b<span style="color: #66cc66;">&#91;</span>m<span style="color: #66cc66;">&#93;</span> = a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> - <span style="color: #cc66cc;">32</span>;
            <span style="color: #b1b100;">else</span> b<span style="color: #66cc66;">&#91;</span>m<span style="color: #66cc66;">&#93;</span> = a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>;
            t<span style="color: #66cc66;">&#91;</span>m<span style="color: #66cc66;">&#93;</span> = i;
         <span style="color: #66cc66;">&#125;</span>
    <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">1</span>; i &lt;= m; i++<span style="color: #66cc66;">&#41;</span>
      <span style="color: #66cc66;">&#123;</span>
          check<span style="color: #66cc66;">&#40;</span>i - <span style="color: #cc66cc;">1</span>, i + <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span>;
          check<span style="color: #66cc66;">&#40;</span>i, i + <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span>;
      <span style="color: #66cc66;">&#125;</span>
   <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;%d<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span>, max<span style="color: #66cc66;">&#41;</span>;
   <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = left; i &lt;= right; i++<span style="color: #66cc66;">&#41;</span>
     <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;%c&quot;</span>, a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
   <a href="http://www.opengroup.org/onlinepubs/009695399/functions/printf.html"><span style="color: #000066;">printf</span></a> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;<span style="color: #000099; font-weight: bold;">\n</span>&quot;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span></pre>
程序二：（猥琐之人所写，可以无视）<pre class="c"><span style="color: #808080; font-style: italic;">/*
TASK:calfflac
LANG:C++
*/</span>
<span style="color: #339933;">#include &lt;fstream&gt;</span>
<span style="color: #339933;">#include &lt;sstream&gt;</span>
<span style="color: #339933;">#include &lt;string&gt;</span>
<span style="color: #339933;">#include &lt;cstring&gt;</span>
<span style="color: #339933;">#include &lt;climits&gt;</span>
<span style="color: #339933;">#include &lt;algorithm&gt;</span>
&nbsp;
<span style="color: #339933;">#define Maxn 50000</span>
<span style="color: #339933;">#define Maxm 16</span>
<span style="color: #339933;">#define Maxb 10000</span>
<span style="color: #339933;">#define Fin &quot;calfflac.in&quot;</span>
<span style="color: #339933;">#define Fout &quot;calfflac.out&quot;</span>
&nbsp;
using namespace std;
ifstream fin<span style="color: #66cc66;">&#40;</span>Fin<span style="color: #66cc66;">&#41;</span>;
ofstream fout<span style="color: #66cc66;">&#40;</span>Fout<span style="color: #66cc66;">&#41;</span>;
&nbsp;
<span style="color: #993333;">int</span> Left<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Right<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,A<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Stack<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Posi<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> s<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,SA<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Rank<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,h<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Height<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> Log2n<span style="color: #66cc66;">&#91;</span>Maxb<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,Kind<span style="color: #66cc66;">&#91;</span>Maxb<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> Block<span style="color: #66cc66;">&#91;</span>Maxb<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>Maxm<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> Q<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">10000</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">13</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">13</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> Temp<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">13</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> Eular<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span>*Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,D<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span>*Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> n,Count,Head,SOpen,l,b;
&nbsp;
<span style="color: #993333;">int</span> Min<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> a,<span style="color: #993333;">int</span> b<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> Push<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">int</span> Top<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">int</span> Pop<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> BuildCT<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> DFS<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> X,<span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> Init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> Work<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> InitInRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x,<span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">void</span> InitSTBlock<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">int</span> GetBlockRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">int</span> GetInRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x,<span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>;
<span style="color: #993333;">int</span> GetRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>;
&nbsp;
<span style="color: #993333;">int</span> GetInRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x,<span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> GetInRmq;
	GetInRmq=Q<span style="color: #66cc66;">&#91;</span>Kind<span style="color: #66cc66;">&#91;</span>x<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>s<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>t<span style="color: #66cc66;">&#93;</span>;
	<span style="color: #b1b100;">return</span> GetInRmq;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> GetBlockRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">long</span> GetBlockRmq;
	<span style="color: #993333;">long</span> Len;
	Len=Log2n<span style="color: #66cc66;">&#91;</span>t-s<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
	GetBlockRmq=Min<span style="color: #66cc66;">&#40;</span>Block<span style="color: #66cc66;">&#91;</span>s<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>Len<span style="color: #66cc66;">&#93;</span>,Block<span style="color: #66cc66;">&#91;</span>t-<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;Len<span style="color: #66cc66;">&#41;</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>Len<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">return</span> GetBlockRmq;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> InitSTBlock<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">long</span> i,j,t,M=<span style="color: #cc66cc;">0</span>;
	l=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;l<span style="color: #66cc66;">&#41;</span>&lt;=Count<span style="color: #66cc66;">&#41;</span>
		l++;
	l--;
	l=l/<span style="color: #cc66cc;">2</span>;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>l==<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>
		l=<span style="color: #cc66cc;">1</span>;
	t=<span style="color: #cc66cc;">0</span>;
	b=<span style="color: #cc66cc;">1</span>;
	D<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=LONG_MAX;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>;i&lt;=Count;i++<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>t==l<span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			Block<span style="color: #66cc66;">&#91;</span>b<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=A<span style="color: #66cc66;">&#91;</span>Eular<span style="color: #66cc66;">&#91;</span>M<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
			t=<span style="color: #cc66cc;">0</span>;
			b++;
			M=<span style="color: #cc66cc;">0</span>;
		<span style="color: #66cc66;">&#125;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>D<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>&lt;D<span style="color: #66cc66;">&#91;</span>M<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
			M=i;
		t++;
	<span style="color: #66cc66;">&#125;</span>
	Block<span style="color: #66cc66;">&#91;</span>b<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=M;
	t=<span style="color: #cc66cc;">1</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;t<span style="color: #66cc66;">&#41;</span><span style="color: #cc66cc;">-1</span>&lt;=b<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>&lt;&lt;<span style="color: #66cc66;">&#40;</span>t<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>;i&lt;=<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;t<span style="color: #66cc66;">&#41;</span><span style="color: #cc66cc;">-1</span>;i++<span style="color: #66cc66;">&#41;</span>
			Log2n<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=t<span style="color: #cc66cc;">-1</span>;
		t++;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>&lt;&lt;<span style="color: #66cc66;">&#40;</span>t<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>;i&lt;=b;i++<span style="color: #66cc66;">&#41;</span>
		Log2n<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=t<span style="color: #cc66cc;">-1</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>;i&lt;=t;i++<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>j=<span style="color: #cc66cc;">1</span>;j&lt;=b-<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;i<span style="color: #66cc66;">&#41;</span><span style="color: #cc66cc;">+1</span>;j++<span style="color: #66cc66;">&#41;</span>
			Block<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=Min<span style="color: #66cc66;">&#40;</span>Block<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>,Block<span style="color: #66cc66;">&#91;</span>j+<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span>&lt;&lt;<span style="color: #66cc66;">&#40;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #66cc66;">&#125;</span>
	Temp<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=LONG_MAX;
	InitInRmq<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">2</span>,<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>;
	M=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>;i&lt;=b<span style="color: #cc66cc;">-1</span>;i++<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		t=<span style="color: #cc66cc;">0</span>;
		<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>j=<span style="color: #cc66cc;">1</span>;j&lt;=l<span style="color: #cc66cc;">-1</span>;j++<span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			t=t*<span style="color: #cc66cc;">2</span>;
			<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>D<span style="color: #66cc66;">&#91;</span>M+j<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>&gt;D<span style="color: #66cc66;">&#91;</span>M+j<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
				t++;
		<span style="color: #66cc66;">&#125;</span>
		Kind<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=t;
		M+=l;
	<span style="color: #66cc66;">&#125;</span>
	t=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>j=M<span style="color: #cc66cc;">+1</span>;j&lt;=Count<span style="color: #cc66cc;">-1</span>;j++<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		t=t*<span style="color: #cc66cc;">2</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>D<span style="color: #66cc66;">&#91;</span>j<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>&gt;D<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
			t++;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>j=Count;j&lt;=M+l<span style="color: #cc66cc;">-1</span>;j++<span style="color: #66cc66;">&#41;</span>
		t=t*<span style="color: #cc66cc;">2</span>;
	Kind<span style="color: #66cc66;">&#91;</span>b<span style="color: #66cc66;">&#93;</span>=t;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> InitInRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x,<span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>x==l<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#41;</span>
		Work<span style="color: #66cc66;">&#40;</span>w<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">else</span>
	<span style="color: #66cc66;">&#123;</span>
		Temp<span style="color: #66cc66;">&#91;</span>x<span style="color: #66cc66;">&#93;</span>=Temp<span style="color: #66cc66;">&#91;</span>x<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span>;
		InitInRmq<span style="color: #66cc66;">&#40;</span>x<span style="color: #cc66cc;">+1</span>,w*<span style="color: #cc66cc;">2</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#41;</span>;
		Temp<span style="color: #66cc66;">&#91;</span>x<span style="color: #66cc66;">&#93;</span>=Temp<span style="color: #66cc66;">&#91;</span>x<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">-1</span>;
		InitInRmq<span style="color: #66cc66;">&#40;</span>x<span style="color: #cc66cc;">+1</span>,w*<span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> Work<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> i,j,M;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>;i&lt;=l;i++<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		M=<span style="color: #cc66cc;">0</span>;
		<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>j=i;j&lt;=l;j++<span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>Temp<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span>&lt;Temp<span style="color: #66cc66;">&#91;</span>M<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
				M=j;
			Q<span style="color: #66cc66;">&#91;</span>w<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span>=M;
		<span style="color: #66cc66;">&#125;</span>
	<span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> sx<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> sw<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #993333;">int</span> sn<span style="color: #66cc66;">&#91;</span>Maxn<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
&nbsp;
<span style="color: #993333;">void</span> DFS<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> X,<span style="color: #993333;">int</span> w<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	sx<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=X;sw<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=w;sn<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;
	<span style="color: #993333;">int</span> dep=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span>dep&gt;=<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">switch</span><span style="color: #66cc66;">&#40;</span>dep<span style="color: #66cc66;">&#91;</span>sn<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			<span style="color: #b1b100;">case</span> <span style="color: #cc66cc;">1</span>:<span style="color: #b1b100;">goto</span> label1;
			<span style="color: #b1b100;">case</span> <span style="color: #cc66cc;">2</span>:<span style="color: #b1b100;">goto</span> label2;
		<span style="color: #66cc66;">&#125;</span>
		Count++;
		Eular<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
		D<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>Posi<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>==<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>
			Posi<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>=Count;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>Left<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&gt;<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=Left<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
			sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span>;
			sn<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">1</span>;sn<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;dep++;
			<span style="color: #b1b100;">continue</span>;
label1:     Count++;
			Eular<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
			D<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
		<span style="color: #66cc66;">&#125;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>Right<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&gt;<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=Right<span style="color: #66cc66;">&#91;</span>sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
			sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span>;
			sn<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">2</span>;sn<span style="color: #66cc66;">&#91;</span>dep<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;dep++;
			<span style="color: #b1b100;">continue</span>;
label2:     Count++;
			Eular<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sx<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
			D<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=sw<span style="color: #66cc66;">&#91;</span>dep<span style="color: #66cc66;">&#93;</span>;
		<span style="color: #66cc66;">&#125;</span>
		dep--;
	<span style="color: #66cc66;">&#125;</span>
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> BuildCT<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> P;
	P=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span>A<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>&lt;A<span style="color: #66cc66;">&#91;</span>Top<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>&amp;&amp;<span style="color: #66cc66;">&#40;</span>SOpen&gt;<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
		P=Pop<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	Right<span style="color: #66cc66;">&#91;</span>Top<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#93;</span>=Count;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>P!=<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>P==Head<span style="color: #66cc66;">&#41;</span>
			Head=Count;
		Left<span style="color: #66cc66;">&#91;</span>Count<span style="color: #66cc66;">&#93;</span>=P;
	<span style="color: #66cc66;">&#125;</span>
	Push<span style="color: #66cc66;">&#40;</span>Count<span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> Pop<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> Pop;
	Pop=Stack<span style="color: #66cc66;">&#91;</span>SOpen<span style="color: #66cc66;">&#93;</span>;
	SOpen--;
	<span style="color: #b1b100;">return</span> Pop;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> Top<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> Top;
	Top=Stack<span style="color: #66cc66;">&#91;</span>SOpen<span style="color: #66cc66;">&#93;</span>;
	<span style="color: #b1b100;">return</span> Top;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> Push<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> x<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	SOpen++;
	Stack<span style="color: #66cc66;">&#91;</span>SOpen<span style="color: #66cc66;">&#93;</span>=x;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> Min<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> a,<span style="color: #993333;">int</span> b<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> Min;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>a&lt;b<span style="color: #66cc66;">&#41;</span>
		Min=a;
	<span style="color: #b1b100;">else</span>
		Min=b;
	<span style="color: #b1b100;">return</span> Min;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">inline</span> bool leq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> a1, <span style="color: #993333;">int</span> a2, <span style="color: #993333;">int</span> b1, <span style="color: #993333;">int</span> b2<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">// lexicographic order</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #b1b100;">return</span><span style="color: #66cc66;">&#40;</span>a1 &lt; b1 || a1 == b1 &amp;&amp; a2 &lt;= b2<span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span> <span style="color: #808080; font-style: italic;">// for pairs</span>
&nbsp;
<span style="color: #000000; font-weight: bold;">inline</span> bool leq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> a1, <span style="color: #993333;">int</span> a2, <span style="color: #993333;">int</span> a3, <span style="color: #993333;">int</span> b1, <span style="color: #993333;">int</span> b2, <span style="color: #993333;">int</span> b3<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #b1b100;">return</span><span style="color: #66cc66;">&#40;</span>a1 &lt; b1 || a1 == b1 &amp;&amp; leq<span style="color: #66cc66;">&#40;</span>a2,a3, b2,b3<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span> <span style="color: #808080; font-style: italic;">// and triples</span>
&nbsp;
<span style="color: #808080; font-style: italic;">// stably sort a[0..n-1] to b[0..n-1] with keys in 0..K from r</span>
<span style="color: #993333;">static</span> <span style="color: #993333;">void</span> radixPass<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span>* a, <span style="color: #993333;">int</span>* b, <span style="color: #993333;">int</span>* r, <span style="color: #993333;">int</span> n, <span style="color: #993333;">int</span> K<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #808080; font-style: italic;">// count occurrences</span>
	<span style="color: #993333;">int</span>* c = new <span style="color: #993333;">int</span><span style="color: #66cc66;">&#91;</span>K + <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>; <span style="color: #808080; font-style: italic;">// counter array</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt;= K; i++<span style="color: #66cc66;">&#41;</span> c<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> = <span style="color: #cc66cc;">0</span>; <span style="color: #808080; font-style: italic;">// reset counters</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n; i++<span style="color: #66cc66;">&#41;</span> c<span style="color: #66cc66;">&#91;</span>r<span style="color: #66cc66;">&#91;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>++; <span style="color: #808080; font-style: italic;">// count occurrences</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>, sum = <span style="color: #cc66cc;">0</span>; i &lt;= K; i++<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">// exclusive prefix sums</span>
	<span style="color: #66cc66;">&#123;</span>
		<span style="color: #993333;">int</span> t = c<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>; c<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> = sum; sum += t;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n; i++<span style="color: #66cc66;">&#41;</span> b<span style="color: #66cc66;">&#91;</span>c<span style="color: #66cc66;">&#91;</span>r<span style="color: #66cc66;">&#91;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>++<span style="color: #66cc66;">&#93;</span> = a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>; <span style="color: #808080; font-style: italic;">// sort</span>
	delete <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> c;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #808080; font-style: italic;">// find the suffix array SA of T[0..n-1] in {1..K}^n</span>
<span style="color: #808080; font-style: italic;">// require T[n]=T[n+1]=T[n+2]=0, n&gt;=2</span>
<span style="color: #993333;">void</span> suffixArray<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span>* T, <span style="color: #993333;">int</span>* SA, <span style="color: #993333;">int</span> n, <span style="color: #993333;">int</span> K<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
&nbsp;
	<span style="color: #993333;">int</span> n0=<span style="color: #66cc66;">&#40;</span>n<span style="color: #cc66cc;">+2</span><span style="color: #66cc66;">&#41;</span>/<span style="color: #cc66cc;">3</span>, n1=<span style="color: #66cc66;">&#40;</span>n<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#41;</span>/<span style="color: #cc66cc;">3</span>, n2=n/<span style="color: #cc66cc;">3</span>, n02=n0+n2;
	<span style="color: #993333;">int</span>* R = new <span style="color: #993333;">int</span><span style="color: #66cc66;">&#91;</span>n02 + <span style="color: #cc66cc;">3</span><span style="color: #66cc66;">&#93;</span>; R<span style="color: #66cc66;">&#91;</span>n02<span style="color: #66cc66;">&#93;</span>= R<span style="color: #66cc66;">&#91;</span>n02<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>= R<span style="color: #66cc66;">&#91;</span>n02<span style="color: #cc66cc;">+2</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;
	<span style="color: #993333;">int</span>* SA12 = new <span style="color: #993333;">int</span><span style="color: #66cc66;">&#91;</span>n02 + <span style="color: #cc66cc;">3</span><span style="color: #66cc66;">&#93;</span>; SA12<span style="color: #66cc66;">&#91;</span>n02<span style="color: #66cc66;">&#93;</span>=SA12<span style="color: #66cc66;">&#91;</span>n02<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=SA12<span style="color: #66cc66;">&#91;</span>n02<span style="color: #cc66cc;">+2</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;
	<span style="color: #993333;">int</span>* R0 = new <span style="color: #993333;">int</span><span style="color: #66cc66;">&#91;</span>n0<span style="color: #66cc66;">&#93;</span>;
	<span style="color: #993333;">int</span>* SA0 = new <span style="color: #993333;">int</span><span style="color: #66cc66;">&#91;</span>n0<span style="color: #66cc66;">&#93;</span>;
&nbsp;
	<span style="color: #808080; font-style: italic;">//******* Step 0: Construct sample ********</span>
	<span style="color: #808080; font-style: italic;">// generate positions of mod 1 and mod 2 suffixes</span>
	<span style="color: #808080; font-style: italic;">// the &quot;+(n0-n1)&quot; adds a dummy mod 1 suffix if n%3 == 1</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">0</span>, j=<span style="color: #cc66cc;">0</span>; i &lt; n+<span style="color: #66cc66;">&#40;</span>n0-n1<span style="color: #66cc66;">&#41;</span>; i++<span style="color: #66cc66;">&#41;</span> <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>i%<span style="color: #cc66cc;">3</span>&nbsp;!= <span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span> R<span style="color: #66cc66;">&#91;</span>j++<span style="color: #66cc66;">&#93;</span> = i;
&nbsp;
	<span style="color: #808080; font-style: italic;">//******* Step 1: Sort sample suffixes ********</span>
	<span style="color: #808080; font-style: italic;">// lsb radix sort the mod 1 and mod 2 triples</span>
	radixPass<span style="color: #66cc66;">&#40;</span>R , SA12, T<span style="color: #cc66cc;">+2</span>, n02, K<span style="color: #66cc66;">&#41;</span>;
	radixPass<span style="color: #66cc66;">&#40;</span>SA12, R , T<span style="color: #cc66cc;">+1</span>, n02, K<span style="color: #66cc66;">&#41;</span>;
	radixPass<span style="color: #66cc66;">&#40;</span>R , SA12, T , n02, K<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #808080; font-style: italic;">// find lexicographic names of triples and</span>
	<span style="color: #808080; font-style: italic;">// write them to correct places in R</span>
&nbsp;
	<span style="color: #993333;">int</span> name = <span style="color: #cc66cc;">0</span>, c0 = <span style="color: #cc66cc;">-1</span>, c1 = <span style="color: #cc66cc;">-1</span>, c2 = <span style="color: #cc66cc;">-1</span>;
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n02; i++<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= c0 || T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= c1 || T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+2</span><span style="color: #66cc66;">&#93;</span>&nbsp;!= c2<span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span>
			name++; c0 = T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>; c1 = T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>; c2 = T<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+2</span><span style="color: #66cc66;">&#93;</span>;
		<span style="color: #66cc66;">&#125;</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> % <span style="color: #cc66cc;">3</span> == <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span> R<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>/<span style="color: #cc66cc;">3</span><span style="color: #66cc66;">&#93;</span> = name; <span style="color: #66cc66;">&#125;</span> <span style="color: #808080; font-style: italic;">// write to R1</span>
		<span style="color: #b1b100;">else</span> <span style="color: #66cc66;">&#123;</span>
			R<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>/<span style="color: #cc66cc;">3</span> + n0<span style="color: #66cc66;">&#93;</span> = name;
		<span style="color: #66cc66;">&#125;</span> <span style="color: #808080; font-style: italic;">// write to R2</span>
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #808080; font-style: italic;">// recurse if names are not yet unique</span>
	<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>name &lt; n02<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
		suffixArray<span style="color: #66cc66;">&#40;</span>R, SA12, n02, name<span style="color: #66cc66;">&#41;</span>;
		<span style="color: #808080; font-style: italic;">// store unique names in R using the suffix array</span>
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n02; i++<span style="color: #66cc66;">&#41;</span> R<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span> = i + <span style="color: #cc66cc;">1</span>;
	<span style="color: #66cc66;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #808080; font-style: italic;">// generate the suffix array of R directly</span>
		<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i = <span style="color: #cc66cc;">0</span>; i &lt; n02; i++<span style="color: #66cc66;">&#41;</span> SA12<span style="color: #66cc66;">&#91;</span>R<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> - <span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span> = i;
&nbsp;
	<span style="color: #808080; font-style: italic;">//******* Step 2: Sort nonsample suffixes ********</span>
	<span style="color: #808080; font-style: italic;">// stably sort the mod 0 suffixes from SA12 by their first character</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">0</span>, j=<span style="color: #cc66cc;">0</span>; i &lt; n02; i++<span style="color: #66cc66;">&#41;</span> <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &lt; n0<span style="color: #66cc66;">&#41;</span> R0<span style="color: #66cc66;">&#91;</span>j++<span style="color: #66cc66;">&#93;</span> = <span style="color: #cc66cc;">3</span>*SA12<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>;
	radixPass<span style="color: #66cc66;">&#40;</span>R0, SA0, T, n0, K<span style="color: #66cc66;">&#41;</span>;
&nbsp;
	<span style="color: #808080; font-style: italic;">//******* Step 3: Merge ********</span>
	<span style="color: #808080; font-style: italic;">// merge sorted SA0 suffixes and sorted SA12 suffixes</span>
	<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> p=<span style="color: #cc66cc;">0</span>, t=n0-n1, k=<span style="color: #cc66cc;">0</span>; k &lt; n; k++<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
<span style="color: #339933;">#define GetI() (SA12[t] &lt; n0&nbsp;? SA12[t] * 3 + 1&nbsp;: (SA12[t] - n0) * 3 + 2)</span>
		<span style="color: #993333;">int</span> i = GetI<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>; <span style="color: #808080; font-style: italic;">// pos of current offset 12 suffix</span>
		<span style="color: #993333;">int</span> j = SA0<span style="color: #66cc66;">&#91;</span>p<span style="color: #66cc66;">&#93;</span>; <span style="color: #808080; font-style: italic;">// pos of current offset 0 suffix</span>
		<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>SA12<span style="color: #66cc66;">&#91;</span>t<span style="color: #66cc66;">&#93;</span> &lt; n0&nbsp;? <span style="color: #808080; font-style: italic;">// different compares for mod 1 and mod 2 suffixes</span>
			leq<span style="color: #66cc66;">&#40;</span>T<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>, R<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>t<span style="color: #66cc66;">&#93;</span> + n0<span style="color: #66cc66;">&#93;</span>, T<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span>, R<span style="color: #66cc66;">&#91;</span>j/<span style="color: #cc66cc;">3</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>&nbsp;:
		leq<span style="color: #66cc66;">&#40;</span>T<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>,T<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,R<span style="color: #66cc66;">&#91;</span>SA12<span style="color: #66cc66;">&#91;</span>t<span style="color: #66cc66;">&#93;</span>-n0<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>, T<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span>,T<span style="color: #66cc66;">&#91;</span>j<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>,R<span style="color: #66cc66;">&#91;</span>j/<span style="color: #cc66cc;">3</span>+n0<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
		<span style="color: #66cc66;">&#123;</span> <span style="color: #808080; font-style: italic;">// suffix from SA12 is smaller</span>
			SA<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> = i; t++;
			<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>t == n02<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">// done --- only SA0 suffixes left</span>
				<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span>k++; p &lt; n0; p++, k++<span style="color: #66cc66;">&#41;</span> SA<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> = SA0<span style="color: #66cc66;">&#91;</span>p<span style="color: #66cc66;">&#93;</span>;
		<span style="color: #66cc66;">&#125;</span> <span style="color: #b1b100;">else</span> <span style="color: #66cc66;">&#123;</span> <span style="color: #808080; font-style: italic;">// suffix from SA0 is smaller</span>
			SA<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> = j; p++;
			<span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>p == n0<span style="color: #66cc66;">&#41;</span> <span style="color: #808080; font-style: italic;">// done --- only SA12 suffixes left</span>
				<span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span>k++; t &lt; n02; t++, k++<span style="color: #66cc66;">&#41;</span> SA<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span> = GetI<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #66cc66;">&#125;</span>
	<span style="color: #66cc66;">&#125;</span>
	delete <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> R; delete <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> SA12; delete <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> SA0; delete <span style="color: #66cc66;">&#91;</span><span style="color: #66cc66;">&#93;</span> R0;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> Init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	memset<span style="color: #66cc66;">&#40;</span>Q,<span style="color: #cc66cc;">0</span>,<span style="color: #993333;">sizeof</span><span style="color: #66cc66;">&#40;</span>Q<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #993333;">int</span> i;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>i=<span style="color: #cc66cc;">1</span>;i&lt;=n;i++<span style="color: #66cc66;">&#41;</span>
		A<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=Height<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>;
	Count=<span style="color: #cc66cc;">0</span>;
	Head=<span style="color: #cc66cc;">1</span>;
	Push<span style="color: #66cc66;">&#40;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span>Count=<span style="color: #cc66cc;">2</span>;Count&lt;=n;Count++<span style="color: #66cc66;">&#41;</span>
		BuildCT<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	Count=<span style="color: #cc66cc;">0</span>;
	DFS<span style="color: #66cc66;">&#40;</span>Head,<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> GetRmq<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> s,<span style="color: #993333;">int</span> t<span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">int</span> i,bs,bt,tb,tl,tr,x;
	s=Posi<span style="color: #66cc66;">&#91;</span>s<span style="color: #66cc66;">&#93;</span>;
	t=Posi<span style="color: #66cc66;">&#91;</span>t<span style="color: #66cc66;">&#93;</span>;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>s&gt;t<span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		bs=s;
		s=t;
		t=bs;
	<span style="color: #66cc66;">&#125;</span>
	bs=<span style="color: #66cc66;">&#40;</span>s<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>/l<span style="color: #cc66cc;">+2</span>;
	bt=<span style="color: #66cc66;">&#40;</span>t<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>/l;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>bs&lt;=bt<span style="color: #66cc66;">&#41;</span>
		tb=GetBlockRmq<span style="color: #66cc66;">&#40;</span>bs,bt<span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">else</span>
		tb=INT_MAX;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>bs&lt;=bt<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#41;</span>
	<span style="color: #66cc66;">&#123;</span>
		tl=A<span style="color: #66cc66;">&#91;</span>Eular<span style="color: #66cc66;">&#91;</span>GetInRmq<span style="color: #66cc66;">&#40;</span>bs<span style="color: #cc66cc;">-1</span>,s-<span style="color: #66cc66;">&#40;</span>bs<span style="color: #cc66cc;">-2</span><span style="color: #66cc66;">&#41;</span>*l,l<span style="color: #66cc66;">&#41;</span>+<span style="color: #66cc66;">&#40;</span>bs<span style="color: #cc66cc;">-2</span><span style="color: #66cc66;">&#41;</span>*l<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
		tr=A<span style="color: #66cc66;">&#91;</span>Eular<span style="color: #66cc66;">&#91;</span>GetInRmq<span style="color: #66cc66;">&#40;</span>bt<span style="color: #cc66cc;">+1</span>,<span style="color: #cc66cc;">1</span>,t-bt*l<span style="color: #66cc66;">&#41;</span>+bt*l<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">else</span>
	<span style="color: #66cc66;">&#123;</span>
		tl=INT_MAX;
		tr=A<span style="color: #66cc66;">&#91;</span>Eular<span style="color: #66cc66;">&#91;</span>GetInRmq<span style="color: #66cc66;">&#40;</span>bt<span style="color: #cc66cc;">+1</span>,s-bt*l,t-bt*l<span style="color: #66cc66;">&#41;</span>+bt*l<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #66cc66;">&#125;</span>
	x=tb;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>tl&lt;x<span style="color: #66cc66;">&#41;</span>
		x=tl;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>tr&lt;x<span style="color: #66cc66;">&#41;</span>
		x=tr;
	<span style="color: #b1b100;">return</span> x;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">void</span> InitLcp<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	memset<span style="color: #66cc66;">&#40;</span>h,<span style="color: #cc66cc;">0</span>,<span style="color: #993333;">sizeof</span><span style="color: #66cc66;">&#40;</span>h<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #993333;">int</span> j,t;
	h<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">1</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">1</span>;i&lt;=n;i++<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>h<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>&gt;<span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#41;</span>
			j=h<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">-1</span>;
		t=SA<span style="color: #66cc66;">&#91;</span>Rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>;
		<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span>s<span style="color: #66cc66;">&#91;</span>i+j<span style="color: #66cc66;">&#93;</span>==s<span style="color: #66cc66;">&#91;</span>t+j<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span> j++;
		h<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=j;
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">1</span>;i&lt;=n;i++<span style="color: #66cc66;">&#41;</span> Height<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=h<span style="color: #66cc66;">&#91;</span>SA<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>;
<span style="color: #66cc66;">&#125;</span>
&nbsp;
<span style="color: #993333;">int</span> main<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
<span style="color: #66cc66;">&#123;</span>
	<span style="color: #993333;">char</span> ch;
	<span style="color: #993333;">int</span> j=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">0</span>;fin&gt;&gt;ch;i++<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>isalpha<span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			s<span style="color: #66cc66;">&#91;</span>j<span style="color: #66cc66;">&#93;</span>=tolower<span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span>;
			j++;
		<span style="color: #66cc66;">&#125;</span>
	<span style="color: #66cc66;">&#125;</span>
	n=j;
	s<span style="color: #66cc66;">&#91;</span>n<span style="color: #66cc66;">&#93;</span>=<span style="color: #ff0000;">'#'</span>;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">0</span>;i&lt;n;i++<span style="color: #66cc66;">&#41;</span> s<span style="color: #66cc66;">&#91;</span>n+i<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span>=s<span style="color: #66cc66;">&#91;</span>n-i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>;
	n=n*<span style="color: #cc66cc;">2</span><span style="color: #cc66cc;">+2</span>;
	s<span style="color: #66cc66;">&#91;</span>n<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #ff0000;">'$'</span>;
	suffixArray<span style="color: #66cc66;">&#40;</span>s,SA,n,<span style="color: #cc66cc;">255</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>n==<span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		SA<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">1</span>;
		Rank<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">1</span>;
		s<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>=s<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>;
	<span style="color: #66cc66;">&#125;</span><span style="color: #b1b100;">else</span><span style="color: #66cc66;">&#123;</span>
		<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=n;i&gt;<span style="color: #cc66cc;">0</span>;i--<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			SA<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=SA<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span><span style="color: #cc66cc;">+1</span>;
			s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>=s<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#93;</span>;
			Rank<span style="color: #66cc66;">&#91;</span>SA<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#93;</span>=i;
		<span style="color: #66cc66;">&#125;</span>
	<span style="color: #66cc66;">&#125;</span>
	SA<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;s<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #cc66cc;">0</span>;
	InitLcp<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	Init<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	InitSTBlock<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #993333;">int</span> maxp=<span style="color: #cc66cc;">0</span>,maxc=<span style="color: #cc66cc;">0</span>;bool odd;
	<span style="color: #b1b100;">for</span><span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">1</span>;i&lt;=<span style="color: #66cc66;">&#40;</span>n<span style="color: #cc66cc;">-2</span><span style="color: #66cc66;">&#41;</span>/<span style="color: #cc66cc;">2</span>;i++<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		<span style="color: #993333;">int</span> jason330=min<span style="color: #66cc66;">&#40;</span>Rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>,Rank<span style="color: #66cc66;">&#91;</span>n-i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #993333;">int</span> jason770=max<span style="color: #66cc66;">&#40;</span>Rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>,Rank<span style="color: #66cc66;">&#91;</span>n-i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #993333;">int</span> temp=GetRmq<span style="color: #66cc66;">&#40;</span>jason330,jason770<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>temp&gt;maxp<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			maxp=temp;maxc=i;odd=<span style="color: #000000; font-weight: bold;">true</span>;
		<span style="color: #66cc66;">&#125;</span>
		jason330=min<span style="color: #66cc66;">&#40;</span>Rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>,Rank<span style="color: #66cc66;">&#91;</span>n-i<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
		jason770=max<span style="color: #66cc66;">&#40;</span>Rank<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>,Rank<span style="color: #66cc66;">&#91;</span>n-i<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>;
		temp=GetRmq<span style="color: #66cc66;">&#40;</span>jason330,jason770<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>temp&gt;maxp<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
			maxp=temp;maxc=i;odd=<span style="color: #000000; font-weight: bold;">false</span>;
		<span style="color: #66cc66;">&#125;</span>
	<span style="color: #66cc66;">&#125;</span>
	<span style="color: #993333;">int</span> start,end;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>odd<span style="color: #66cc66;">&#41;</span> start=maxc-maxp<span style="color: #cc66cc;">+1</span>,end=maxc+maxp<span style="color: #cc66cc;">-1</span>;
	<span style="color: #b1b100;">else</span> start=maxc-maxp,end=maxc+maxp<span style="color: #cc66cc;">-1</span>;
	<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>start&gt;<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#40;</span>n<span style="color: #cc66cc;">-2</span><span style="color: #66cc66;">&#41;</span>/<span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>
		<span style="color: #993333;">int</span> ttt=start;
		start=n-end;
		end=n-ttt;
	<span style="color: #66cc66;">&#125;</span>
	fin.<span style="color: #202020;">close</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	ifstream ans<span style="color: #66cc66;">&#40;</span>Fin<span style="color: #66cc66;">&#41;</span>;
	fout&lt;&lt;end-start<span style="color: #cc66cc;">+1</span>&lt;&lt;endl;
	j=<span style="color: #cc66cc;">0</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span>j&lt;start<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		ans.<span style="color: #202020;">get</span><span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>isalpha<span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> j++;
	<span style="color: #66cc66;">&#125;</span>
	ans.<span style="color: #202020;">unget</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
	<span style="color: #b1b100;">while</span><span style="color: #66cc66;">&#40;</span>j&lt;=end<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#123;</span>
		ans.<span style="color: #202020;">get</span><span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span>;
		fout.<span style="color: #202020;">put</span><span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span>;
		<span style="color: #b1b100;">if</span><span style="color: #66cc66;">&#40;</span>isalpha<span style="color: #66cc66;">&#40;</span>ch<span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> j++;
	<span style="color: #66cc66;">&#125;</span>
	fout&lt;&lt;endl;
<span style="color: #66cc66;">&#125;</span></pre>
<p>程序三：
</p>
<pre class="c"><span style="color: #808080; font-style: italic;">/*
 ID:nettle99
 PROG:calfflac
 LANG:C++
 */</span>
&nbsp;
 <span style="color: #339933;">#include &lt;fstream&gt;</span>
 using namespace std;
&nbsp;
 ifstream fin<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.in&quot;</span><span style="color: #66cc66;">&#41;</span>;
 ofstream fout<span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">&quot;calfflac.out&quot;</span><span style="color: #66cc66;">&#41;</span>;
 <span style="color: #993333;">int</span> a<span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">20000</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">2</span><span style="color: #66cc66;">&#93;</span>=<span style="color: #66cc66;">&#123;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#125;</span>,mx=<span style="color: #cc66cc;">1</span>,lef=<span style="color: #cc66cc;">0</span>,rig=<span style="color: #cc66cc;">0</span>;
 <span style="color: #993333;">int</span> Deal<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">string</span> s<span style="color: #66cc66;">&#41;</span>
 <span style="color: #66cc66;">&#123;</span>
 <span style="color: #993333;">int</span> l=s.<span style="color: #202020;">size</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>,k=<span style="color: #cc66cc;">0</span>;
   <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">0</span>;i&lt;l;i++<span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'a'</span>&lt;=s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &amp;&amp; s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>&lt;=<span style="color: #ff0000;">'z'</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>a<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>-<span style="color: #ff0000;">'a'</span><span style="color: #cc66cc;">+1</span>;a<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>=i;k++;<span style="color: #66cc66;">&#125;</span>
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span><span style="color: #ff0000;">'A'</span>&lt;=s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span> &amp;&amp; s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>&lt;=<span style="color: #ff0000;">'Z'</span><span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>a<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>=s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>-<span style="color: #ff0000;">'A'</span><span style="color: #cc66cc;">+1</span>;a<span style="color: #66cc66;">&#91;</span>k<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>=i;k++;<span style="color: #66cc66;">&#125;</span>
     <span style="color: #66cc66;">&#125;</span>
   <span style="color: #b1b100;">return</span> k;
 <span style="color: #66cc66;">&#125;</span>
&nbsp;
 <span style="color: #993333;">void</span> Max<span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i,<span style="color: #993333;">int</span> m<span style="color: #66cc66;">&#41;</span>
 <span style="color: #66cc66;">&#123;</span>
 <span style="color: #993333;">int</span> l=i<span style="color: #cc66cc;">-1</span>,r=i<span style="color: #cc66cc;">+1</span>,le=<span style="color: #cc66cc;">0</span>,ri=<span style="color: #cc66cc;">0</span>;
   <span style="color: #b1b100;">while</span> <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>l<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>==a<span style="color: #66cc66;">&#91;</span>r<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
       le=l;ri=r;
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>l&gt;<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span> l--;
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>r&lt;m<span style="color: #66cc66;">&#41;</span> r++;
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>i-l!=r-i<span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">break</span>;
     <span style="color: #66cc66;">&#125;</span>
   <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>ri-le<span style="color: #cc66cc;">+1</span>&gt;mx<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>lef=a<span style="color: #66cc66;">&#91;</span>le<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;rig=a<span style="color: #66cc66;">&#91;</span>ri<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;mx=ri-le<span style="color: #cc66cc;">+1</span>;<span style="color: #66cc66;">&#125;</span>
   <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>==a<span style="color: #66cc66;">&#91;</span>i<span style="color: #cc66cc;">+1</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
       l=i<span style="color: #cc66cc;">-1</span>;r=i<span style="color: #cc66cc;">+2</span>;
       <span style="color: #b1b100;">while</span> <span style="color: #66cc66;">&#40;</span>a<span style="color: #66cc66;">&#91;</span>l<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span>==a<span style="color: #66cc66;">&#91;</span>r<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">0</span><span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#41;</span>
         <span style="color: #66cc66;">&#123;</span>
           le=l;ri=r;
           <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>l&gt;<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span> l--;
           <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>r&lt;m<span style="color: #66cc66;">&#41;</span> r++;
           <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>i-l!=r-i<span style="color: #cc66cc;">-1</span><span style="color: #66cc66;">&#41;</span> <span style="color: #000000; font-weight: bold;">break</span>;
         <span style="color: #66cc66;">&#125;</span>
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>ri-le<span style="color: #cc66cc;">+1</span>&gt;mx<span style="color: #66cc66;">&#41;</span> <span style="color: #66cc66;">&#123;</span>lef=a<span style="color: #66cc66;">&#91;</span>le<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;rig=a<span style="color: #66cc66;">&#91;</span>ri<span style="color: #66cc66;">&#93;</span><span style="color: #66cc66;">&#91;</span><span style="color: #cc66cc;">1</span><span style="color: #66cc66;">&#93;</span>;mx=ri-le<span style="color: #cc66cc;">+1</span>;<span style="color: #66cc66;">&#125;</span>
     <span style="color: #66cc66;">&#125;</span>
   <span style="color: #b1b100;">return</span>&nbsp;;
 <span style="color: #66cc66;">&#125;</span>
&nbsp;
  <span style="color: #993333;">int</span> main<span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>
 <span style="color: #66cc66;">&#123;</span>
 <span style="color: #993333;">char</span> c;
 <span style="color: #993333;">string</span> s=<span style="color: #ff0000;">&quot;&quot;</span>;
   <span style="color: #b1b100;">while</span> <span style="color: #66cc66;">&#40;</span>!fin.<span style="color: #202020;">eof</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span>
     <span style="color: #66cc66;">&#123;</span>
       c=fin.<span style="color: #202020;">get</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
       <span style="color: #b1b100;">if</span> <span style="color: #66cc66;">&#40;</span>!fin.<span style="color: #202020;">eof</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span><span style="color: #66cc66;">&#41;</span> s+=c;
     <span style="color: #66cc66;">&#125;</span>
 <span style="color: #993333;">int</span> m;
   m=Deal<span style="color: #66cc66;">&#40;</span>s<span style="color: #66cc66;">&#41;</span>;
   <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=<span style="color: #cc66cc;">1</span>;i&lt;m<span style="color: #cc66cc;">-1</span>;i++<span style="color: #66cc66;">&#41;</span>
     Max<span style="color: #66cc66;">&#40;</span>i,m<span style="color: #66cc66;">&#41;</span>;
   fout&lt;&lt;mx&lt;&lt;endl;
   <span style="color: #b1b100;">for</span> <span style="color: #66cc66;">&#40;</span><span style="color: #993333;">int</span> i=lef;i&lt;=rig;i++<span style="color: #66cc66;">&#41;</span>
     fout&lt;&lt;s<span style="color: #66cc66;">&#91;</span>i<span style="color: #66cc66;">&#93;</span>;
   fout&lt;&lt;endl;
   fin.<span style="color: #202020;">close</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
   fout.<span style="color: #202020;">close</span><span style="color: #66cc66;">&#40;</span><span style="color: #66cc66;">&#41;</span>;
   <span style="color: #b1b100;">return</span> <span style="color: #cc66cc;">0</span>;
 <span style="color: #66cc66;">&#125;</span></pre>

<!-- Saved in parser cache with key nocow:pcache:idhash:2408-0!1!0!!zh-cn!2 and timestamp 20090806004625 -->
<div class="printfooter">
来自"<a href="http://www.nocow.cn/index.php/Code:USACO/calfflac/C%2B%2B">http://www.nocow.cn/index.php/Code:USACO/calfflac/C%2B%2B</a>"</div>
						<!-- end content -->
			<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
						 <li id="ca-nstab-code" class="selected"><a href="/index.php/Code:USACO/calfflac/C%2B%2B">代码</a></li>
						 <li id="ca-talk" class="new"><a href="/index.php?title=Code_Talk:USACO/calfflac/C%2B%2B&amp;action=edit">讨论</a></li>
						 <li id="ca-edit"><a href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;action=edit">编辑</a></li>
						 <li id="ca-history"><a href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;action=history">历史</a></li>
				</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=Special:Userlogin&amp;returnto=Code:USACO/calfflac/C%2B%2B">登录或创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(/skins/common/images/wiki.png);" href="/index.php/%E9%A6%96%E9%A1%B5" title="首页"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
		<div class='portlet' id='p-navigation'>
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/index.php/%E9%A6%96%E9%A1%B5">首页</a></li>
				<li id="n-portal"><a href="/index.php/NOCOW:%E7%A4%BE%E5%8C%BA%E4%B8%BB%E9%A1%B5">社区主页</a></li>
				<li id="n-currentevents"><a href="/index.php/NOCOW:NOCOW%E8%BF%91%E6%9C%9F%E5%8F%91%E5%B1%95%E8%AE%A1%E5%88%92">当前事件</a></li>
				<li id="n-recentchanges"><a href="/index.php/Special:Recentchanges">最近更改</a></li>
				<li id="n-randompage"><a href="/index.php/Special:Random">随机页面</a></li>
				<li id="n-help"><a href="/index.php/Help:%E5%B8%AE%E5%8A%A9">使用帮助</a></li>
				<li id="n-sitesupport"><a href="/index.php/NOCOW:%E7%A4%BE%E5%8C%BA%E4%B8%BB%E9%A1%B5">帮助我们</a></li>
				<li id="n-sitemap-text"><a href="/index.php/NOCOW%E5%9C%B0%E5%9B%BE">NOCOW地图</a></li>
				<li id="n-sandbox-text"><a href="/index.php/NOCOW:%E6%96%B0%E6%89%8B%E8%AF%95%E7%BB%83%E5%9C%BA">新手试练场</a></li>
			</ul>
		</div>
	</div>
		<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php/Special:Search" id="searchform"><div>
<input name="ref" type="hidden" value="Code:USACO/calfflac/C++">
				<input id="searchInput" name="search" type="text" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="进入" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="搜索" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/index.php/Special:Whatlinkshere/Code:USACO/calfflac/C%2B%2B">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="/index.php/Special:Recentchangeslinked/Code:USACO/calfflac/C%2B%2B">链出更改</a></li>
<li id="t-upload"><a href="/index.php/Special:Upload">上传文件</a></li>
<li id="t-specialpages"><a href="/index.php/Special:Specialpages">特殊页面</a></li>
				<li id="t-print"><a href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;printable=yes">可打印版</a></li>				<li id="t-permalink"><a href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;oldid=13824">永久链接</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="/skins/common/images/gnu-fdl.png" alt='GNU Free Documentation License 1.2' /></a></div>
			<ul id="f-list">
				<li id="viewcount">访问次数: 2,538次</li>
				<li id="credits">此页由NOCOW注册用户<a href="/index.php?title=User:ShingRay&amp;action=edit" class="new" title="User:ShingRay">ShingRay</a>于2009年1月20日, 03:57最后更改. 在<a href="/index.php/User:Jason911" title="User:Jason911">lvxiao</a>, NOCOW用户<a href="/index.php/User:Nettle99" title="User:Nettle99">Nettle99</a>, NOCOW匿名用户 和 <a href="/index.php?title=Code:USACO/calfflac/C%2B%2B&amp;action=credits" title="Code:USACO/calfflac/C++">其他</a>的工作基础上.</li>
				<li id="copyright">本站内容在<a href="http://www.gnu.org/copyleft/fdl.html" class="external " title="http://www.gnu.org/copyleft/fdl.html" rel="nofollow">GNU Free Documentation License 1.2</a>下发布</li>
				<li id="privacy"><a href="/index.php/NOCOW:%E9%9A%90%E7%A7%81%E7%AD%96%E7%95%A5" title="NOCOW:隐私策略">隐私策略</a></li>
				<li id="about"><a href="/index.php/NOCOW:%E5%85%B3%E4%BA%8E" title="NOCOW:关于">关于NOCOW</a></li>
				<li id="disclaimer"><a href="/index.php/NOCOW:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="NOCOW:免责声明">免责声明</a></li>
				<li id="miibeian"><a href="http://www.miibeian.gov.cn" rel="nofollow">陕ICP备09005692号</a></li>
			</ul>
		</div>
		
	
		<script type="text/javascript">if (window.runOnloadHook) runOnloadHook();</script>
</div>
<!-- Served by bdezlinux in 0.181 secs. --><!-- google analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-8008676-1");
pageTracker._trackPageview();
} catch(err) {}</script>
</body></html>
