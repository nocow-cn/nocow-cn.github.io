<!DOCTYPE html>
<html lang="zh-cn" dir="ltr" class="client-nojs">
<head>
<title>Code:USACO/contact/Pascal - NOCOW</title>
<meta charset="UTF-8" />
<meta name="generator" content="MediaWiki 1.18.1" />
<link rel="alternate" type="application/x-wiki" title="编辑" href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit" />
<link rel="edit" title="编辑" href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit" />
<link rel="shortcut icon" href="/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="/opensearch_desc.php" title="NOCOW (zh-cn)" />
<link rel="EditURI" type="application/rsd+xml" href="http://www.nocow.cn/api.php?action=rsd" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="NOCOW的Atom" href="/index.php?title=%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9&amp;feed=atom" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=zh-cn&amp;modules=mediawiki.legacy.commonPrint%2Cshared%7Cskins.monobook&amp;only=styles&amp;skin=monobook&amp;*" />
<!--[if lt IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE50Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 5.5000]><link rel="stylesheet" href="/skins/monobook/IE55Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 6]><link rel="stylesheet" href="/skins/monobook/IE60Fixes.css?303" media="screen" /><![endif]-->
<!--[if IE 7]><link rel="stylesheet" href="/skins/monobook/IE70Fixes.css?303" media="screen" /><![endif]--><meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="/load.php?debug=false&amp;lang=zh-cn&amp;modules=site&amp;only=styles&amp;skin=monobook&amp;*" />
<style>a:lang(ar),a:lang(ckb),a:lang(fa),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}a.new,#quickbar a.new{color:#ba0000}

/* cache key: newnocow:resourceloader:filter:minify-css:4:c88e2bcd56513749bec09a7e29cb3ffa */
</style>
<script src="/load.php?debug=false&amp;lang=zh-cn&amp;modules=startup&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.config.set({"wgCanonicalNamespace": "Code", "wgCanonicalSpecialPageName": false, "wgNamespaceNumber": 104, "wgPageName": "Code:USACO/contact/Pascal", "wgTitle": "USACO/contact/Pascal", "wgCurRevisionId": 34260, "wgArticleId": 382, "wgIsArticle": true, "wgAction": "view", "wgUserName": null, "wgUserGroups": ["*"], "wgCategories": [], "wgBreakFrames": false, "wgRestrictionEdit": [], "wgRestrictionMove": []});
}
</script><script>if(window.mw){
	mw.loader.load(["mediawiki.page.startup"]);
}
</script>
<style type="text/css">/*<![CDATA[*/
/**
 * GeSHi Dynamically Generated Stylesheet
 * --------------------------------------
 * Dynamically generated stylesheet for pascal
 * CSS class: source-pascal, CSS id: 
 * GeSHi (C) 2004 - 2007 Nigel McNie, 2007 - 2008 Benny Baumann
 * (http://qbnz.com/highlighter/ and http://geshi.org/)
 * --------------------------------------
 */
.pascal.source-pascal .de1, .pascal.source-pascal .de2 {}
.pascal.source-pascal  {font-family:monospace;}
.pascal.source-pascal .imp {font-weight: bold; color: red;}
.pascal.source-pascal li, .pascal.source-pascal .li1 {font-weight: normal; vertical-align:top;}
.pascal.source-pascal .ln {width:1px;text-align:right;margin:0;padding:0 2px;vertical-align:top;}
.pascal.source-pascal .li2 {font-weight: bold; vertical-align:top;}
.pascal.source-pascal .kw1 {color: #000000; font-weight: bold;}
.pascal.source-pascal .kw2 {color: #000000; font-weight: bold;}
.pascal.source-pascal .kw3 {color: #000066;}
.pascal.source-pascal .kw4 {color: #000066; font-weight: bold;}
.pascal.source-pascal .co1 {color: #666666; font-style: italic;}
.pascal.source-pascal .coMULTI {color: #666666; font-style: italic;}
.pascal.source-pascal .es0 {color: #000099; font-weight: bold;}
.pascal.source-pascal .es_h {color: #000099; font-weight: bold;}
.pascal.source-pascal .br0 {color: #009900;}
.pascal.source-pascal .sy0 {color: #339933;}
.pascal.source-pascal .st0 {color: #ff0000;}
.pascal.source-pascal .st_h {color: #ff0000;}
.pascal.source-pascal .nu0 {color: #cc66cc;}
.pascal.source-pascal .me1 {color: #0066ee;}
.pascal.source-pascal .ln-xtra, .pascal.source-pascal li.ln-xtra, .pascal.source-pascal div.ln-xtra {background-color: #ffc;}
.pascal.source-pascal span.xtra { display:block; }

/*]]>*/
</style>
<style type="text/css">/*<![CDATA[*/
@import "/index.php?title=MediaWiki:Geshi.css&usemsgcache=yes&action=raw&ctype=text/css&smaxage=18000";
/*]]>*/
</style></head>
<body class="mediawiki ltr sitedir-ltr ns-104 ns-subject page-Code_USACO_contact_Pascal action-view skin-monobook">
<div id="globalWrapper">
<div id="column-content"><div id="content">
	<a id="top"></a>
	<div id="siteNotice"><div id="localNotice" lang="zh-cn" dir="ltr"><p>为防止广告，目前nocow只有登录用户能够创建新页面。如要创建页面请先<a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95" title="特殊:用户登录">登录/注册</a>（新用户需要等待1个小时才能正常使用该功能）。
</p></div></div>
	<h1 id="firstHeading" class="firstHeading">Code:USACO/contact/Pascal</h1>
	<div id="bodyContent">
		<div id="siteSub">来自NOCOW</div>
		<div id="contentSub"></div>
		<div id="jump-to-nav">跳转到： <a href="#column-one">导航</a>, <a href="#searchInput">搜索</a></div>
		<!-- start content -->
<div lang="zh-cn" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>目录</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#.E4.BB.A3.E7.A0.81-2"><span class="tocnumber">1</span> <span class="toctext">代码-2</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="#.E4.BB.A3.E7.A0.81-1"><span class="tocnumber">2</span> <span class="toctext">代码-1</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="#.E4.BB.A3.E7.A0.810"><span class="tocnumber">3</span> <span class="toctext">代码0</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="#.E4.BB.A3.E7.A0.811"><span class="tocnumber">4</span> <span class="toctext">代码1</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="#.E4.BB.A3.E7.A0.812"><span class="tocnumber">5</span> <span class="toctext">代码2</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="#.E4.BB.A3.E7.A0.813"><span class="tocnumber">6</span> <span class="toctext">代码3</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="#.E4.BB.A3.E7.A0.814.EF.BC.88.E6.A0.B8.E5.BF.83.E6.80.9D.E8.B7.AF.EF.BC.89"><span class="tocnumber">7</span> <span class="toctext">代码4（核心思路）</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="#.E4.BB.A3.E7.A0.815"><span class="tocnumber">8</span> <span class="toctext">代码5</span></a></li>
<li class="toclevel-1 tocsection-9"><a href="#.E4.BB.A3.E7.A0.816.28.E4.BA.8C.E8.BF.9B.E5.88.B6.29"><span class="tocnumber">9</span> <span class="toctext">代码6(二进制)</span></a></li>
<li class="toclevel-1 tocsection-10"><a href="#.E4.BB.A3.E7.A0.817.EF.BC.88.E7.94.A8.E7.A9.BA.E9.97.B4.E6.8D.A2.E6.97.B6.E9.97.B4.EF.BC.89"><span class="tocnumber">10</span> <span class="toctext">代码7（用空间换时间）</span></a></li>
<li class="toclevel-1 tocsection-11"><a href="#.E4.BB.A3.E7.A0.818.EF.BC.88.E4.B8.BA.E6.8E.92.E5.BA.8F.E8.80.8C.E5.86.99.E7.9A.84.EF.BC.89"><span class="tocnumber">11</span> <span class="toctext">代码8（为排序而写的）</span></a></li>
<li class="toclevel-1 tocsection-12"><a href="#.E4.BB.A3.E7.A0.819"><span class="tocnumber">12</span> <span class="toctext">代码9</span></a></li>
<li class="toclevel-1 tocsection-13"><a href="#.E4.BB.A3.E7.A0.81A"><span class="tocnumber">13</span> <span class="toctext">代码A</span></a></li>
<li class="toclevel-1 tocsection-14"><a href="#Trie_Plus"><span class="tocnumber">14</span> <span class="toctext">Trie Plus</span></a></li>
<li class="toclevel-1 tocsection-15"><a href="#.E4.BB.A3.E7.A0.81-K"><span class="tocnumber">15</span> <span class="toctext">代码-K</span></a></li>
</ul>
</td></tr></table>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=1" title="编辑段落：代码-2">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.81-2">代码-2</span></h2>
<p>暴力。
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">本菜在此以血的经历挥泪忠告：对于<span class="kw4">ansistring</span>少用length、delete等字符串函数，本来第<span class="nu0">5</span>个点就1.324secTLE了，然后改成不用length、delete的<span class="kw1">for</span>循环，瞬间
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.032</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.032</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.054</span> secs<span class="sy0">,</span> <span class="nu0">1656</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
<span class="co1">//还有就是end的前一个语句去掉分号可以少算一个语句，省时间。</span>
<span class="co1">//似乎去掉多余空格，也能省时间【此经验来自vijos的不稳定评测系统，纯属臆测</span>
<span class="coMULTI">{
ID: 9963y1
PROG: contact
LANG: PASCAL
}</span>
<span class="co1">//uses sysutils;</span>
<span class="kw1">type</span> balabala<span class="sy0">=</span><span class="kw4">record</span>
times<span class="sy0">:</span><span class="kw4">longint</span>;
point<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">end</span>;
qwert<span class="sy0">=</span><span class="kw4">record</span>
times<span class="sy0">:</span><span class="kw4">longint</span>;
code<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
<span class="kw1">end</span>;
<span class="kw1">var</span> q<span class="sy0">,</span>w<span class="sy0">,</span>n<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>t<span class="sy0">,</span>mm<span class="sy0">,</span>lala<span class="sy0">,</span>tot<span class="sy0">,</span>sb<span class="sy0">:</span><span class="kw4">longint</span>;
a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4100</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> balabala;
b<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">49152</span><span class="br0">&#93;</span><span class="kw1">of</span> qwert;
s<span class="sy0">:</span><span class="kw4">ansistring</span>;
ss<span class="sy0">:</span><span class="kw4">string</span>;<span class="co1">//tt:double;</span>
<span class="kw1">function</span> xiao<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;<span class="kw1">inline</span>;
<span class="kw1">begin</span>
<span class="kw1">if</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
<span class="kw1">if</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">if</span> a&lt;b <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>
<span class="kw1">end</span>;
<span class="kw1">procedure</span> sort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span> <span class="kw4">longint</span><span class="br0">&#41;</span>;<span class="kw1">inline</span>;
<span class="kw1">var</span>
i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;x<span class="sy0">,</span>y<span class="sy0">:</span>qwert;
<span class="kw1">begin</span>
i<span class="sy0">:=</span>l;
j<span class="sy0">:=</span>r;
x<span class="sy0">:=</span>b<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
<span class="kw1">repeat</span>
<span class="kw1">while</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span>&gt;x.<span class="me1">times</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="sy0">=</span>x.<span class="me1">times</span><span class="br0">&#41;</span><span class="kw3">and</span> xiao<span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">,</span>x.<span class="me1">code</span><span class="br0">&#41;</span><span class="kw1">do</span>
inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
<span class="kw1">while</span> <span class="br0">&#40;</span>x.<span class="me1">times</span>&gt;b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>x.<span class="me1">times</span><span class="sy0">=</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span><span class="kw3">and</span> xiao<span class="br0">&#40;</span>x.<span class="me1">code</span><span class="sy0">,</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span><span class="kw1">do</span>
dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
<span class="kw1">if</span> <span class="kw1">not</span><span class="br0">&#40;</span>i&gt;j<span class="br0">&#41;</span> <span class="kw1">then</span>
<span class="kw1">begin</span>
y<span class="sy0">:=</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
b<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>y;
inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>
<span class="kw1">end</span>;
<span class="kw1">until</span> i&gt;j;
<span class="kw1">if</span> l&lt;j <span class="kw1">then</span>
sort<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">if</span> i&lt;r <span class="kw1">then</span>
sort<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>
<span class="kw1">end</span>;
<span class="kw1">begin</span>
<span class="co1">//tt:=time;</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw3">readln</span><span class="br0">&#40;</span>q<span class="sy0">,</span>w<span class="sy0">,</span>n<span class="br0">&#41;</span>;
<span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw3">readln</span><span class="br0">&#40;</span>ss<span class="br0">&#41;</span>;
s<span class="sy0">:=</span>s<span class="sy0">+</span>ss
<span class="kw1">end</span>;
sb<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
<span class="kw1">for</span> lala<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> sb<span class="sy0">-</span>q <span class="kw1">do</span>
<span class="kw1">begin</span>
t<span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> w <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw1">if</span> i<span class="sy0">+</span>lala&gt;sb <span class="kw1">then</span> <span class="kw1">break</span>;
t<span class="sy0">:=</span>t <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="sy0">+</span>lala<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span>;
<span class="kw1">if</span> i&gt;<span class="sy0">=</span>q <span class="kw1">then</span>
<span class="kw1">begin</span>
inc<span class="br0">&#40;</span>a<span class="br0">&#91;</span>t<span class="sy0">,</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span>;
<span class="kw1">if</span> a<span class="br0">&#91;</span>t<span class="sy0">,</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
<span class="kw1">begin</span>
inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
b<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">:=</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">+</span>lala<span class="sy0">,</span>i<span class="br0">&#41;</span>;
a<span class="br0">&#91;</span>t<span class="sy0">,</span>i<span class="br0">&#93;</span>.<span class="me1">point</span><span class="sy0">:=</span>tot
<span class="kw1">end</span>;
inc<span class="br0">&#40;</span>b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>t<span class="sy0">,</span>i<span class="br0">&#93;</span>.<span class="me1">point</span><span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span>
<span class="kw1">end</span>
<span class="kw1">end</span>
<span class="kw1">end</span>;
sort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>tot<span class="br0">&#41;</span>;
i<span class="sy0">:=</span><span class="nu0">1</span>;mm<span class="sy0">:=</span><span class="nu0">0</span>;t<span class="sy0">:=</span><span class="nu0">0</span>;
<span class="kw1">while</span> mm&lt;<span class="sy0">=</span>n <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">break</span>;
<span class="kw1">if</span> b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span>&lt;&gt;b<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">times</span> <span class="kw1">then</span>
<span class="kw1">begin</span>
inc<span class="br0">&#40;</span>mm<span class="br0">&#41;</span>;<span class="kw1">if</span> mm&gt;n <span class="kw1">then</span> <span class="kw1">break</span>;
<span class="kw1">if</span> t <span class="kw1">mod</span> <span class="nu0">6</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
<span class="kw3">writeln</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span>;t<span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw3">write</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>
<span class="kw1">end</span> <span class="kw1">else</span>
<span class="kw1">begin</span>
<span class="kw1">if</span> t <span class="kw1">mod</span> <span class="nu0">6</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
<span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>;
inc<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;<span class="kw1">if</span> t <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>
<span class="kw1">end</span>;
inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>
<span class="kw1">end</span>;
<span class="kw1">if</span> t <span class="kw1">mod</span> <span class="nu0">6</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
<span class="co1">//writeln((time-tt)*3600*24/1000:0:2);</span>
close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=2" title="编辑段落：代码-1">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.81-1">代码-1</span></h2>
暴力枚举!!地球人都看得懂 <b>By LT</b><div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">USER<span class="sy0">:</span> Long Guo <span class="br0">&#91;</span>jscompa1<span class="br0">&#93;</span>
TASK<span class="sy0">:</span> contact
LANG<span class="sy0">:</span> PASCAL
&#160;
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">3736</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">3704</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.054</span> secs<span class="sy0">,</span> <span class="nu0">3800</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.032</span> secs<span class="sy0">,</span> <span class="nu0">3800</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.130</span> secs<span class="sy0">,</span> <span class="nu0">3800</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.302</span> secs<span class="sy0">,</span> <span class="nu0">3800</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.173</span> secs<span class="sy0">,</span> <span class="nu0">3800</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
<span class="me1">Your</span> <span class="kw1">program</span> <span class="br0">&#40;</span><span class="st_h">'contact'</span><span class="br0">&#41;</span> produced all correct answers!  This is your
submission #<span class="nu0">2</span> <span class="kw1">for</span> this problem.  <span class="me1">Congratulations</span>!
&#160;
&#160;
<span class="kw1">program</span> dfgnsdfnklsd;
<span class="kw1">type</span>
  node<span class="sy0">=</span><span class="kw4">record</span>
    code<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;<span class="co1">//注意!否则会MLE</span>
    r<span class="sy0">,</span>time<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">end</span>;
<span class="kw1">var</span>
  a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">4095</span><span class="br0">&#93;</span> <span class="kw1">of</span> node;
  b<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">100000</span><span class="br0">&#93;</span> <span class="kw1">of</span> node;
  i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>p<span class="sy0">,</span>q<span class="sy0">,</span>t<span class="sy0">:</span><span class="kw4">longint</span>;
  s<span class="sy0">:</span><span class="kw4">ansistring</span>;
  ss<span class="sy0">:</span><span class="kw4">string</span>;
<span class="kw1">function</span> turn<span class="br0">&#40;</span>ss<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">var</span> k<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  turn<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> k<span class="sy0">:=</span>length<span class="br0">&#40;</span>ss<span class="br0">&#41;</span> <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
    turn<span class="sy0">:=</span>turn<span class="sy0">+</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>ss<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span><span class="br0">&#41;</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>ss<span class="br0">&#41;</span><span class="sy0">-</span>k<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">function</span> check<span class="br0">&#40;</span>s<span class="sy0">,</span>s1<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>s1<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>s1<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> s&lt;s1 <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">function</span> check2<span class="br0">&#40;</span>s<span class="sy0">,</span>s1<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>s1<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>s1<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> s&gt;s1 <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">procedure</span> sort<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  temp<span class="sy0">,</span>mid<span class="sy0">:</span>node;
  xx<span class="sy0">,</span>yy<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  xx<span class="sy0">:=</span>x;yy<span class="sy0">:=</span>y;
  mid<span class="sy0">:=</span>b<span class="br0">&#91;</span><span class="br0">&#40;</span>xx<span class="sy0">+</span>yy<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>xx<span class="br0">&#93;</span>.<span class="me1">time</span>&gt;mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>xx<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw3">and</span> check<span class="br0">&#40;</span>b<span class="br0">&#91;</span>xx<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">,</span>mid.<span class="me1">code</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>xx<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>yy<span class="br0">&#93;</span>.<span class="me1">time</span>&lt;mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>yy<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw3">and</span> check2<span class="br0">&#40;</span>b<span class="br0">&#91;</span>yy<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">,</span>mid.<span class="me1">code</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>yy<span class="br0">&#41;</span>;
    <span class="kw1">if</span> xx&lt;<span class="sy0">=</span>yy <span class="kw1">then</span>
    <span class="kw1">begin</span>
      temp<span class="sy0">:=</span>b<span class="br0">&#91;</span>xx<span class="br0">&#93;</span>;b<span class="br0">&#91;</span>xx<span class="br0">&#93;</span><span class="sy0">:=</span>b<span class="br0">&#91;</span>yy<span class="br0">&#93;</span>;b<span class="br0">&#91;</span>yy<span class="br0">&#93;</span><span class="sy0">:=</span>temp;
      inc<span class="br0">&#40;</span>xx<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>yy<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">until</span> xx&gt;yy;
  <span class="kw1">if</span> yy&gt;x <span class="kw1">then</span> sort<span class="br0">&#40;</span>x<span class="sy0">,</span>yy<span class="br0">&#41;</span>;
  <span class="kw1">if</span> xx&lt;y <span class="kw1">then</span> sort<span class="br0">&#40;</span>xx<span class="sy0">,</span>y<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>p<span class="sy0">,</span>q<span class="sy0">,</span>t<span class="br0">&#41;</span>;
  s<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw3">readln</span><span class="br0">&#40;</span>ss<span class="br0">&#41;</span>;
    s<span class="sy0">:=</span>s<span class="sy0">+</span>ss;
  <span class="kw1">end</span>;
  n<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>p <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span>p <span class="kw1">to</span> q <span class="kw1">do</span>
    <span class="kw1">begin</span>
       <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span>&lt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
       ss<span class="sy0">:=</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>j<span class="br0">&#41;</span>;
       m<span class="sy0">:=</span>turn<span class="br0">&#40;</span>ss<span class="br0">&#41;</span>;
       a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">:=</span>ss;
       <span class="co1">//a[j,m].len:=length(a[j,m].code);</span>
       <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span>
       <span class="kw1">begin</span>
         inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>.<span class="me1">r</span><span class="sy0">:=</span>n;b<span class="br0">&#91;</span>n<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>;
       <span class="kw1">end</span>;
       inc<span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>b<span class="br0">&#91;</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>m<span class="br0">&#93;</span>.<span class="me1">r</span><span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
  sort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>n<span class="br0">&#41;</span>;
  k<span class="sy0">:=</span><span class="nu0">0</span>;n<span class="sy0">:=</span><span class="nu0">0</span>;j<span class="sy0">:=</span><span class="nu0">0</span>;
  b<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">:=</span>maxlongint;
  <span class="kw1">while</span> <span class="br0">&#40;</span>k&lt;<span class="sy0">=</span>t<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>j&lt;length<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>b<span class="br0">&#91;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> n<span class="sy0">=</span><span class="nu0">6</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        <span class="kw3">writeln</span>;<span class="kw3">write</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>;n<span class="sy0">:=</span><span class="nu0">1</span>;
      <span class="kw1">end</span> <span class="kw1">else</span>
      <span class="kw1">begin</span>
        <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>; inc<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span> <span class="kw1">else</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> k<span class="sy0">=</span>t <span class="kw1">then</span> <span class="kw1">break</span>;
      <span class="kw1">if</span> k&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
      <span class="kw3">writeln</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span>;
      <span class="kw3">write</span><span class="br0">&#40;</span>b<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;           n<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=3" title="编辑段落：代码0">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.810">代码0</span></h2>
<p>（By SRC）
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:tsnoi201
PROG:contact
LANG:PASCAL
}</span>
<span class="kw1">program</span> contact;
&#160;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>p<span class="sy0">,</span>q<span class="sy0">,</span>r<span class="sy0">,</span>t<span class="sy0">:</span><span class="kw4">longint</span>;
    trie<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">60000</span><span class="sy0">,</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    dep<span class="sy0">,</span>num<span class="sy0">,</span>next<span class="sy0">,</span>father<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">60000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    s<span class="sy0">,</span>mm<span class="sy0">:</span><span class="kw4">ansistring</span>;
    a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">60000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
    many<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">60000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    mmm<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
&#160;
<span class="kw1">procedure</span> dfs<span class="br0">&#40;</span>x<span class="sy0">,</span>d<span class="sy0">:</span><span class="kw4">longint</span>;s<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> d&gt;<span class="sy0">=</span>l <span class="kw1">then</span> a<span class="br0">&#91;</span>num<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>s;
  <span class="kw1">if</span> <span class="br0">&#40;</span>trie<span class="br0">&#91;</span>x<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span> exit;
  dfs<span class="br0">&#40;</span>trie<span class="br0">&#91;</span>x<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span><span class="sy0">,</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>s<span class="sy0">+</span><span class="st_h">'0'</span><span class="br0">&#41;</span>;
  dfs<span class="br0">&#40;</span>trie<span class="br0">&#91;</span>x<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span><span class="sy0">,</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>s<span class="sy0">+</span><span class="st_h">'1'</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> big<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> length<span class="br0">&#40;</span>x<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>y<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> length<span class="br0">&#40;</span>x<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>y<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> x&gt;y <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> g<span class="sy0">,</span>t<span class="sy0">,</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span>;
    m<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
<span class="kw1">begin</span>
  g<span class="sy0">:=</span>dep<span class="br0">&#91;</span><span class="br0">&#40;</span>x<span class="sy0">+</span>y<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  m<span class="sy0">:=</span>a<span class="br0">&#91;</span><span class="br0">&#40;</span>x<span class="sy0">+</span>y<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  l<span class="sy0">:=</span>x;r<span class="sy0">:=</span>y;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> <span class="br0">&#40;</span>dep<span class="br0">&#91;</span>l<span class="br0">&#93;</span>&gt;g<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>dep<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="sy0">=</span>g<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>big<span class="br0">&#40;</span>m<span class="sy0">,</span>a<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>dep<span class="br0">&#91;</span>r<span class="br0">&#93;</span>&lt;g<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span><span class="br0">&#40;</span>dep<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="sy0">=</span>g<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>big<span class="br0">&#40;</span>a<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="sy0">,</span>m<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
    <span class="kw1">if</span> l&lt;<span class="sy0">=</span>r <span class="kw1">then</span>
    <span class="kw1">begin</span>
      t<span class="sy0">:=</span>dep<span class="br0">&#91;</span>l<span class="br0">&#93;</span>;dep<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="sy0">:=</span>dep<span class="br0">&#91;</span>r<span class="br0">&#93;</span>;dep<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="sy0">:=</span>t;
      mmm<span class="sy0">:=</span>a<span class="br0">&#91;</span>l<span class="br0">&#93;</span>;a<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>r<span class="br0">&#93;</span>;a<span class="br0">&#91;</span>r<span class="br0">&#93;</span><span class="sy0">:=</span>mmm;
      inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">until</span> l&gt;r;
  <span class="kw1">if</span> x&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>x<span class="sy0">,</span>r<span class="br0">&#41;</span>;
  <span class="kw1">if</span> l&lt;y <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>y<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
 assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
 reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
 assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
 rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    <span class="kw3">readln</span><span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">,</span>n<span class="br0">&#41;</span>;
    s<span class="sy0">:=</span><span class="st_h">''</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw3">readln</span><span class="br0">&#40;</span>mm<span class="br0">&#41;</span>;
      s<span class="sy0">:=</span>s<span class="sy0">+</span>mm;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&lt;r <span class="kw1">then</span> r<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
&#160;
    p<span class="sy0">:=-</span><span class="nu0">1</span>;q<span class="sy0">:=</span><span class="nu0">0</span>;k<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">while</span> p&lt;q <span class="kw1">do</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
      <span class="kw1">if</span> dep<span class="br0">&#91;</span>p<span class="br0">&#93;</span>&lt;r <span class="kw1">then</span>
      <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>q<span class="br0">&#41;</span>;trie<span class="br0">&#91;</span>p<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span><span class="sy0">:=</span>q;dep<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="sy0">:=</span>dep<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span>;<span class="co1">//father[q]:=p;</span>
        <span class="kw1">if</span> dep<span class="br0">&#91;</span>q<span class="br0">&#93;</span>&gt;<span class="sy0">=</span>l <span class="kw1">then</span>
        <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;num<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="sy0">:=</span>k;
        <span class="kw1">end</span>;
        inc<span class="br0">&#40;</span>q<span class="br0">&#41;</span>;trie<span class="br0">&#91;</span>p<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span><span class="sy0">:=</span>q;dep<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="sy0">:=</span>dep<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span>;<span class="co1">//father[q]:=p;</span>
        <span class="kw1">if</span> dep<span class="br0">&#91;</span>q<span class="br0">&#93;</span>&gt;<span class="sy0">=</span>l <span class="kw1">then</span>
        <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;num<span class="br0">&#91;</span>q<span class="br0">&#93;</span><span class="sy0">:=</span>k;
        <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
    dfs<span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">0</span><span class="sy0">,</span><span class="st_h">''</span><span class="br0">&#41;</span>;
&#160;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> q <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> trie<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        j<span class="sy0">:=</span>trie<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span>;
        t<span class="sy0">:=</span>next<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span> t<span class="sy0">:=</span>next<span class="br0">&#91;</span>t<span class="br0">&#93;</span>;
        next<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span><span class="st_h">'0'</span><span class="br0">&#93;</span>;
      <span class="kw1">end</span>;
&#160;
      <span class="kw1">if</span> trie<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        j<span class="sy0">:=</span>trie<span class="br0">&#91;</span>i<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span>;
        t<span class="sy0">:=</span>next<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span> t<span class="sy0">:=</span>next<span class="br0">&#91;</span>t<span class="br0">&#93;</span>;
        next<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span><span class="st_h">'1'</span><span class="br0">&#93;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
&#160;
    fillchar<span class="br0">&#40;</span>dep<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>dep<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    t<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> trie<span class="br0">&#91;</span>t<span class="sy0">,</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> t<span class="sy0">:=</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span> <span class="kw1">else</span>
      <span class="kw1">begin</span>
        <span class="kw1">while</span> <span class="br0">&#40;</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span> t<span class="sy0">:=</span>next<span class="br0">&#91;</span>t<span class="br0">&#93;</span>;
        t<span class="sy0">:=</span>trie<span class="br0">&#91;</span>t<span class="sy0">,</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
      <span class="kw1">end</span>;
      inc<span class="br0">&#40;</span>dep<span class="br0">&#91;</span>num<span class="br0">&#91;</span>t<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
&#160;
    <span class="kw1">for</span> i<span class="sy0">:=</span>q <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
      <span class="kw1">if</span> num<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>dep<span class="br0">&#91;</span>num<span class="br0">&#91;</span>next<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">,</span>dep<span class="br0">&#91;</span>num<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
&#160;
    qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>k<span class="br0">&#41;</span>;
&#160;
    <span class="kw1">while</span> <span class="br0">&#40;</span>dep<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>k&gt;<span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
    <span class="co1">//for i:=1 to k do writeln(a[i],' ',dep[i]);</span>
    dep<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;dep<span class="br0">&#91;</span>k<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> k <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> dep<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;&gt;dep<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;l<span class="sy0">:=</span><span class="nu0">5</span>;
        <span class="kw1">if</span> n<span class="sy0">=-</span><span class="nu0">1</span> <span class="kw1">then</span> <span class="kw1">break</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>dep<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
        <span class="kw3">write</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span> <span class="kw1">else</span>
      <span class="kw1">begin</span>
        <span class="kw1">if</span> l<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
        <span class="kw1">begin</span>
          <span class="kw3">writeln</span>;
          <span class="kw3">write</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          l<span class="sy0">:=</span><span class="nu0">5</span>;
        <span class="kw1">end</span> <span class="kw1">else</span>
        <span class="kw1">begin</span>
          dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;<span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
      <span class="kw1">end</span>;
      <span class="kw1">if</span> dep<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;&gt;dep<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
    <span class="kw1">end</span>;
 close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">TRIE 简化
    Test <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4728</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4728</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">4824</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4824</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.022</span> secs<span class="sy0">,</span> <span class="nu0">4824</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">4824</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.022</span> secs<span class="sy0">,</span> <span class="nu0">4824</span> KB<span class="br0">&#93;</span>
&#160;
&#160;
<span class="coMULTI">{
ID:c.sis2
PROB:contact
LANG:PASCAL
}</span>
&#160;
<span class="kw1">program</span> Contact_Trie;
&#160;
<span class="kw1">const</span>
    maxn<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="nu0">13</span>;
&#160;
<span class="kw1">type</span>
    aaa<span class="sy0">=</span><span class="kw4">record</span>
        st<span class="sy0">:</span><span class="kw4">string</span>;
        num<span class="sy0">,</span>sum<span class="sy0">:</span><span class="kw4">longint</span>;
        times<span class="sy0">:</span><span class="kw4">longint</span>
    <span class="kw1">end</span>;
    link<span class="sy0">=</span><span class="kw4">record</span>
        data<span class="sy0">,</span>next<span class="sy0">:</span><span class="kw4">longint</span>;
    <span class="kw1">end</span>;
&#160;
<span class="kw1">var</span> sa<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    rank<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span><span class="br0">&#93;</span> <span class="kw1">of</span> aaa;
    base<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    node<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">of</span> link;
    s<span class="sy0">:</span><span class="kw4">ansistring</span>;
    m<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>c<span class="sy0">,</span>tot<span class="sy0">,</span>max<span class="sy0">:</span><span class="kw4">longint</span>;
&#160;
<span class="kw1">procedure</span> Make_Trie;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    rank<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">:=</span><span class="st_h">'0'</span>;
    rank<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">:=</span><span class="st_h">'1'</span>;
    rank<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">:=</span><span class="nu0">1</span>;
    rank<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">:=</span><span class="nu0">1</span>;
    rank<span class="br0">&#91;</span><span class="nu0">2</span><span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">3</span> <span class="kw1">to</span> c <span class="kw1">do</span>
        <span class="kw1">if</span> i <span class="kw1">mod</span> <span class="nu0">2</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">+</span><span class="st_h">'0'</span>;
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">:=</span>i;
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">+</span><span class="nu0">1</span>;
                sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>sa<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span>
            <span class="kw1">end</span>
        <span class="kw1">else</span>
            <span class="kw1">begin</span>
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="sy0">+</span><span class="st_h">'1'</span>;
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">:=</span>i;
                rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">+</span><span class="nu0">1</span>;
                sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>sa<span class="br0">&#91;</span>i <span class="kw1">shr</span> <span class="nu0">1</span><span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">2</span>
            <span class="kw1">end</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Match;
<span class="kw1">var</span> i<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    k<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">if</span> k <span class="kw1">shl</span> <span class="nu0">1</span>&gt;<span class="sy0">=</span>c <span class="kw1">then</span> k<span class="sy0">:=</span>sa<span class="br0">&#91;</span>k<span class="br0">&#93;</span>;
            <span class="kw1">if</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'0'</span> <span class="kw1">then</span> k<span class="sy0">:=</span>k <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">1</span>
            <span class="kw1">else</span> k<span class="sy0">:=</span>k <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span><span class="nu0">2</span>;
            inc<span class="br0">&#40;</span>rank<span class="br0">&#91;</span>k<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span>
        <span class="kw1">end</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Add;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span>c <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
        inc<span class="br0">&#40;</span>rank<span class="br0">&#91;</span>sa<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">times</span><span class="sy0">,</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#41;</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Sort;
<span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span>c <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">sum</span>&gt;<span class="sy0">=</span>a <span class="kw1">then</span>
        <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
                <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span>&gt;max <span class="kw1">then</span> max<span class="sy0">:=</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span>;
                inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
                node<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">data</span><span class="sy0">:=</span>i;
                node<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">next</span><span class="sy0">:=</span>base<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#93;</span>;
                base<span class="br0">&#91;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">times</span><span class="br0">&#93;</span><span class="sy0">:=</span>tot
            <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Outit;
<span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    j<span class="sy0">:=</span><span class="nu0">0</span>;
    k<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>max <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">if</span> base<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
                <span class="kw3">writeln</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
                inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
                k<span class="sy0">:=</span><span class="nu0">0</span>;
                p<span class="sy0">:=</span>base<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                <span class="kw1">while</span> p&lt;&gt;<span class="nu0">0</span> <span class="kw1">do</span>
                    <span class="kw1">begin</span>
                        inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
                        <span class="kw1">if</span> k<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span>rank<span class="br0">&#91;</span>node<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="br0">&#41;</span>
                        <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>rank<span class="br0">&#91;</span>node<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#93;</span>.<span class="me1">st</span><span class="br0">&#41;</span>;
                        <span class="kw1">if</span> k<span class="sy0">=</span><span class="nu0">6</span> <span class="kw1">then</span>
                            <span class="kw1">begin</span>
                                <span class="kw3">writeln</span>;
                                k<span class="sy0">:=</span><span class="nu0">0</span>
                            <span class="kw1">end</span>;
                        p<span class="sy0">:=</span>node<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">next</span>
                    <span class="kw1">end</span>;
                <span class="kw1">if</span> k&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
                <span class="kw1">if</span> j<span class="sy0">=</span>m <span class="kw1">then</span> <span class="kw1">break</span>
            <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> Main;
<span class="kw1">var</span> s1<span class="sy0">:</span><span class="kw4">string</span>;
<span class="kw1">begin</span>
    <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>m<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw3">readln</span><span class="br0">&#40;</span>s1<span class="br0">&#41;</span>;
            s<span class="sy0">:=</span>s<span class="sy0">+</span>s1
        <span class="kw1">end</span>;
    n<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
    c<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">2</span>;
    Make_Trie;
    Match;
    Add;
    Sort;
    Outit
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
    rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    Main;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">(*By Jollwish*)</span>
二维数组a<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>表示i位<span class="sy0">,</span>十进制为j的二进制数出现的次数
<span class="coMULTI">{
 ID:jollwis2
 PROG:contact
 LANG:PASCAL
}</span>
<span class="kw1">var</span> a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">4095</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
    b<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">4095</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">boolean</span>;
    i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">,</span>n<span class="sy0">,</span>line<span class="sy0">,</span>m<span class="sy0">:</span><span class="kw4">longint</span>;
    s<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
    st<span class="sy0">:</span><span class="kw4">string</span>;
    tu<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">4095</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">string</span>;
    ou<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">record</span>
                           i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
                          <span class="kw1">end</span>;
    max<span class="sy0">:</span><span class="kw4">longint</span>;
    f<span class="sy0">,</span>g<span class="sy0">:</span>text;
<span class="kw1">function</span> turn<span class="br0">&#40;</span>st<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
 <span class="kw1">var</span> u<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>tw<span class="sy0">:</span><span class="kw4">longint</span>;
 <span class="kw1">begin</span>
  l<span class="sy0">:=</span>length<span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
  tw<span class="sy0">:=</span><span class="nu0">1</span>;
  u<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> k<span class="sy0">:=</span>l <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span>
   <span class="kw1">begin</span>
    u<span class="sy0">:=</span>u<span class="sy0">+</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>st<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">*</span>tw;
    tw<span class="sy0">:=</span>tw<span class="sy0">*</span><span class="nu0">2</span>;
   <span class="kw1">end</span>;
  exit<span class="br0">&#40;</span>u<span class="br0">&#41;</span>;
 <span class="kw1">end</span>;
<span class="kw1">begin</span>
 assign<span class="br0">&#40;</span>f<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
 assign<span class="br0">&#40;</span>g<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
 reset<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
 rewrite<span class="br0">&#40;</span>g<span class="br0">&#41;</span>;
 <span class="kw3">readln</span><span class="br0">&#40;</span>f<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">,</span>n<span class="br0">&#41;</span>;
 m<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span><span class="br0">&#40;</span>f<span class="br0">&#41;</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
   <span class="kw3">readln</span><span class="br0">&#40;</span>f<span class="sy0">,</span>st<span class="br0">&#41;</span>;
   <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
     inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
     s<span class="br0">&#91;</span>m<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ord</span><span class="br0">&#40;</span>st<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span>x <span class="kw1">to</span> y <span class="kw1">do</span>
  <span class="kw1">begin</span>
   <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
     <span class="kw1">if</span> j<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
       st<span class="sy0">:=</span><span class="st_h">''</span>;
       <span class="kw1">for</span> k<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> i <span class="kw1">do</span> st<span class="sy0">:=</span>st<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>
     <span class="kw1">else</span>
      <span class="kw1">begin</span>
       delete<span class="br0">&#40;</span>st<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
       st<span class="sy0">:=</span>st<span class="sy0">+</span><span class="kw3">chr</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
     k<span class="sy0">:=</span>turn<span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
     inc<span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="sy0">,</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span>;
     tu<span class="br0">&#91;</span>i<span class="sy0">,</span>k<span class="br0">&#93;</span><span class="sy0">:=</span>st;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
 fillchar<span class="br0">&#40;</span>b<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>b<span class="br0">&#41;</span><span class="sy0">,</span><span class="kw2">false</span><span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
  <span class="kw1">begin</span>
   max<span class="sy0">:=</span><span class="nu0">0</span>;
   m<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">for</span> j<span class="sy0">:=</span>x <span class="kw1">to</span> y <span class="kw1">do</span>
    <span class="kw1">for</span> k<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4095</span> <span class="kw1">do</span>
     <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>k<span class="br0">&#93;</span>&gt;max<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="kw1">not</span> b<span class="br0">&#91;</span>j<span class="sy0">,</span>k<span class="br0">&#93;</span> <span class="kw1">then</span> max<span class="sy0">:=</span>a<span class="br0">&#91;</span>j<span class="sy0">,</span>k<span class="br0">&#93;</span>;
   <span class="kw1">if</span> max<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
     close<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
     close<span class="br0">&#40;</span>g<span class="br0">&#41;</span>;
     exit;
    <span class="kw1">end</span>;
   <span class="kw3">writeln</span><span class="br0">&#40;</span>g<span class="sy0">,</span>max<span class="br0">&#41;</span>;
   <span class="kw1">for</span> j<span class="sy0">:=</span>x <span class="kw1">to</span> y <span class="kw1">do</span>
    <span class="kw1">for</span> k<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4095</span> <span class="kw1">do</span>
     <span class="kw1">if</span> a<span class="br0">&#91;</span>j<span class="sy0">,</span>k<span class="br0">&#93;</span><span class="sy0">=</span>max <span class="kw1">then</span>
      <span class="kw1">begin</span>
       b<span class="br0">&#91;</span>j<span class="sy0">,</span>k<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw2">true</span>;
       inc<span class="br0">&#40;</span>m<span class="br0">&#41;</span>;
       ou<span class="br0">&#91;</span>m<span class="br0">&#93;</span>.<span class="me1">i</span><span class="sy0">:=</span>j;
       ou<span class="br0">&#91;</span>m<span class="br0">&#93;</span>.<span class="me1">j</span><span class="sy0">:=</span>k;
      <span class="kw1">end</span>;
   <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> m <span class="kw1">do</span>
    <span class="kw1">begin</span>
     <span class="kw3">write</span><span class="br0">&#40;</span>g<span class="sy0">,</span>tu<span class="br0">&#91;</span>ou<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">i</span><span class="sy0">,</span>ou<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">j</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
     <span class="kw1">if</span> j <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>g<span class="br0">&#41;</span>
     <span class="kw1">else</span>
      <span class="kw1">begin</span>
       <span class="kw1">if</span> j<span class="sy0">=</span>m <span class="kw1">then</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>g<span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span>g<span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
 close<span class="br0">&#40;</span>f<span class="br0">&#41;</span>;
 close<span class="br0">&#40;</span>g<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:LXYXYNT3
PROB:contact
LANG:PASCAL
}</span>
<span class="kw1">const</span>
  inf<span class="sy0">=</span><span class="st_h">'contact.in'</span>;
  ouf<span class="sy0">=</span><span class="st_h">'contact.out'</span>;
  maxn<span class="sy0">=</span><span class="nu0">2</span>&lt;&lt;<span class="nu0">12</span>;
  maxm<span class="sy0">=</span><span class="nu0">200000</span>;
&#160;
<span class="kw1">type</span>
  trie<span class="sy0">=</span><span class="kw4">record</span>
         k<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
         data<span class="sy0">:</span><span class="kw4">longint</span>;
         s<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
       <span class="kw1">end</span>;
<span class="kw1">var</span>
  a<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxn</span><span class="br0">&#93;</span> <span class="kw1">of</span> trie;
  b<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">maxm</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>;
  d<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="me1">maxn</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
  nn<span class="sy0">,</span>sum<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>k<span class="sy0">,</span>p<span class="sy0">,</span>q<span class="sy0">:</span><span class="kw4">longint</span>;
  ch<span class="sy0">:</span><span class="kw4">char</span>;
&#160;
<span class="kw1">function</span> min<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> a&lt;b <span class="kw1">then</span> exit<span class="br0">&#40;</span>a<span class="br0">&#41;</span>
         <span class="kw1">else</span> exit<span class="br0">&#40;</span>b<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> max<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> a&gt;b <span class="kw1">then</span> exit<span class="br0">&#40;</span>a<span class="br0">&#41;</span>
         <span class="kw1">else</span> exit<span class="br0">&#40;</span>b<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> work<span class="br0">&#40;</span>s<span class="sy0">,</span>t<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  j<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>s <span class="kw1">to</span> t <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">if</span> a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>nn<span class="br0">&#41;</span>;
      a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>nn;
      a<span class="br0">&#91;</span>nn<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">+</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> i<span class="sy0">-</span>s<span class="sy0">+</span><span class="nu0">1</span>&gt;<span class="sy0">=</span>n <span class="kw1">then</span> inc<span class="br0">&#40;</span>a<span class="br0">&#91;</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#41;</span>;
    j<span class="sy0">:=</span>a<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
  <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> find<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">var</span>
  i<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  find<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> nn <span class="kw1">do</span>
   find<span class="sy0">:=</span>max<span class="br0">&#40;</span>find<span class="sy0">,</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">data</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> <span class="kw1">try</span><span class="br0">&#40;</span>p<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> a<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">data</span><span class="sy0">=</span>k <span class="kw1">then</span>
  <span class="kw1">begin</span>
    a<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">data</span><span class="sy0">:=-</span><span class="nu0">1</span>;
    <span class="kw1">if</span> q&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>
            <span class="kw1">else</span> <span class="kw3">writeln</span>;
    <span class="kw3">write</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>;
    inc<span class="br0">&#40;</span>q<span class="br0">&#41;</span>;
    <span class="kw1">if</span> q<span class="sy0">=</span><span class="nu0">6</span> <span class="kw1">then</span> q<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">end</span>;
  <span class="kw1">for</span> ch<span class="sy0">:=</span><span class="st_h">'0'</span> <span class="kw1">to</span> <span class="st_h">'1'</span> <span class="kw1">do</span>
   <span class="kw1">if</span> a<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>ch<span class="br0">&#93;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
   <span class="kw1">begin</span>
     inc<span class="br0">&#40;</span>d<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
     d<span class="br0">&#91;</span>d<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span>a<span class="br0">&#91;</span>p<span class="br0">&#93;</span>.<span class="me1">k</span><span class="br0">&#91;</span>ch<span class="br0">&#93;</span>;
   <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> print<span class="br0">&#40;</span>k<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  q<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw3">write</span><span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
  <span class="kw1">while</span> p&lt;<span class="sy0">=</span>d<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">try</span><span class="br0">&#40;</span>d<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">,</span>k<span class="br0">&#41;</span>;
    inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span>inf<span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span>ouf<span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>n<span class="sy0">,</span>m<span class="sy0">,</span>k<span class="br0">&#41;</span>;
  sum<span class="sy0">:=</span><span class="nu0">0</span>;
  nn<span class="sy0">:=</span><span class="nu0">1</span>;
  fillchar<span class="br0">&#40;</span>a<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>ch&lt;<span class="st_h">'0'</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>ch&gt;<span class="st_h">'1'</span><span class="br0">&#41;</span> <span class="kw1">then</span> continue;
    inc<span class="br0">&#40;</span>sum<span class="br0">&#41;</span>;
    b<span class="br0">&#91;</span>sum<span class="br0">&#93;</span><span class="sy0">:=</span>ch;
  <span class="kw1">end</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> sum<span class="sy0">-</span>n<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span> work<span class="br0">&#40;</span>i<span class="sy0">,</span>min<span class="br0">&#40;</span>i<span class="sy0">+</span>m<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span>sum<span class="br0">&#41;</span><span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> k <span class="kw1">do</span>
  <span class="kw1">begin</span>
    j<span class="sy0">:=</span>find;
    <span class="kw1">if</span> j<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">break</span>;
    fillchar<span class="br0">&#40;</span>d<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>d<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
    d<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
    d<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
    p<span class="sy0">:=</span><span class="nu0">1</span>;
    print<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p><br />
</p><p><br />
</p><p><br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="co1">//暴力枚举！！！</span>
<span class="coMULTI">{
PROB:contact
LANG:PASCAL
}</span>
<span class="coMULTI">{$A+,B-,D-,E-,F-,G+,I-,L-,N-,O-,P+,Q-,R-,S-,T-,V-,X+,Y-}</span>
<span class="coMULTI">{$M 65520,0,655360}</span>
<span class="coMULTI">{$inline on}</span>
<span class="kw1">var</span>
  s<span class="sy0">:</span><span class="kw4">ansistring</span>;
  x<span class="sy0">,</span>y<span class="sy0">,</span>n<span class="sy0">:</span><span class="kw4">longint</span>;
  f<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4096</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  f_st<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4096</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">ansistring</span>;
  ans<span class="sy0">,</span>len<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">49152</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  ans_st<span class="sy0">:</span><span class="kw4">array</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">49152</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">ansistring</span>;
&#160;
<span class="kw1">procedure</span> assignfile;<span class="kw1">inline</span>;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> closefile;<span class="kw1">inline</span>;
<span class="kw1">begin</span>
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> change<span class="br0">&#40;</span>s<span class="sy0">:</span><span class="kw4">ansistring</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;<span class="kw1">inline</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>len<span class="sy0">,</span>temp<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  len<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
  temp<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> len <span class="kw1">do</span> inc<span class="br0">&#40;</span>temp<span class="sy0">,</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span><span class="br0">&#41;</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>len<span class="sy0">-</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span>;
  exit<span class="br0">&#40;</span>temp<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>low<span class="sy0">,</span>high<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;<span class="kw1">inline</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">,</span>t<span class="sy0">,</span>mid1<span class="sy0">,</span>mid2<span class="sy0">:</span><span class="kw4">longint</span>;
  s<span class="sy0">,</span>mid3<span class="sy0">:</span><span class="kw4">ansistring</span>;
<span class="kw1">begin</span>
  i<span class="sy0">:=</span>low;
  j<span class="sy0">:=</span>high;
  mid1<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  mid2<span class="sy0">:=</span>len<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  mid3<span class="sy0">:=</span>ans_st<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
    <span class="kw1">repeat</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;mid1<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>mid1<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;mid2<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>mid1<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>mid2<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;mid3<span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>&lt;mid1<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span>mid1<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>j<span class="br0">&#93;</span>&gt;mid2<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span>mid1<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span>mid2<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>j<span class="br0">&#93;</span>&gt;mid3<span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
        <span class="kw1">begin</span>
          t<span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
          ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
          ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>t;
          t<span class="sy0">:=</span>len<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
          len<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>len<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
          len<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>t;
          s<span class="sy0">:=</span>ans_st<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
          ans_st<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>ans_st<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
          ans_st<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>s;
          inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
          dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
    <span class="kw1">until</span> i&gt;j;
    <span class="kw1">if</span> low&lt;j <span class="kw1">then</span> qsort<span class="br0">&#40;</span>low<span class="sy0">,</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;high <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>high<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> init;<span class="kw1">inline</span>;
<span class="kw1">var</span>
  st<span class="sy0">:</span><span class="kw4">ansistring</span>;
  temp<span class="sy0">:</span><span class="kw4">char</span>;
<span class="kw1">begin</span>
  <span class="kw3">readln</span><span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  s<span class="sy0">:=</span><span class="st_h">''</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw3">read</span><span class="br0">&#40;</span>temp<span class="br0">&#41;</span>;
          <span class="kw1">if</span> temp <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">then</span> s<span class="sy0">:=</span>s<span class="sy0">+</span>temp;
      <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> work;<span class="kw1">inline</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>sum<span class="sy0">,</span>temp<span class="sy0">:</span><span class="kw4">longint</span>;
  st<span class="sy0">:</span><span class="kw4">ansistring</span>;
<span class="kw1">begin</span>
  l<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>x <span class="kw1">to</span> l <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span>x <span class="kw1">to</span> y <span class="kw1">do</span>
        <span class="kw1">if</span> i&gt;<span class="sy0">=</span>j <span class="kw1">then</span>
          <span class="kw1">begin</span>
            st<span class="sy0">:=</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>j<span class="br0">&#41;</span>;
            temp<span class="sy0">:=</span>change<span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
            inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>temp<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
            f_st<span class="br0">&#91;</span>temp<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>st;
          <span class="kw1">end</span>;
  sum<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4096</span> <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span>x <span class="kw1">to</span> y <span class="kw1">do</span>
        <span class="kw1">if</span> f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
          <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>sum<span class="br0">&#41;</span>;
            ans<span class="br0">&#91;</span>sum<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
            ans_st<span class="br0">&#91;</span>sum<span class="br0">&#93;</span><span class="sy0">:=</span>f_st<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
            len<span class="br0">&#91;</span>sum<span class="br0">&#93;</span><span class="sy0">:=</span>length<span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>sum<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>sum<span class="br0">&#41;</span>;
  i<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>i&lt;<span class="sy0">=</span>sum<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>n&gt;<span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
        j<span class="sy0">:=</span>i;
          <span class="kw1">while</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>ans<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        temp<span class="sy0">:=</span><span class="nu0">0</span>;
          <span class="kw1">for</span> k<span class="sy0">:=</span>j <span class="kw1">to</span> i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
            <span class="kw1">begin</span>
              inc<span class="br0">&#40;</span>temp<span class="br0">&#41;</span>;
                <span class="kw1">if</span> temp <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span>
                  <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
            <span class="kw1">end</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>ans_st<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assignfile;
  init;
  work;
  closefile;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=4" title="编辑段落：代码1">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.811">代码1</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID: starfor1
PROG: contact
LANG: PASCAL
}</span>
<span class="kw1">const</span>
  sn<span class="sy0">=</span><span class="nu0">8190</span>;
<span class="kw1">type</span>
  data<span class="sy0">=</span>
  <span class="kw4">record</span>
    bina<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
    count<span class="sy0">:</span>dword;
  <span class="kw1">end</span>;
<span class="kw1">var</span>
  a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>l<span class="sy0">,</span>i<span class="sy0">,</span>wd<span class="sy0">:</span><span class="kw4">byte</span>;
  ch<span class="sy0">:</span><span class="kw4">char</span>;
  s<span class="sy0">,</span>d<span class="sy0">,</span>u<span class="sy0">,</span>v<span class="sy0">:</span><span class="kw4">word</span>;
  curr<span class="sy0">:</span>dword;
  slot<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="me1">sn</span><span class="br0">&#93;</span><span class="kw1">of</span> data;
  x2<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">13</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">word</span>;
  bi<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
  swap<span class="sy0">,</span>mid<span class="sy0">:</span>data;
  stop<span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="co1">//</span>
<span class="kw1">function</span> more <span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span>data<span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> a.<span class="me1">count</span>&gt;b.<span class="me1">count</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">count</span>&lt;b.<span class="me1">count</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&lt;b.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&gt;b.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span>&lt;b.<span class="me1">bina</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span>&gt;b.<span class="me1">bina</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//</span>
<span class="kw1">function</span> less <span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span>data<span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  <span class="kw1">if</span> a.<span class="me1">count</span>&lt;b.<span class="me1">count</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">count</span>&gt;b.<span class="me1">count</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&gt;b.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&lt;b.<span class="me1">bina</span><span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span>&gt;b.<span class="me1">bina</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> a.<span class="me1">bina</span>&lt;b.<span class="me1">bina</span> <span class="kw1">then</span>
    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//</span>
<span class="kw1">procedure</span> qsort <span class="br0">&#40;</span>f<span class="sy0">,</span>e<span class="sy0">:</span><span class="kw4">word</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">word</span>;
<span class="kw1">begin</span>
  mid<span class="sy0">:=</span>slot<span class="br0">&#91;</span>random<span class="br0">&#40;</span>e<span class="sy0">-</span>f<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>f<span class="br0">&#93;</span>;
  i<span class="sy0">:=</span>f;
  j<span class="sy0">:=</span>e;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> more<span class="br0">&#40;</span>slot<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>mid<span class="br0">&#41;</span> <span class="kw1">do</span>
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw1">while</span> less<span class="br0">&#40;</span>slot<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">,</span>mid<span class="br0">&#41;</span> <span class="kw1">do</span>
      dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
    <span class="kw1">begin</span>
      swap<span class="sy0">:=</span>slot<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
      slot<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>slot<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
      slot<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>swap;
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">until</span> i&gt;j;
  <span class="kw1">if</span> i&lt;e <span class="kw1">then</span>
    qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>e<span class="br0">&#41;</span>;
  <span class="kw1">if</span> f&lt;j <span class="kw1">then</span>
    qsort<span class="br0">&#40;</span>f<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="co1">//</span>
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  x2<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">2</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> <span class="nu0">13</span> <span class="kw1">do</span>
    x2<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>x2<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">*</span><span class="nu0">2</span>;
  <span class="kw1">for</span> l<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
  <span class="kw1">begin</span>
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    <span class="kw3">readln</span>;
    s<span class="sy0">:=</span><span class="nu0">0</span>;
    d<span class="sy0">:=</span>x2<span class="br0">&#91;</span>l<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">2</span>;
    bi<span class="sy0">:=</span><span class="st_h">''</span>;
    stop<span class="sy0">:=</span><span class="kw2">false</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
      bi<span class="sy0">:=</span>bi<span class="sy0">+</span>ch;
      s<span class="sy0">:=</span>s<span class="sy0">*</span><span class="nu0">2</span>;
      <span class="kw1">if</span> ch<span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span>
        s<span class="sy0">:=</span>s<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">if</span> <span class="kw3">eoln</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i&lt;l<span class="br0">&#41;</span> <span class="kw1">then</span>
        stop<span class="sy0">:=</span><span class="kw2">true</span>;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> stop <span class="kw1">then</span>
    <span class="kw1">begin</span>
      b<span class="sy0">:=</span>l<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">break</span>;
    <span class="kw1">end</span>;
    <span class="kw1">if</span> slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">bina</span><span class="sy0">=</span><span class="st_h">''</span> <span class="kw1">then</span>
      slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">bina</span><span class="sy0">:=</span>bi;
    inc<span class="br0">&#40;</span>slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">count</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> <span class="kw3">eoln</span> <span class="kw1">then</span>
      <span class="kw3">readln</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
      delete<span class="br0">&#40;</span>bi<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
      bi<span class="sy0">:=</span>bi<span class="sy0">+</span>ch;
      s<span class="sy0">:=</span>s<span class="sy0">*</span><span class="nu0">2</span> <span class="kw1">mod</span> x2<span class="br0">&#91;</span>l<span class="br0">&#93;</span>;
      <span class="kw1">if</span> ch<span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span>
        s<span class="sy0">:=</span>s<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">if</span> slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">bina</span><span class="sy0">=</span><span class="st_h">''</span> <span class="kw1">then</span>
        slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">bina</span><span class="sy0">:=</span>bi;
      inc<span class="br0">&#40;</span>slot<span class="br0">&#91;</span>s<span class="sy0">+</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">count</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="kw3">eoln</span> <span class="kw1">then</span>
        <span class="kw3">readln</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
  randomize;
  qsort<span class="br0">&#40;</span>x2<span class="br0">&#91;</span>a<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span>x2<span class="br0">&#91;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">2</span><span class="br0">&#41;</span>;
  curr<span class="sy0">:=</span>maxlongint;
  i<span class="sy0">:=</span><span class="nu0">0</span>;
  u<span class="sy0">:=</span>x2<span class="br0">&#91;</span>a<span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span>;
  <span class="kw1">while</span> u&lt;<span class="sy0">=</span>x2<span class="br0">&#91;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">2</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">if</span> slot<span class="br0">&#91;</span>u<span class="br0">&#93;</span>.<span class="me1">count</span>&lt;curr <span class="kw1">then</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>i&gt;n<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>slot<span class="br0">&#91;</span>u<span class="br0">&#93;</span>.<span class="me1">count</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span>
        <span class="kw1">break</span>;
      curr<span class="sy0">:=</span>slot<span class="br0">&#91;</span>u<span class="br0">&#93;</span>.<span class="me1">count</span>;
      <span class="kw3">writeln</span><span class="br0">&#40;</span>curr<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    <span class="kw3">write</span><span class="br0">&#40;</span>slot<span class="br0">&#91;</span>u<span class="br0">&#93;</span>.<span class="me1">bina</span><span class="br0">&#41;</span>;
    v<span class="sy0">:=</span>u<span class="sy0">+</span><span class="nu0">1</span>;
    wd<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>v&lt;<span class="sy0">=</span>x2<span class="br0">&#91;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">2</span><span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>slot<span class="br0">&#91;</span>v<span class="br0">&#93;</span>.<span class="me1">count</span><span class="sy0">=</span>curr<span class="br0">&#41;</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>wd<span class="br0">&#41;</span>;
      <span class="kw1">if</span> wd&gt;<span class="nu0">6</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        wd<span class="sy0">:=</span><span class="nu0">1</span>;
        <span class="kw3">writeln</span>;
      <span class="kw1">end</span>;
      <span class="kw1">if</span> wd&lt;&gt;<span class="nu0">1</span> <span class="kw1">then</span>
        <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
      <span class="kw3">write</span><span class="br0">&#40;</span>slot<span class="br0">&#91;</span>v<span class="br0">&#93;</span>.<span class="me1">bina</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>v<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    <span class="kw3">writeln</span>;
    u<span class="sy0">:=</span>v;
  <span class="kw1">end</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=5" title="编辑段落：代码2">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.812">代码2</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:ronice.1
PROG:contact
LANG:PASCAL
}</span>
<span class="kw1">var</span>
  s<span class="sy0">,</span>ns<span class="sy0">:</span><span class="kw4">string</span>;
  n<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">:</span><span class="kw4">integer</span>;
  min<span class="sy0">,</span>max<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">integer</span>;
  ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">8191</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  rank<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">50</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
&#160;
<span class="kw1">Function</span> s2n<span class="br0">&#40;</span>m<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">integer</span>;  <span class="co1">//字符串转十进制数</span>
<span class="kw1">begin</span>
  s2n<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>m<span class="br0">&#41;</span> <span class="kw1">do</span>
    s2n<span class="sy0">:=</span>s2n<span class="sy0">*</span><span class="nu0">2</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span>m<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">Function</span> n2s<span class="br0">&#40;</span>m<span class="sy0">:</span><span class="kw4">integer</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">string</span>;  <span class="co1">//十进制数转字符串</span>
<span class="kw1">begin</span>
  n2s<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">while</span> m&gt;<span class="nu0">0</span> <span class="kw1">do</span> <span class="kw1">begin</span>
    <span class="kw1">if</span> m <span class="kw3">and</span> <span class="nu0">1</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
      n2s<span class="sy0">:=</span><span class="st_h">'1'</span><span class="sy0">+</span>n2s <span class="kw1">else</span>
      n2s<span class="sy0">:=</span><span class="st_h">'0'</span><span class="sy0">+</span>n2s;
    m<span class="sy0">:=</span>m <span class="kw1">shr</span> <span class="nu0">1</span>;
  <span class="kw1">end</span>;
  delete<span class="br0">&#40;</span>n2s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  <span class="co1">//处理输入数据</span>
  Assign<span class="br0">&#40;</span>Input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  Reset<span class="br0">&#40;</span>Input<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  s<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span> <span class="kw1">begin</span>
    <span class="kw3">readln</span><span class="br0">&#40;</span>ns<span class="br0">&#41;</span>;
    s<span class="sy0">:=</span>s<span class="sy0">+</span>ns;
    <span class="kw1">while</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>&gt;<span class="sy0">=</span>b <span class="kw1">do</span> <span class="kw1">begin</span>
      <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
        inc<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>s2n<span class="br0">&#40;</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
      delete<span class="br0">&#40;</span>s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">end</span>;
  l<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
  <span class="kw1">while</span> l&gt;<span class="sy0">=</span>a <span class="kw1">do</span> <span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> l <span class="kw1">do</span>
      inc<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>s2n<span class="br0">&#40;</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    delete<span class="br0">&#40;</span>s<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
    dec<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
  Close<span class="br0">&#40;</span>Input<span class="br0">&#41;</span>;    
&#160;
  Assign<span class="br0">&#40;</span>Output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  Rewrite<span class="br0">&#40;</span>Output<span class="br0">&#41;</span>;
  fillchar<span class="br0">&#40;</span>rank<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>rank<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
  min<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> a;
  max<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span>;
  <span class="co1">//排序</span>
  <span class="kw1">for</span> i<span class="sy0">:=</span>min <span class="kw1">to</span> max <span class="kw1">do</span>
    <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;rank<span class="br0">&#91;</span>n<span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="sy0">=</span>rank<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
      <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;rank<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
       <span class="kw1">for</span> k<span class="sy0">:=</span>n <span class="kw1">downto</span> j<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
         rank<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">:=</span>rank<span class="br0">&#91;</span>k<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>;
       rank<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
     <span class="kw1">end</span>;
   <span class="kw1">end</span>;
  <span class="co1">//输出</span>
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
   <span class="kw1">if</span> rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span>
   <span class="kw3">writeln</span><span class="br0">&#40;</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
   j<span class="sy0">:=</span>max;
   l<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">while</span> ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>&lt;&gt;rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
   <span class="kw1">for</span> k<span class="sy0">:=</span>min <span class="kw1">to</span> j<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
     <span class="kw1">if</span> ans<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">=</span>rank<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span> <span class="kw1">begin</span>
       inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
       <span class="kw1">if</span> l <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
         <span class="kw3">writeln</span><span class="br0">&#40;</span>n2s<span class="br0">&#40;</span>k<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">else</span>
         <span class="kw3">write</span><span class="br0">&#40;</span>n2s<span class="br0">&#40;</span>k<span class="br0">&#41;</span><span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
     <span class="kw1">end</span>;
   <span class="kw3">writeln</span><span class="br0">&#40;</span>n2s<span class="br0">&#40;</span>j<span class="br0">&#41;</span><span class="br0">&#41;</span>;
 <span class="kw1">end</span>;
 Close<span class="br0">&#40;</span>Output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=6" title="编辑段落：代码3">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.813">代码3</span></h2>
<p>纯粹死模拟，一般人都能看懂……
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID: rock_li1
PROG: contact
LANG: PASCAL
}</span>
<span class="kw1">program</span> xx;
<span class="kw1">var</span> a<span class="sy0">,</span> b<span class="sy0">,</span> n<span class="sy0">,</span> j<span class="sy0">,</span> i1<span class="sy0">,</span> j1<span class="sy0">:</span> <span class="kw4">integer</span>;
    i<span class="sy0">,</span> head<span class="sy0">,</span> t<span class="sy0">:</span> <span class="kw4">longint</span>;
    e<span class="sy0">:</span> <span class="kw4">ansistring</span>;
    c<span class="sy0">:</span> <span class="kw4">char</span>;
    ss<span class="sy0">:</span> <span class="kw4">string</span>;
    ans   <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4096</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    appear<span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
    p     <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4096</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
    s     <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
&#160;
<span class="kw1">function</span> change_10<span class="br0">&#40;</span>x<span class="sy0">:</span> <span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span> <span class="kw4">integer</span>;
<span class="kw1">var</span> i<span class="sy0">,</span> l<span class="sy0">:</span> <span class="kw4">integer</span>;
<span class="kw1">begin</span>
  change_10 <span class="sy0">:=</span> <span class="nu0">0</span>;
  l <span class="sy0">:=</span> length<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span> inc<span class="br0">&#40;</span>change_10<span class="sy0">,</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span><span class="br0">&#41;</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>l<span class="sy0">-</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span> r<span class="sy0">:</span> <span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> i<span class="sy0">,</span> j<span class="sy0">,</span> mid<span class="sy0">,</span> k<span class="sy0">:</span> <span class="kw4">longint</span>;
    t<span class="sy0">:</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
<span class="kw1">begin</span>
  i <span class="sy0">:=</span> l; j <span class="sy0">:=</span> r; mid <span class="sy0">:=</span> appear<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> appear<span class="br0">&#91;</span>i<span class="br0">&#93;</span> &gt; mid <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw1">while</span> appear<span class="br0">&#91;</span>j<span class="br0">&#93;</span> &lt; mid <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i &lt;<span class="sy0">=</span> j <span class="kw1">then</span>
      <span class="kw1">begin</span>
        k <span class="sy0">:=</span> appear<span class="br0">&#91;</span>i<span class="br0">&#93;</span>; appear<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">:=</span> appear<span class="br0">&#91;</span>j<span class="br0">&#93;</span>; appear<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy0">:=</span> k;
        t <span class="sy0">:=</span> s<span class="br0">&#91;</span>i<span class="br0">&#93;</span>; s<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">:=</span> s<span class="br0">&#91;</span>j<span class="br0">&#93;</span>; s<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy0">:=</span> t;
        inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>; dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
  <span class="kw1">until</span> i &gt; j;
  <span class="kw1">if</span> l &lt; j <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span> j<span class="br0">&#41;</span>;
  <span class="kw1">if</span> i &lt; r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span> r<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> pd<span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="sy0">:</span> <span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">:</span> <span class="kw4">boolean</span>;
<span class="kw1">begin</span>
  pd <span class="sy0">:=</span> <span class="kw2">true</span>;
  <span class="kw1">if</span> length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> &gt; length<span class="br0">&#40;</span>a<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">if</span> length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="sy0">=</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span> <span class="kw1">then</span>
  <span class="kw1">if</span> b &gt; a <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="sy0">,</span> n<span class="br0">&#41;</span>;
  e <span class="sy0">:=</span> <span class="st_h">''</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw3">read</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
      <span class="kw1">if</span> c <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">then</span> e <span class="sy0">:=</span> e <span class="sy0">+</span> c;
    <span class="kw1">end</span>;
&#160;
  <span class="kw1">for</span> i<span class="sy0">:=</span> a <span class="kw1">to</span> length<span class="br0">&#40;</span>e<span class="br0">&#41;</span> <span class="kw1">do</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span> a <span class="kw1">to</span> b <span class="kw1">do</span>
      <span class="kw1">if</span> i<span class="sy0">-</span>j &gt;<span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        ss <span class="sy0">:=</span> copy<span class="br0">&#40;</span>e<span class="sy0">,</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span> j<span class="br0">&#41;</span>;
        inc<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>change_10<span class="br0">&#40;</span>ss<span class="br0">&#41;</span><span class="sy0">,</span> j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
        p<span class="br0">&#91;</span>change_10<span class="br0">&#40;</span>ss<span class="br0">&#41;</span><span class="sy0">,</span> j<span class="br0">&#93;</span> <span class="sy0">:=</span> ss;
      <span class="kw1">end</span>;
&#160;
  head <span class="sy0">:=</span> <span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4096</span> <span class="kw1">do</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span> a <span class="kw1">to</span> b <span class="kw1">do</span>
    <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="sy0">,</span> j<span class="br0">&#93;</span> &gt; <span class="nu0">0</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>head<span class="br0">&#41;</span>;
        appear<span class="br0">&#91;</span>head<span class="br0">&#93;</span> <span class="sy0">:=</span> ans<span class="br0">&#91;</span>i<span class="sy0">,</span> j<span class="br0">&#93;</span>;
        s<span class="br0">&#91;</span>head<span class="br0">&#93;</span> <span class="sy0">:=</span> p<span class="br0">&#91;</span>i<span class="sy0">,</span> j<span class="br0">&#93;</span>;
      <span class="kw1">end</span>;
&#160;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span> head<span class="br0">&#41;</span>;
&#160;
  i <span class="sy0">:=</span> <span class="nu0">1</span>;
  <span class="kw1">while</span> <span class="br0">&#40;</span>i &lt;<span class="sy0">=</span> head<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>n &gt; <span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      t <span class="sy0">:=</span> appear<span class="br0">&#91;</span>i<span class="br0">&#93;</span>; j <span class="sy0">:=</span> i;
      <span class="kw3">writeln</span><span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
      <span class="kw1">while</span> appear<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="sy0">=</span> t <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
&#160;
      <span class="kw1">for</span> i1 <span class="sy0">:=</span> j <span class="kw1">to</span> i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">for</span> j1 <span class="sy0">:=</span> i1<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> i <span class="kw1">do</span>
          <span class="kw1">if</span> pd<span class="br0">&#40;</span>s<span class="br0">&#91;</span>i1<span class="br0">&#93;</span><span class="sy0">,</span> s<span class="br0">&#91;</span>j1<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
              ss <span class="sy0">:=</span> s<span class="br0">&#91;</span>i1<span class="br0">&#93;</span>;
              s<span class="br0">&#91;</span>i1<span class="br0">&#93;</span> <span class="sy0">:=</span> s<span class="br0">&#91;</span>j1<span class="br0">&#93;</span>;
              s<span class="br0">&#91;</span>j1<span class="br0">&#93;</span> <span class="sy0">:=</span> ss;
            <span class="kw1">end</span>;
&#160;
      t <span class="sy0">:=</span> <span class="nu0">0</span>;
      <span class="kw1">for</span> j1 <span class="sy0">:=</span> j <span class="kw1">to</span> i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
          <span class="kw1">if</span> t <span class="kw1">mod</span> <span class="nu0">6</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j1<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j1<span class="br0">&#93;</span><span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
      <span class="kw3">writeln</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
&#160;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=7" title="编辑段落：代码4（核心思路）">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.814.EF.BC.88.E6.A0.B8.E5.BF.83.E6.80.9D.E8.B7.AF.EF.BC.89">代码4（核心思路）</span></h2>
<p>用满二叉树表示。
完整代码见： <a rel="nofollow" class="external free" href="http://dfs35123.spaces.live.com/?_c11_BlogPart_BlogPart=blogview&amp;_c=BlogPart&amp;partqs=cat%3dSection%2b3.1">http://dfs35123.spaces.live.com/?_c11_BlogPart_BlogPart=blogview&amp;_c=BlogPart&amp;partqs=cat%3dSection%2b3.1</a>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
PROB:contact
LANG:PASCAL
}</span>
<span class="kw1">program</span> contact;
<span class="kw1">var</span>
 node<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">30000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">string</span>;
 num<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">30000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
 q<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">50</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
 i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>m<span class="sy0">,</span>p<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>t1<span class="sy0">,</span>l<span class="sy0">,</span>top<span class="sy0">:</span><span class="kw4">longint</span>;
 t2<span class="sy0">:</span><span class="kw4">string</span>;
 s<span class="sy0">:</span><span class="kw4">ansistring</span>;
 c<span class="sy0">:</span><span class="kw4">char</span>;
 f<span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
<span class="co1">//读入数据（略）</span>
&#160;
 l<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
  <span class="kw1">for</span> j<span class="sy0">:=</span>i<span class="sy0">-</span>b<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> i<span class="sy0">-</span>a<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
  <span class="co1">//枚举每个子串</span>
   <span class="kw1">begin</span>
    <span class="kw1">if</span> j&lt;<span class="nu0">1</span> <span class="kw1">then</span> continue;
    k<span class="sy0">:=</span>j;p<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="co1">//p赋值为根结点</span>
    <span class="kw1">while</span> k&lt;i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
     <span class="kw1">begin</span>
      p<span class="sy0">:=</span><span class="nu0">2</span><span class="sy0">*</span>p;
      <span class="kw1">if</span> s<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
     <span class="kw1">end</span>;
    inc<span class="br0">&#40;</span>num<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="co1">//该结点的计数加1</span>
    <span class="kw1">if</span> node<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">''</span> <span class="kw1">then</span> node<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="sy0">:=</span>copy<span class="br0">&#40;</span>s<span class="sy0">,</span>j<span class="sy0">,</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;<span class="co1">//储存字串</span>
   <span class="kw1">end</span>;
&#160;
<span class="co1">//排序和输出（略）</span>
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{ID:31440461
PROG: contact
LANG: PASCAL
}</span>
&#160;
<span class="kw1">type</span> re<span class="sy0">=</span><span class="kw4">record</span>
     sum<span class="sy0">,</span>chuan<span class="sy0">:</span><span class="kw4">longint</span>;
     <span class="kw1">end</span>;
<span class="kw1">var</span> count<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">13</span><span class="sy0">*</span><span class="nu0">1024</span><span class="sy0">*</span><span class="nu0">4</span><span class="br0">&#93;</span> <span class="kw1">of</span> re;
    a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>t<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>qi<span class="sy0">,</span>mo<span class="sy0">:</span><span class="kw4">longint</span>;
    q<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
    st<span class="sy0">:</span><span class="kw4">string</span>;
&#160;
<span class="kw1">function</span> cal<span class="br0">&#40;</span>j<span class="sy0">,</span>i<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">var</span> ans<span class="sy0">,</span>c<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  ans<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> c<span class="sy0">:=</span>j <span class="kw1">to</span> j<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
    ans<span class="sy0">:=</span>ans <span class="kw1">shl</span> <span class="nu0">1</span><span class="sy0">+</span>q<span class="br0">&#91;</span>c<span class="br0">&#93;</span>;
  exit<span class="br0">&#40;</span>ans<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort1<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> mid<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
    x<span class="sy0">:</span>re;
<span class="kw1">begin</span>
  mid<span class="sy0">:=</span>count<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>.<span class="me1">sum</span>;
  i<span class="sy0">:=</span>l;
  j<span class="sy0">:=</span>r;
  <span class="kw1">repeat</span>
   <span class="kw1">while</span> count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">sum</span>&gt;mid <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
   <span class="kw1">while</span> count<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">sum</span>&lt;mid <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
   <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span> <span class="kw1">begin</span> x<span class="sy0">:=</span>count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                      count<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>count<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
                      count<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>x;
                        inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
  <span class="kw1">until</span> i&gt;j;
  <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort1<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
  <span class="kw1">if</span> j&gt;l <span class="kw1">then</span> qsort1<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort2<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> mid<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
    x<span class="sy0">:</span>re;
<span class="kw1">begin</span>
  mid<span class="sy0">:=</span>count<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>.<span class="me1">chuan</span>;
  i<span class="sy0">:=</span>l;
  j<span class="sy0">:=</span>r;
  <span class="kw1">repeat</span>
  <span class="kw1">while</span> count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">chuan</span>&lt;mid <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
  <span class="kw1">while</span> count<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">chuan</span>&gt;mid <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
  <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span> <span class="kw1">begin</span> x<span class="sy0">:=</span>count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
                     count<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>count<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
                     count<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>x;
                     inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
               <span class="kw1">end</span>;
  <span class="kw1">until</span> i&gt;j;
  <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort2<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
  <span class="kw1">if</span> j&gt;l <span class="kw1">then</span> qsort2<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> print<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span> c<span class="sy0">,</span>w<span class="sy0">,</span>e<span class="sy0">,</span>how<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  how<span class="sy0">:=</span><span class="nu0">1</span>;
  w<span class="sy0">:=</span>count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">chuan</span> <span class="kw1">shr</span> <span class="nu0">12</span>;
  <span class="kw1">for</span> e<span class="sy0">:=</span>w<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">downto</span> <span class="nu0">0</span> <span class="kw1">do</span>
     <span class="kw3">write</span><span class="br0">&#40;</span><span class="br0">&#40;</span>count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">chuan</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> e<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">shr</span> e<span class="br0">&#41;</span>;
  <span class="kw1">for</span> c<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> j <span class="kw1">do</span>
   <span class="kw1">begin</span> 
         w<span class="sy0">:=</span>count<span class="br0">&#91;</span>c<span class="br0">&#93;</span>.<span class="me1">chuan</span> <span class="kw1">shr</span> <span class="nu0">12</span>;
         <span class="kw1">if</span> how <span class="kw1">mod</span> <span class="nu0">6</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span>
         <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
         <span class="kw1">for</span> e<span class="sy0">:=</span>w<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">downto</span> <span class="nu0">0</span> <span class="kw1">do</span>
         <span class="kw3">write</span><span class="br0">&#40;</span><span class="br0">&#40;</span>count<span class="br0">&#91;</span>c<span class="br0">&#93;</span>.<span class="me1">chuan</span> <span class="kw3">and</span> <span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> e<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">shr</span> e<span class="br0">&#41;</span>;
         inc<span class="br0">&#40;</span>how<span class="br0">&#41;</span>;
         <span class="kw1">if</span> <span class="br0">&#40;</span>how <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>how&lt;&gt;j<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
   <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
<span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
<span class="kw1">begin</span>
<span class="kw3">readln</span><span class="br0">&#40;</span>st<span class="br0">&#41;</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">do</span>
<span class="kw1">if</span> st<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;q<span class="br0">&#91;</span>t<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw1">end</span> <span class="kw1">else</span>
<span class="kw1">if</span> st<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'0'</span> <span class="kw1">then</span> <span class="kw1">begin</span> inc<span class="br0">&#40;</span>t<span class="br0">&#41;</span>;q<span class="br0">&#91;</span>t<span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>;<span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> <span class="nu0">13</span><span class="sy0">*</span><span class="nu0">4</span><span class="sy0">*</span><span class="nu0">1024</span> <span class="kw1">do</span> count<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">chuan</span><span class="sy0">:=</span>i;
<span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
  <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> t<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
   inc<span class="br0">&#40;</span>count<span class="br0">&#91;</span>cal<span class="br0">&#40;</span>j<span class="sy0">,</span>i<span class="br0">&#41;</span><span class="sy0">+</span>i <span class="kw1">shl</span> <span class="nu0">12</span><span class="br0">&#93;</span>.<span class="me1">sum</span><span class="br0">&#41;</span>;
&#160;
qsort1<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">13</span><span class="sy0">*</span><span class="nu0">4</span><span class="sy0">*</span><span class="nu0">1024</span><span class="br0">&#41;</span>;
&#160;
t<span class="sy0">:=</span>count<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">sum</span>;
<span class="kw1">if</span> t<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> halt;
<span class="kw1">repeat</span>
  qi<span class="sy0">:=</span>mo<span class="sy0">+</span><span class="nu0">1</span>;
  <span class="kw1">while</span> count<span class="br0">&#91;</span>qi<span class="br0">&#93;</span>.<span class="me1">sum</span><span class="sy0">=</span>t <span class="kw1">do</span> inc<span class="br0">&#40;</span>qi<span class="br0">&#41;</span>;
  qsort2<span class="br0">&#40;</span>mo<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>qi<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>;<span class="co1">//以chuan为关键字升序排列</span>
  <span class="kw3">writeln</span><span class="br0">&#40;</span>t<span class="br0">&#41;</span>;
  print<span class="br0">&#40;</span>mo<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>qi<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>;
  mo<span class="sy0">:=</span>qi<span class="sy0">-</span><span class="nu0">1</span>;
  t<span class="sy0">:=</span>count<span class="br0">&#91;</span>qi<span class="br0">&#93;</span>.<span class="me1">sum</span>;
  dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
<span class="kw1">until</span> <span class="br0">&#40;</span>t<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>n<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span>;
close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<p><br />
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID:wbool1
PROG:contact
LANG:PASCAL
}</span>
<span class="kw1">VAR</span>
  A<span class="sy0">:</span><span class="kw4">ARRAY</span> <span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">OF</span> <span class="kw4">LONGINT</span>;
  F<span class="sy0">:</span><span class="kw4">ARRAY</span> <span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">16384</span><span class="br0">&#93;</span> <span class="kw1">OF</span> <span class="kw4">LONGINT</span>;
  H<span class="sy0">:</span><span class="kw4">ARRAY</span> <span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">OF</span> <span class="kw4">BOOLEAN</span>;
  I<span class="sy0">,</span>J<span class="sy0">,</span>Z<span class="sy0">,</span>ANS<span class="sy0">,</span>X<span class="sy0">,</span>Y<span class="sy0">,</span>N<span class="sy0">,</span>MAX<span class="sy0">,</span>T<span class="sy0">,</span>L<span class="sy0">:</span><span class="kw4">LONGINT</span>;
  <span class="kw4">WORD</span><span class="sy0">:</span><span class="kw4">CHAR</span>;
  FF<span class="sy0">:</span><span class="kw4">BOOLEAN</span>;
&#160;
<span class="kw1">PROCEDURE</span> INIT;
<span class="kw1">BEGIN</span>
  Z<span class="sy0">:=</span><span class="nu0">0</span>; ANS<span class="sy0">:=</span><span class="nu0">0</span>;
  ASSIGN<span class="br0">&#40;</span>INPUT<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  RESET<span class="br0">&#40;</span>INPUT<span class="br0">&#41;</span>;
  <span class="kw3">READLN</span><span class="br0">&#40;</span>X<span class="sy0">,</span>Y<span class="sy0">,</span>N<span class="br0">&#41;</span>;
  <span class="kw1">WHILE</span> <span class="kw1">NOT</span><span class="br0">&#40;</span><span class="kw3">EOF</span><span class="br0">&#41;</span> <span class="kw1">DO</span> <span class="kw1">BEGIN</span>
    INC<span class="br0">&#40;</span>Z<span class="br0">&#41;</span>;
    <span class="kw1">IF</span> Z&gt;<span class="nu0">80</span> <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
      Z<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw3">READLN</span>;
      CONTINUE;
    <span class="kw1">END</span>;
    <span class="kw3">READ</span><span class="br0">&#40;</span><span class="kw4">WORD</span><span class="br0">&#41;</span>;
    <span class="kw1">IF</span> <span class="kw4">WORD</span> <span class="kw1">IN</span> <span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
      INC<span class="br0">&#40;</span>ANS<span class="br0">&#41;</span>;
      A<span class="br0">&#91;</span>ANS<span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw3">ORD</span><span class="br0">&#40;</span><span class="kw4">WORD</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span>;
    <span class="kw1">END</span>;
  <span class="kw1">END</span>;
  CLOSE<span class="br0">&#40;</span>INPUT<span class="br0">&#41;</span>;
  RANDOMIZE;
<span class="kw1">END</span>;
&#160;
<span class="kw1">FUNCTION</span> DOING<span class="br0">&#40;</span>X<span class="sy0">:</span><span class="kw4">LONGINT</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">STRING</span>;
<span class="kw1">VAR</span> XX<span class="sy0">,</span>T<span class="sy0">:</span><span class="kw4">LONGINT</span>; S<span class="sy0">:</span><span class="kw4">STRING</span>;
<span class="kw1">BEGIN</span>
  S<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">REPEAT</span>
    T<span class="sy0">:=</span>X <span class="kw1">SHR</span> <span class="nu0">1</span>;
    XX<span class="sy0">:=</span>X<span class="sy0">-</span>T<span class="sy0">*</span><span class="nu0">2</span>;
    S<span class="sy0">:=</span><span class="kw3">CHR</span><span class="br0">&#40;</span>XX<span class="sy0">+</span><span class="nu0">48</span><span class="br0">&#41;</span><span class="sy0">+</span>S;
    X<span class="sy0">:=</span>T;
  <span class="kw1">UNTIL</span> X<span class="sy0">=</span><span class="nu0">1</span>;
  DOING<span class="sy0">:=</span>S;
<span class="kw1">END</span>;
&#160;
<span class="kw1">PROCEDURE</span> MAIN;
<span class="kw1">BEGIN</span>
  MAX<span class="sy0">:=</span><span class="nu0">0</span>; L<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">SHL</span> <span class="br0">&#40;</span>Y<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
  FILLCHAR<span class="br0">&#40;</span>F<span class="sy0">,</span>SIZEOF<span class="br0">&#40;</span>F<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
  FILLCHAR<span class="br0">&#40;</span>H<span class="sy0">,</span>SIZEOF<span class="br0">&#40;</span>H<span class="br0">&#41;</span><span class="sy0">,</span><span class="kw2">FALSE</span><span class="br0">&#41;</span>;
  <span class="kw1">FOR</span> I<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">TO</span> ANS <span class="kw1">DO</span> <span class="kw1">BEGIN</span>
    Z<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">FOR</span> J<span class="sy0">:=</span> I <span class="kw1">TO</span> I<span class="sy0">+</span>Y<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">DO</span> <span class="kw1">BEGIN</span>
      <span class="kw1">IF</span> J&gt;ANS <span class="kw1">THEN</span> <span class="kw1">BREAK</span>;
      Z<span class="sy0">:=</span><span class="br0">&#40;</span>Z <span class="kw1">SHL</span> <span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>A<span class="br0">&#91;</span>J<span class="br0">&#93;</span>;
      <span class="kw1">IF</span> J<span class="sy0">-</span>I<span class="sy0">+</span><span class="nu0">1</span>&lt;X <span class="kw1">THEN</span>
        CONTINUE;
      INC<span class="br0">&#40;</span>F<span class="br0">&#91;</span>Z<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">END</span>;
  <span class="kw1">END</span>;
 <span class="kw1">FOR</span> I<span class="sy0">:=</span> <span class="nu0">0</span> <span class="kw1">TO</span> L <span class="kw1">DO</span> <span class="kw1">BEGIN</span>
    H<span class="br0">&#91;</span>F<span class="br0">&#91;</span>I<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="kw2">TRUE</span>;
    <span class="kw1">IF</span> F<span class="br0">&#91;</span>I<span class="br0">&#93;</span>&gt;MAX <span class="kw1">THEN</span>
      MAX<span class="sy0">:=</span>F<span class="br0">&#91;</span>I<span class="br0">&#93;</span>;
  <span class="kw1">END</span>;
  T<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">FOR</span> I<span class="sy0">:=</span> MAX <span class="kw1">DOWNTO</span> <span class="nu0">1</span> <span class="kw1">DO</span>
    <span class="kw1">IF</span> H<span class="br0">&#91;</span>I<span class="br0">&#93;</span> <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
      INC<span class="br0">&#40;</span>T<span class="br0">&#41;</span>;
      <span class="kw3">WRITELN</span><span class="br0">&#40;</span>I<span class="br0">&#41;</span>; Z<span class="sy0">:=</span><span class="nu0">0</span>; FF<span class="sy0">:=</span><span class="kw2">FALSE</span>;
      <span class="kw1">FOR</span> J<span class="sy0">:=</span> <span class="nu0">0</span> <span class="kw1">TO</span> L <span class="kw1">DO</span>
        <span class="kw1">IF</span> F<span class="br0">&#91;</span>J<span class="br0">&#93;</span><span class="sy0">=</span>I <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
          INC<span class="br0">&#40;</span>Z<span class="br0">&#41;</span>;
          <span class="kw1">IF</span> Z<span class="sy0">=</span><span class="nu0">6</span> <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
            <span class="kw3">WRITELN</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>DOING<span class="br0">&#40;</span>J<span class="br0">&#41;</span><span class="br0">&#41;</span>;
            Z<span class="sy0">:=</span><span class="nu0">0</span>;
            FF<span class="sy0">:=</span><span class="kw2">FALSE</span>;
          <span class="kw1">END</span>
          <span class="kw1">ELSE</span>
            <span class="kw1">IF</span> <span class="kw1">NOT</span><span class="br0">&#40;</span>FF<span class="br0">&#41;</span> <span class="kw1">THEN</span> <span class="kw1">BEGIN</span>
              <span class="kw3">WRITE</span><span class="br0">&#40;</span>DOING<span class="br0">&#40;</span>J<span class="br0">&#41;</span><span class="br0">&#41;</span>;
              FF<span class="sy0">:=</span><span class="kw2">TRUE</span>;
            <span class="kw1">END</span>
            <span class="kw1">ELSE</span>
              <span class="kw3">WRITE</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>DOING<span class="br0">&#40;</span>J<span class="br0">&#41;</span><span class="br0">&#41;</span>;
        <span class="kw1">END</span>;
      <span class="kw1">IF</span> Z&lt;&gt;<span class="nu0">0</span> <span class="kw1">THEN</span>
        <span class="kw3">WRITELN</span>;
      <span class="kw1">IF</span> T<span class="sy0">=</span>N <span class="kw1">THEN</span>
        <span class="kw1">BREAK</span>;
    <span class="kw1">END</span>;
<span class="kw1">END</span>;
&#160;
<span class="kw1">BEGIN</span>
  ASSIGN<span class="br0">&#40;</span>OUTPUT<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  REWRITE<span class="br0">&#40;</span>OUTPUT<span class="br0">&#41;</span>;
  INIT;
  MAIN;
  CLOSE<span class="br0">&#40;</span>OUTPUT<span class="br0">&#41;</span>;
<span class="kw1">END</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">  <span class="co1">//{$I-,OBJECTCHECKS-,Q-,R-,S-}</span>
&#160;
<span class="coMULTI">{
TASK: contact
LANG: PASCAL
ID: awesome5
}</span>
<span class="co1">//usaco Contact 3.1</span>
<span class="co1">//for tripley</span>
<span class="co1">//by phoeagon</span>
<span class="co1">//12-8</span>
<span class="kw1">const</span>
  upb<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="nu0">12</span><span class="sy0">-</span><span class="nu0">1</span>;
  <span class="kw1">var</span>
    f<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="me1">upb</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
	ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="sy0">-</span><span class="nu0">1</span>..<span class="me1">upb</span><span class="sy0">*</span><span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
	g<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="sy0">-</span><span class="nu0">1</span>..<span class="me1">upb</span><span class="sy0">*</span><span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
	a<span class="sy0">,</span>b<span class="sy0">,</span>ct<span class="sy0">,</span>n<span class="sy0">,</span>x<span class="sy0">,</span>n1<span class="sy0">:</span><span class="kw4">longint</span>;
	<span class="co1">//k:string;</span>
	<span class="coMULTI">{function conv(a:string):longint;
	  var	    i:longint;
	  begin val(a,conv,i);end;}</span>
	<span class="kw1">procedure</span> deal<span class="br0">&#40;</span>a1<span class="sy0">,</span>xx<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
	  <span class="kw1">var</span>
	    x<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>ax<span class="sy0">:</span><span class="kw4">longint</span>;
	  <span class="kw1">begin</span> <span class="co1">//j:=0;x:=1;ax:=b;</span>
          j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> xx <span class="sy0">-</span><span class="nu0">1</span>;ax<span class="sy0">:=</span>xx;
		  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> xx <span class="kw1">do</span>
		    <span class="kw1">begin</span>
			   x<span class="sy0">:=</span>a1 <span class="kw3">and</span> j;
			   inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>ax<span class="sy0">,</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
			   j<span class="sy0">:=</span>j <span class="kw1">shr</span> <span class="nu0">1</span>;
			   dec<span class="br0">&#40;</span>ax<span class="br0">&#41;</span>;
			<span class="kw1">end</span>;
	  <span class="kw1">end</span>;
	<span class="kw1">procedure</span> work;
	  <span class="kw1">var</span>
	    s<span class="sy0">:</span><span class="kw4">char</span>;
		i<span class="sy0">,</span>sta<span class="sy0">,</span>xx<span class="sy0">:</span><span class="kw4">longint</span>;<span class="co1">//u:string;</span>
		u<span class="sy0">:</span><span class="kw4">longint</span>;
	  <span class="kw1">begin</span> s<span class="sy0">:=</span>#<span class="nu0">0</span>;u<span class="sy0">:=</span><span class="nu0">0</span>;sta<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> b<span class="sy0">-</span><span class="nu0">1</span>;xx<span class="sy0">:=</span><span class="nu0">0</span>;
	         <span class="kw1">while</span> <span class="coMULTI">{s&lt;&gt;'.'}</span><span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>  <span class="coMULTI">{千万不能seekeof，否则TLE没商量}</span>
			   <span class="kw1">begin</span>
			       <span class="kw3">read</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
				   <span class="kw1">if</span> <span class="br0">&#40;</span>s<span class="sy0">=</span><span class="st_h">'1'</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>s<span class="sy0">=</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="kw1">then</span>
				     <span class="kw1">begin</span> inc<span class="br0">&#40;</span>xx<span class="br0">&#41;</span>;
					   <span class="co1">//if length(u)&lt;b then</span>
					     <span class="coMULTI">{u:=u+s
						 else u:=copy(u,2,length(u)-1)+s;}</span>
						<span class="kw1">if</span> xx&gt;b <span class="kw1">then</span> xx<span class="sy0">:=</span>b;
						 u<span class="sy0">:=</span><span class="br0">&#40;</span>u <span class="kw1">shl</span> <span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw3">and</span> sta <span class="kw1">or</span> <span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span><span class="br0">&#41;</span>;
                                         <span class="co1">//  writeln(u);</span>
                                           <span class="coMULTI">{if length(u)&gt;=a then}</span> deal<span class="br0">&#40;</span>u<span class="sy0">,</span>xx<span class="br0">&#41;</span>;
					 <span class="kw1">end</span>;
			   <span class="kw1">end</span>;
	  <span class="kw1">end</span>;
        <span class="kw1">procedure</span> pr<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
          <span class="co1">//var k:string;</span>
		  <span class="kw1">var</span> x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span>;
          <span class="kw1">begin</span>
            <span class="coMULTI">{  k:='';
              while i&lt;&gt;0 do
                begin
                    if i and 1=1 then k:='1'+k
                    else k:='0'+k;
                    i:=i shr 1;
                end;
              while length(k)&lt;j do k:='0'+k;
              write(k);}</span>
			  x<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span>;
			  <span class="kw1">while</span> x&lt;&gt;<span class="nu0">0</span> <span class="kw1">do</span>
			     <span class="kw1">begin</span>
				    <span class="co1">//write(i and x);</span>
                                    <span class="kw1">if</span> i <span class="kw3">and</span> x<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span>;
                                    x<span class="sy0">:=</span>x <span class="kw1">shr</span> <span class="nu0">1</span>;
				 <span class="kw1">end</span>;
          <span class="kw1">end</span>;
	<span class="kw1">procedure</span> calc;
	  <span class="kw1">var</span>
	    i<span class="sy0">,</span>j<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span>;<span class="co1">//done:boolean;</span>
	  <span class="kw1">begin</span> x<span class="sy0">:=</span><span class="nu0">0</span>;y<span class="sy0">:=</span><span class="nu0">1</span>;<span class="co1">//done:=false;</span>
&#160;
        <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
		  <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> i<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
		    <span class="kw1">begin</span>
			  <span class="co1">//if done then break;</span>
			  <span class="kw1">if</span> f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>&gt;<span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
			    <span class="co1">//if ct&lt;n then</span>
				  <span class="kw1">begin</span>
				      inc<span class="br0">&#40;</span>ct<span class="br0">&#41;</span>;ans<span class="br0">&#91;</span>ct<span class="br0">&#93;</span><span class="sy0">:=</span>j;g<span class="br0">&#91;</span>ct<span class="br0">&#93;</span><span class="sy0">:=</span>i;
				  <span class="kw1">end</span>
				  <span class="co1">//else begin done:=true;break;end;</span>
			<span class="kw1">end</span>;
		   <span class="kw1">end</span>;
        <span class="kw1">function</span> bigger<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
        <span class="kw1">var</span> f1<span class="sy0">,</span>f2<span class="sy0">:</span><span class="kw4">longint</span>;
          <span class="kw1">begin</span>
          f1<span class="sy0">:=</span>f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;f2<span class="sy0">:=</span>f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#93;</span>;
              <span class="kw1">if</span> f1&gt;f2 <span class="kw1">then</span>
                exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>
                 <span class="kw1">else</span>
		<span class="kw1">begin</span>
                  <span class="co1">//if i=0 then i:=-1 else if j=0 then j:=-1;</span>
                  <span class="kw1">if</span> f1<span class="sy0">=</span>f2 <span class="kw1">then</span>
                  <span class="kw1">if</span> g<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;g<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>
                  <span class="kw1">else</span> <span class="kw1">if</span> g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span>g<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="kw1">then</span>
                    <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
                    exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
	<span class="kw1">procedure</span> qs<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
	  <span class="kw1">var</span>
	    i<span class="sy0">,</span>j<span class="sy0">,</span>x<span class="sy0">,</span>y<span class="sy0">,</span>a1<span class="sy0">,</span>a2<span class="sy0">:</span><span class="kw4">longint</span>;
	  <span class="kw1">begin</span> a1<span class="sy0">:=</span>maxint;a2<span class="sy0">:=</span><span class="nu0">0</span>;
                   <span class="kw1">for</span> i<span class="sy0">:=</span>l <span class="kw1">to</span> ct <span class="kw1">do</span>
                     <span class="kw1">begin</span>
                            x<span class="sy0">:=</span>i;
                            <span class="co1">//f[0,0]:=f[g[i],ans[i]];</span>
                            <span class="kw1">for</span> j<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> ct <span class="kw1">do</span>
                              <span class="kw1">if</span> bigger<span class="br0">&#40;</span>j<span class="sy0">,</span>x<span class="br0">&#41;</span> <span class="kw1">then</span>
                                x<span class="sy0">:=</span>j;
                            y<span class="sy0">:=</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>g<span class="br0">&#91;</span>x<span class="br0">&#93;</span>;g<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span>y;
                            y<span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>x<span class="br0">&#93;</span>;ans<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span>y;
							<span class="kw1">if</span> f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>&lt;&gt;a1 <span class="kw1">then</span>
							  <span class="kw1">begin</span>
							       inc<span class="br0">&#40;</span>a2<span class="br0">&#41;</span>;
								   <span class="kw1">if</span> a2&gt;n <span class="kw1">then</span> <span class="kw1">begin</span>
                                                                   <span class="co1">//writeln(i);</span>
                                                                   exit;<span class="kw1">end</span>;
								   a1<span class="sy0">:=</span>f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
							  <span class="kw1">end</span>;
                     <span class="kw1">end</span>;
                     <span class="coMULTI">{for i:=l to r do write(f[g[i],ans[i]]:3);writeln;
                     for i:=l to r do write(g[i]:3);writeln;
                     for i:=l to r do write(ans[i]:3);writeln; }</span>
                    <span class="co1">// writeln(l,' ',r);</span>
      <span class="coMULTI">{            i:=random(r-l)+(l+R)div 2;
                  f[0,0]:=f[g[i],ans[i]];g[-1]:=g[i];ans[-1]:=ans[i];
                  i:=l;j:=r;
                  repeat
                          while bigger(i,0)do inc(i);
                          while bigger(0,j)do deC(j);
                          if not(i&gt;j)then
                            begin
                                y:=g[i];g[i]:=g[j];g[j]:=y;
                                y:=ans[i];ans[i]:=ans[j];
                                ans[j]:=y;
                                inc(i);
                                dec(j);
                            end;
                  until i&gt;=j;
                  if i&lt;r then qs(i,r);
                   if l&lt;j then qs(l,j);}</span>
	  <span class="kw1">end</span>;
	  <span class="kw1">procedure</span> prn;
	   <span class="kw1">var</span>
	     i<span class="sy0">,</span>j<span class="sy0">,</span>n1<span class="sy0">:</span><span class="kw4">longint</span>;ch<span class="sy0">:</span><span class="kw4">boolean</span>;
	   <span class="kw1">begin</span>
           j<span class="sy0">:=</span>maxint;x<span class="sy0">:=</span><span class="nu0">0</span>; <span class="co1">//ch:=false;</span>
	      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> ct <span class="kw1">do</span>
		    <span class="kw1">begin</span>
                         <span class="kw1">if</span> j&lt;&gt;f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="kw1">then</span>
                             <span class="kw1">begin</span>
							    inc<span class="br0">&#40;</span>x<span class="br0">&#41;</span>;
								<span class="kw1">if</span> x&gt;n <span class="kw1">then</span> <span class="kw1">begin</span> <span class="kw3">writeln</span>;exit;<span class="kw1">end</span>;
							    <span class="kw1">if</span> x&lt;&gt;<span class="nu0">1</span> <span class="kw1">then</span>
                                                              <span class="kw3">writeln</span>;
                                                              <span class="kw3">writeln</span><span class="br0">&#40;</span>f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
								j<span class="sy0">:=</span>f<span class="br0">&#91;</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span>;
								<span class="coMULTI">{writeln;	}</span>n1<span class="sy0">:=</span><span class="nu0">0</span>;
                             <span class="kw1">end</span>;
							 inc<span class="br0">&#40;</span>n1<span class="br0">&#41;</span>;
							 <span class="kw1">if</span> n1 <span class="kw1">mod</span> <span class="nu0">7</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
							   <span class="kw1">begin</span> n1<span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw3">writeln</span>;<span class="kw1">end</span>
							 <span class="kw1">else</span> <span class="kw1">if</span> <span class="coMULTI">{n1 mod 6&lt;&gt;1}</span>
                                                         n1&lt;&gt;<span class="nu0">1</span> <span class="kw1">then</span>
                                                            <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
							 pr<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>g<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
&#160;
			<span class="kw1">end</span>;
                           <span class="kw3">writeln</span>;
                        <span class="coMULTI">{if not ch then}</span> <span class="co1">//writeln;</span>
	   <span class="kw1">end</span>;
	  <span class="kw1">begin</span>
     assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
   assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
		 <span class="co1">//randomize;</span>
		 <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
		 work;
		 calc;
                 <span class="co1">//writeln(bigger(1,1));</span>
		 qs<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>ct<span class="br0">&#41;</span>;
		 prn;
                 <span class="co1">//if n=1 then writeln;</span>
		 close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
	  <span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=8" title="编辑段落：代码5">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.815">代码5</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{ID:ak.liut1
PROB:contact
LANG:PASCAL
}</span>
<span class="kw1">type</span>
   node	<span class="sy0">=</span> ^rec;
   rec	<span class="sy0">=</span> <span class="kw4">record</span>
	     l<span class="sy0">,</span>r  <span class="sy0">:</span> node;
	     data <span class="sy0">:</span> <span class="kw4">longint</span>;
	  <span class="kw1">end</span>;	  
   rec1	<span class="sy0">=</span> <span class="kw4">record</span>
	     s	<span class="sy0">:</span> <span class="kw4">string</span>;
	     ra	<span class="sy0">:</span> <span class="kw4">longint</span>;	
	  <span class="kw1">end</span>;	
<span class="kw1">var</span>	
   p1<span class="sy0">,</span>h1<span class="sy0">,</span>h2<span class="sy0">,</span>e		<span class="sy0">:</span> node;
   c			<span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">8192</span><span class="br0">&#93;</span><span class="kw1">of</span> rec1;
   t			<span class="sy0">:</span> <span class="kw4">string</span>;
   s			<span class="sy0">:</span> <span class="kw4">ansistring</span>;
   k<span class="sy0">,</span>l<span class="sy0">,</span>u<span class="sy0">,</span>a<span class="sy0">,</span>n<span class="sy0">,</span>b<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>fuck	<span class="sy0">:</span> <span class="kw4">longint</span>;
<span class="kw1">procedure</span> f<span class="br0">&#40;</span>o		<span class="sy0">:</span> node;deep<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">begin</span>
   <span class="kw1">if</span> <span class="br0">&#40;</span>o^.<span class="me1">data</span>&lt;&gt;<span class="nu0">0</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>deep&gt;<span class="sy0">=</span>a<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>deep&lt;<span class="sy0">=</span>b<span class="br0">&#41;</span> <span class="kw1">then</span>
   <span class="kw1">begin</span>
      i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
      c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span>t;
      c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span><span class="sy0">:=</span>o^.<span class="me1">data</span>;
   <span class="kw1">end</span>;
   <span class="kw1">if</span> o^.<span class="me1">l</span>&lt;&gt;<span class="kw2">nil</span> <span class="kw1">then</span>
   <span class="kw1">begin</span>
      t<span class="sy0">:=</span>t<span class="sy0">+</span><span class="st_h">'0'</span>;
      f<span class="br0">&#40;</span>o^.<span class="me1">l</span><span class="sy0">,</span>deep<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
      delete<span class="br0">&#40;</span>t<span class="sy0">,</span>length<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
   <span class="kw1">end</span>;
   <span class="kw1">if</span> o^.<span class="me1">r</span>&lt;&gt;<span class="kw2">nil</span> <span class="kw1">then</span>
   <span class="kw1">begin</span>
      t<span class="sy0">:=</span>t<span class="sy0">+</span><span class="st_h">'1'</span>;
      f<span class="br0">&#40;</span>o^.<span class="me1">r</span><span class="sy0">,</span>deep<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span>;
      delete<span class="br0">&#40;</span>t<span class="sy0">,</span>length<span class="br0">&#40;</span>t<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
   <span class="kw1">end</span>;
<span class="kw1">end</span>;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
   i<span class="sy0">,</span>j <span class="sy0">:</span> <span class="kw4">longint</span>;
   t<span class="sy0">,</span>x <span class="sy0">:</span> rec1;
<span class="kw1">begin</span>  
   i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;x<span class="sy0">:=</span>c<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
   <span class="kw1">repeat</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&gt;x.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">do</span> i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>x.<span class="me1">ra</span>&gt;c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">do</span> j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
      <span class="kw1">begin</span>
	 t<span class="sy0">:=</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
	 c<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
	 c<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>t;
	 i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
	 j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">end</span>;
   <span class="kw1">until</span> i&gt;j;
   <span class="kw1">if</span> l&lt;j <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
   <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">function</span> bj<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">var</span>
   i <span class="sy0">:</span> <span class="kw4">longint</span>;
<span class="kw1">begin</span>
   <span class="kw1">while</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>b<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> a<span class="sy0">:=</span><span class="st_h">'0'</span><span class="sy0">+</span>a;
   <span class="kw1">while</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>b<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>a<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> b<span class="sy0">:=</span><span class="st_h">'0'</span><span class="sy0">+</span>b;
   <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span> <span class="kw1">do</span>
      <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span>
	 exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>
      <span class="kw1">else</span>
	 <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
   exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">procedure</span> qsort1<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
   i<span class="sy0">,</span>j <span class="sy0">:</span> <span class="kw4">longint</span>;
   t<span class="sy0">,</span>x <span class="sy0">:</span> rec1;
<span class="kw1">begin</span>  
   i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;x<span class="sy0">:=</span>c<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
   <span class="kw1">repeat</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
	 i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
	 j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
      <span class="kw1">begin</span>
	 t<span class="sy0">:=</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
	 c<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
	 c<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>t;
	 i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
	 j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">end</span>;
   <span class="kw1">until</span> i&gt;j;
   <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort1<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
   <span class="kw1">if</span> l&lt;j <span class="kw1">then</span> qsort1<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">procedure</span> qsort2<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
   i<span class="sy0">,</span>j <span class="sy0">:</span> <span class="kw4">longint</span>;
   t<span class="sy0">,</span>x <span class="sy0">:</span> rec1;
<span class="kw1">begin</span>  
   i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;x<span class="sy0">:=</span>c<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
   <span class="kw1">repeat</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>bj<span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">,</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>bj<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="sy0">,</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
    <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
    <span class="kw1">begin</span>
       t<span class="sy0">:=</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
       c<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
       c<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>t;
       i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
       j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
    <span class="kw1">end</span>;
   <span class="kw1">until</span> i&gt;j;
   <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort2<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
   <span class="kw1">if</span> l&lt;j <span class="kw1">then</span> qsort2<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">begin</span>
   assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
   reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
   <span class="kw3">readln</span><span class="br0">&#40;</span>input<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
   <span class="kw1">repeat</span>
      <span class="kw3">readln</span><span class="br0">&#40;</span>input<span class="sy0">,</span>t<span class="br0">&#41;</span>;
      s<span class="sy0">:=</span>s<span class="sy0">+</span>t;
   <span class="kw1">until</span> <span class="kw3">eof</span>;
   close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
   <span class="kw3">new</span><span class="br0">&#40;</span>h1<span class="br0">&#41;</span>;<span class="kw3">new</span><span class="br0">&#40;</span>h2<span class="br0">&#41;</span>;
   h1^.<span class="me1">data</span><span class="sy0">:=</span><span class="nu0">0</span>;h2^.<span class="me1">data</span><span class="sy0">:=</span><span class="nu0">0</span>;h1^.<span class="me1">l</span><span class="sy0">:=</span><span class="kw2">nil</span>;h1^.<span class="me1">r</span><span class="sy0">:=</span><span class="kw2">nil</span>;h2^.<span class="me1">l</span><span class="sy0">:=</span><span class="kw2">nil</span>;h2^.<span class="me1">r</span><span class="sy0">:=</span><span class="kw2">nil</span>;
   <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span>
   <span class="kw1">begin</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span>i <span class="kw1">to</span> b<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
	 <span class="kw1">if</span> j&gt;length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
	 <span class="kw1">if</span> j<span class="sy0">=</span>i <span class="kw1">then</span>
	 <span class="kw1">begin</span>
	    <span class="kw1">if</span> s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'0'</span> <span class="kw1">then</span>
	    <span class="kw1">begin</span>
	       inc<span class="br0">&#40;</span>h1^.<span class="me1">data</span><span class="br0">&#41;</span>;
	       p1<span class="sy0">:=</span>h1;
	    <span class="kw1">end</span>
	    <span class="kw1">else</span>
	    <span class="kw1">begin</span>
	       inc<span class="br0">&#40;</span>h2^.<span class="me1">data</span><span class="br0">&#41;</span>;
	       p1<span class="sy0">:=</span>h2;
	    <span class="kw1">end</span>;
	 <span class="kw1">end</span>
	 <span class="kw1">else</span>
	    <span class="kw1">if</span> s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'0'</span> <span class="kw1">then</span>
	    <span class="kw1">begin</span>
	       <span class="kw1">if</span> p1^.<span class="me1">l</span><span class="sy0">=</span><span class="kw2">nil</span> <span class="kw1">then</span>
	       <span class="kw1">begin</span>
		  <span class="kw3">new</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
		  p1^.<span class="me1">l</span><span class="sy0">:=</span>e;
		  p1<span class="sy0">:=</span>e;
		  p1^.<span class="me1">data</span><span class="sy0">:=</span><span class="nu0">1</span>;
		  p1^.<span class="me1">l</span><span class="sy0">:=</span><span class="kw2">nil</span>;p1^.<span class="me1">r</span><span class="sy0">:=</span><span class="kw2">nil</span>;
	       <span class="kw1">end</span>
	       <span class="kw1">else</span>
	       <span class="kw1">begin</span>
		  p1<span class="sy0">:=</span>p1^.<span class="me1">l</span>;
		  inc<span class="br0">&#40;</span>p1^.<span class="me1">data</span><span class="br0">&#41;</span>;
	       <span class="kw1">end</span>;
	    <span class="kw1">end</span>
	    <span class="kw1">else</span>
	    <span class="kw1">begin</span>
	       <span class="kw1">if</span> p1^.<span class="me1">r</span><span class="sy0">=</span><span class="kw2">nil</span> <span class="kw1">then</span>
	       <span class="kw1">begin</span>
		  <span class="kw3">new</span><span class="br0">&#40;</span>e<span class="br0">&#41;</span>;
		  p1^.<span class="me1">r</span><span class="sy0">:=</span>e;
		  p1<span class="sy0">:=</span>e;
		  p1^.<span class="me1">data</span><span class="sy0">:=</span><span class="nu0">1</span>;
		  p1^.<span class="me1">l</span><span class="sy0">:=</span><span class="kw2">nil</span>;p1^.<span class="me1">r</span><span class="sy0">:=</span><span class="kw2">nil</span>;
	       <span class="kw1">end</span>
	       <span class="kw1">else</span>
	       <span class="kw1">begin</span>
		  p1<span class="sy0">:=</span>p1^.<span class="me1">r</span>;
		  inc<span class="br0">&#40;</span>p1^.<span class="me1">data</span><span class="br0">&#41;</span>;
	       <span class="kw1">end</span>;
	    <span class="kw1">end</span>;
      <span class="kw1">end</span>;
   <span class="kw1">end</span>;
   p1<span class="sy0">:=</span>h1;
   i<span class="sy0">:=</span><span class="nu0">0</span>;t<span class="sy0">:=</span><span class="st_h">'0'</span>;
   f<span class="br0">&#40;</span>p1<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
   t<span class="sy0">:=</span><span class="st_h">'1'</span>;
   p1<span class="sy0">:=</span>h2;
   f<span class="br0">&#40;</span>p1<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
   qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>i<span class="br0">&#41;</span>;
   u<span class="sy0">:=</span>i;
   i<span class="sy0">:=</span><span class="nu0">0</span>;j<span class="sy0">:=</span><span class="nu0">0</span>;
   <span class="kw1">repeat</span>
      i<span class="sy0">:=</span>j<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">if</span> i&gt;u <span class="kw1">then</span> <span class="kw1">break</span>;
      j<span class="sy0">:=</span>i;
      <span class="kw1">repeat</span>
	 j<span class="sy0">:=</span>j<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">until</span> <span class="br0">&#40;</span>j<span class="sy0">=</span>u<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">then</span> j<span class="sy0">:=</span>j<span class="sy0">-</span><span class="nu0">1</span>;
      <span class="kw1">if</span> i&lt;j <span class="kw1">then</span>
      <span class="kw1">begin</span>
	 qsort1<span class="br0">&#40;</span>i<span class="sy0">,</span>j<span class="br0">&#41;</span>;
	 k<span class="sy0">:=</span>i;
	 l<span class="sy0">:=</span>i;
	 <span class="kw1">repeat</span>
	    l<span class="sy0">:=</span>k;
	    <span class="kw1">while</span> <span class="br0">&#40;</span>l&lt;j<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>length<span class="br0">&#40;</span>c<span class="br0">&#91;</span>l<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="sy0">=</span>length<span class="br0">&#40;</span>c<span class="br0">&#91;</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> l<span class="sy0">:=</span>l<span class="sy0">+</span><span class="nu0">1</span>;
	    <span class="kw1">if</span> k&lt;l <span class="kw1">then</span> qsort2<span class="br0">&#40;</span>k<span class="sy0">,</span>l<span class="br0">&#41;</span>;
	    k<span class="sy0">:=</span>l<span class="sy0">+</span><span class="nu0">1</span>;
	 <span class="kw1">until</span> k&gt;<span class="sy0">=</span>j;
      <span class="kw1">end</span>;
   <span class="kw1">until</span> i<span class="sy0">=</span>u<span class="sy0">-</span><span class="nu0">1</span>;
   <span class="kw1">if</span> n&gt;u <span class="kw1">then</span> n<span class="sy0">:=</span>u;
   j<span class="sy0">:=</span><span class="nu0">0</span>;
   assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
   rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
   <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> u <span class="kw1">do</span>
   <span class="kw1">begin</span>
      <span class="kw1">if</span> <span class="br0">&#40;</span>i<span class="sy0">=</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">then</span>
	 <span class="kw3">writeln</span><span class="br0">&#40;</span>output<span class="sy0">,</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span>;
      <span class="kw3">write</span><span class="br0">&#40;</span>output<span class="sy0">,</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>j <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>i<span class="sy0">=</span>u<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">then</span>
	 <span class="kw3">writeln</span><span class="br0">&#40;</span>output<span class="br0">&#41;</span>
      <span class="kw1">else</span>
	 <span class="kw3">write</span><span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>i&lt;u<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">ra</span><span class="br0">&#41;</span> <span class="kw1">then</span> j<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">if</span> c<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">ra</span>&lt;&gt;c<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">ra</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>fuck<span class="br0">&#41;</span>;
      <span class="kw1">if</span> fuck<span class="sy0">=</span>n <span class="kw1">then</span> <span class="kw1">break</span>;
   <span class="kw1">end</span>;
   close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>9999
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=9" title="编辑段落：代码6(二进制)">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.816.28.E4.BA.8C.E8.BF.9B.E5.88.B6.29">代码6(二进制)</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
PROB:contact
LANG:PASCAL
}</span>
<span class="kw1">type</span>
  _ans<span class="sy0">=</span><span class="kw4">record</span>
        x<span class="sy0">:</span><span class="kw4">longint</span>;
        s<span class="sy0">:</span><span class="kw4">string</span>;
       <span class="kw1">end</span>;
<span class="kw1">var</span>
  tot<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>m<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>g<span class="sy0">,</span>last<span class="sy0">,</span>p<span class="sy0">:</span><span class="kw4">longint</span>;
  st<span class="sy0">:</span><span class="kw4">ansistring</span>;
  ch<span class="sy0">:</span><span class="kw4">char</span>;
  x<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
  f<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">10000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;<span class="co1">//Length=i Num=j</span>
  t<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">integer</span>;
  ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">50000</span><span class="br0">&#93;</span><span class="kw1">of</span> _ans;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;x<span class="sy0">:</span>_ans;
<span class="kw1">begin</span>
  i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;x<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span>&gt;x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw1">or</span>
      <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span><span class="sy0">=</span>x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>length<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span>
      <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span><span class="sy0">=</span>x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>length<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="sy0">=</span>length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span>&lt;x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">x</span>&lt;x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw1">or</span>
      <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">x</span><span class="sy0">=</span>x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>length<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span>
      <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">x</span><span class="sy0">=</span>x.<span class="me1">x</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>length<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="sy0">=</span>length<span class="br0">&#40;</span>x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span>&gt;x.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span>
    <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
      <span class="kw1">begin</span>
        ans<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>;
        inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
  <span class="kw1">until</span> i&gt;<span class="sy0">=</span>j;
  <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
  <span class="kw1">if</span> j&gt;l <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  st<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
    t<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span>;
  <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
  l<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">if</span> ch <span class="kw1">in</span> <span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
        <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
          <span class="kw1">begin</span>
            x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw3">and</span> t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">*</span><span class="nu0">2</span><span class="sy0">+</span><span class="kw3">ord</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> l&gt;<span class="sy0">=</span>i <span class="kw1">then</span> inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>x<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    <span class="kw3">read</span><span class="br0">&#40;</span>ch<span class="br0">&#41;</span>;
  <span class="kw1">until</span> <span class="kw3">eof</span>;
  tot<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> i<span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
          <span class="kw1">if</span> f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
              inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
              ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span><span class="st_h">''</span>;
              ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">x</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
              g<span class="sy0">:=</span>j;<span class="co1">//Change</span>
              <span class="kw1">for</span> k<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> i <span class="kw1">do</span>
                <span class="kw1">begin</span>
                  <span class="kw1">if</span> <span class="br0">&#40;</span>g <span class="kw3">and</span> <span class="nu0">1</span><span class="br0">&#41;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
                    ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span><span class="st_h">'1'</span><span class="sy0">+</span>ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">s</span>
                  <span class="kw1">else</span>
                    ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span><span class="st_h">'0'</span><span class="sy0">+</span>ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span>.<span class="me1">s</span>;
                  g<span class="sy0">:=</span>g <span class="kw1">shr</span> <span class="nu0">1</span>;
                <span class="kw1">end</span>;
            <span class="kw1">end</span>;
        <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>tot<span class="br0">&#41;</span>;
  i<span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span>&lt;&gt;last <span class="kw1">then</span>
      <span class="kw1">begin</span>
         dec<span class="br0">&#40;</span>n<span class="br0">&#41;</span>;
         <span class="kw1">if</span> n&gt;<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
          <span class="kw1">begin</span>
            <span class="kw1">if</span> i&gt;<span class="nu0">1</span> <span class="kw1">then</span> <span class="kw3">writeln</span>;
            <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span><span class="br0">&#41;</span>;
            <span class="kw3">write</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>;
            last<span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">x</span>;
            p<span class="sy0">:=</span><span class="nu0">1</span>;
          <span class="kw1">end</span>;
      <span class="kw1">end</span>
    <span class="kw1">else</span>
      <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>p<span class="br0">&#41;</span>;
        <span class="kw1">if</span> p <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">1</span> <span class="kw1">then</span>
          <span class="kw1">begin</span>
            <span class="kw3">writeln</span>;
            <span class="kw3">write</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>
          <span class="kw1">end</span>
        <span class="kw1">else</span>
          <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
  <span class="kw1">until</span> <span class="br0">&#40;</span>n&lt;<span class="nu0">0</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>i&gt;tot<span class="br0">&#41;</span>;
  <span class="kw3">writeln</span>;close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=10" title="编辑段落：代码7（用空间换时间）">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.817.EF.BC.88.E7.94.A8.E7.A9.BA.E9.97.B4.E6.8D.A2.E6.97.B6.E9.97.B4.EF.BC.89">代码7（用空间换时间）</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">15076</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">15044</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.043</span> secs<span class="sy0">,</span> <span class="nu0">15140</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">15108</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.108</span> secs<span class="sy0">,</span> <span class="nu0">15108</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.194</span> secs<span class="sy0">,</span> <span class="nu0">15108</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.162</span> secs<span class="sy0">,</span> <span class="nu0">15108</span> KB<span class="br0">&#93;</span>
<span class="kw1">program</span> cyd;
  <span class="kw1">const</span>
    mm<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">integer</span><span class="sy0">=</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">8</span><span class="sy0">,</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">32</span><span class="sy0">,</span><span class="nu0">64</span><span class="sy0">,</span><span class="nu0">128</span><span class="sy0">,</span><span class="nu0">256</span><span class="sy0">,</span><span class="nu0">512</span><span class="sy0">,</span><span class="nu0">1024</span><span class="sy0">,</span><span class="nu0">2048</span><span class="br0">&#41;</span>;
    ch<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">integer</span><span class="sy0">=</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">4</span><span class="sy0">,</span><span class="nu0">8</span><span class="sy0">,</span><span class="nu0">16</span><span class="sy0">,</span><span class="nu0">32</span><span class="sy0">,</span><span class="nu0">64</span><span class="sy0">,</span><span class="nu0">128</span><span class="sy0">,</span><span class="nu0">256</span><span class="sy0">,</span><span class="nu0">512</span><span class="sy0">,</span><span class="nu0">1024</span><span class="sy0">,</span><span class="nu0">2048</span><span class="sy0">,</span><span class="nu0">4096</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span>
    f<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">4096</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">string</span>; z<span class="sy0">:</span><span class="kw4">char</span>;
    g<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">4096</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
    ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">9000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">string</span>;
    len<span class="sy0">,</span>ci<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">9000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span>;
    i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>l<span class="sy0">,</span>m<span class="sy0">,</span>n<span class="sy0">,</span>a<span class="sy0">,</span>b<span class="sy0">,</span>c<span class="sy0">,</span>shu<span class="sy0">,</span>tot<span class="sy0">,</span>cha<span class="sy0">,</span>chang<span class="sy0">:</span><span class="kw4">longint</span>; s<span class="sy0">,</span>ss<span class="sy0">:</span><span class="kw4">ansistring</span>; p<span class="sy0">,</span>q<span class="sy0">:</span><span class="kw4">boolean</span>;
  <span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
    <span class="kw1">var</span>
      tl<span class="sy0">,</span>tr<span class="sy0">,</span>mid<span class="sy0">,</span>tmp<span class="sy0">,</span>mid2<span class="sy0">:</span><span class="kw4">longint</span>; tm<span class="sy0">:</span><span class="kw4">string</span>; mid3<span class="sy0">:</span><span class="kw4">string</span>;
    <span class="kw1">begin</span>
      tl<span class="sy0">:=</span>l; tr<span class="sy0">:=</span>r; mid<span class="sy0">:=</span>ci<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>; mid2<span class="sy0">:=</span>len<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
      mid3<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span><span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
      <span class="kw1">repeat</span>
        <span class="kw1">while</span> <span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>&gt;mid<span class="br0">&#41;</span><span class="kw1">or</span>
              <span class="br0">&#40;</span><span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">=</span>mid<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>&lt;mid2<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span>
              <span class="br0">&#40;</span><span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">=</span>mid<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">=</span>mid2<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>&lt;mid3<span class="br0">&#41;</span><span class="br0">&#41;</span>
              <span class="kw1">do</span> inc<span class="br0">&#40;</span>tl<span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>&lt;mid<span class="br0">&#41;</span><span class="kw1">or</span>
              <span class="br0">&#40;</span><span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">=</span>mid<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>&gt;mid2<span class="br0">&#41;</span><span class="br0">&#41;</span><span class="kw1">or</span>
              <span class="br0">&#40;</span><span class="br0">&#40;</span>ci<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">=</span>mid<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>len<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">=</span>mid2<span class="br0">&#41;</span><span class="kw3">and</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>&gt;mid3<span class="br0">&#41;</span><span class="br0">&#41;</span>
              <span class="kw1">do</span> dec<span class="br0">&#40;</span>tr<span class="br0">&#41;</span>;
        <span class="kw1">if</span> tl&lt;<span class="sy0">=</span>tr <span class="kw1">then</span> <span class="kw1">begin</span>
          tm<span class="sy0">:=</span>ans<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>; ans<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>; ans<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">:=</span>tm;
          tmp<span class="sy0">:=</span>ci<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>; ci<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">:=</span>ci<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>; ci<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">:=</span>tmp;
          tmp<span class="sy0">:=</span>len<span class="br0">&#91;</span>tl<span class="br0">&#93;</span>; len<span class="br0">&#91;</span>tl<span class="br0">&#93;</span><span class="sy0">:=</span>len<span class="br0">&#91;</span>tr<span class="br0">&#93;</span>; len<span class="br0">&#91;</span>tr<span class="br0">&#93;</span><span class="sy0">:=</span>tmp;
          inc<span class="br0">&#40;</span>tl<span class="br0">&#41;</span>; dec<span class="br0">&#40;</span>tr<span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
        <span class="kw1">until</span> tl&gt;tr;
      <span class="kw1">if</span> tl&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>tl<span class="sy0">,</span>r<span class="br0">&#41;</span>;
      <span class="kw1">if</span> tr&gt;l <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>tr<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>; reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>; rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
    <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
    f<span class="br0">&#91;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'0'</span>; f<span class="br0">&#91;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'1'</span>;
    l<span class="sy0">:=</span><span class="nu0">0</span>; s<span class="sy0">:=</span><span class="st_h">''</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
        inc<span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
        <span class="kw3">read</span><span class="br0">&#40;</span>z<span class="br0">&#41;</span>;
        <span class="kw1">if</span> z<span class="sy0">=</span><span class="st_h">'9'</span> <span class="kw1">then</span> <span class="kw1">break</span>;
        <span class="kw1">if</span> z&lt;&gt;#<span class="nu0">13</span> <span class="kw1">then</span> s<span class="sy0">:=</span>s<span class="sy0">+</span>z;
        <span class="kw1">if</span> l<span class="sy0">=</span><span class="nu0">80</span> <span class="kw1">then</span> <span class="kw1">begin</span> l<span class="sy0">:=</span><span class="nu0">0</span>; <span class="kw3">readln</span>; <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    cha<span class="sy0">:=</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
    <span class="kw1">if</span> b&gt;cha <span class="kw1">then</span> b<span class="sy0">:=</span>cha;
    chang<span class="sy0">:=</span>cha<span class="sy0">-</span>a<span class="sy0">+</span><span class="nu0">1</span>;
    <span class="kw1">if</span> a&lt;&gt;<span class="nu0">1</span> <span class="kw1">then</span> <span class="kw1">begin</span>
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> a <span class="kw1">do</span> f<span class="br0">&#91;</span>a<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>a<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">+</span><span class="st_h">'0'</span>;
      shu<span class="sy0">:=</span><span class="nu0">1</span>;
      ss<span class="sy0">:=</span>f<span class="br0">&#91;</span>a<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span>;
      <span class="kw1">repeat</span>
        i<span class="sy0">:=</span><span class="nu0">1</span>;
        <span class="kw1">while</span> ss<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">do</span> <span class="kw1">begin</span> ss<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'0'</span>; inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>; <span class="kw1">end</span>;
        ss<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'1'</span>;
        inc<span class="br0">&#40;</span>shu<span class="br0">&#41;</span>;
        f<span class="br0">&#91;</span>a<span class="sy0">,</span>shu<span class="br0">&#93;</span><span class="sy0">:=</span>ss;
      <span class="kw1">until</span> shu<span class="sy0">=</span>ch<span class="br0">&#91;</span>a<span class="br0">&#93;</span>;
    <span class="kw1">end</span>;
    <span class="kw1">for</span> j<span class="sy0">:=</span>a<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> b <span class="kw1">do</span>
      <span class="kw1">begin</span>
      shu<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> <span class="nu0">2</span> <span class="kw1">do</span>
        <span class="kw1">for</span> k<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> ch<span class="br0">&#91;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">do</span>
          <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>shu<span class="br0">&#41;</span>;
            f<span class="br0">&#91;</span>j<span class="sy0">,</span>shu<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span>k<span class="br0">&#93;</span><span class="sy0">+</span>f<span class="br0">&#91;</span><span class="nu0">1</span><span class="sy0">,</span>i<span class="br0">&#93;</span>;
          <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> chang <span class="kw1">do</span>
      <span class="kw1">begin</span>
        l<span class="sy0">:=</span><span class="nu0">0</span>; k<span class="sy0">:=</span><span class="nu0">0</span>;
        <span class="kw1">for</span> j<span class="sy0">:=</span>i <span class="kw1">to</span> i<span class="sy0">+</span>a<span class="sy0">-</span><span class="nu0">2</span> <span class="kw1">do</span>
          <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
            inc<span class="br0">&#40;</span>l<span class="sy0">,</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">*</span>mm<span class="br0">&#91;</span>k<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
        <span class="kw1">for</span> j<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
          <span class="kw1">begin</span>
            <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;cha <span class="kw1">then</span> <span class="kw1">break</span>;
            l<span class="sy0">:=</span>l<span class="sy0">+</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">*</span>mm<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
            inc<span class="br0">&#40;</span>g<span class="br0">&#91;</span>j<span class="sy0">,</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    tot<span class="sy0">:=</span><span class="nu0">0</span>; shu<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> ch<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>shu<span class="br0">&#41;</span>;
          ans<span class="br0">&#91;</span>shu<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
          len<span class="br0">&#91;</span>shu<span class="br0">&#93;</span><span class="sy0">:=</span>length<span class="br0">&#40;</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          ci<span class="br0">&#91;</span>shu<span class="br0">&#93;</span><span class="sy0">:=</span>g<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
        <span class="kw1">end</span>;
    qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>shu<span class="br0">&#41;</span>;
    l<span class="sy0">:=</span>ci<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw1">if</span> l<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">begin</span> close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>; halt; <span class="kw1">end</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>l<span class="br0">&#41;</span>;
        k<span class="sy0">:=</span><span class="nu0">0</span>;
        <span class="kw1">repeat</span>
          inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
          p<span class="sy0">:=</span><span class="kw2">true</span>;
          inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;
          <span class="kw3">write</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>tot<span class="br0">&#93;</span><span class="br0">&#41;</span>;
          <span class="kw1">if</span> tot&lt;&gt;shu <span class="kw1">then</span> <span class="kw1">begin</span>
          <span class="kw1">if</span> ci<span class="br0">&#91;</span>tot<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span>l <span class="kw1">then</span> <span class="kw1">begin</span> p<span class="sy0">:=</span><span class="kw2">false</span>; <span class="kw1">if</span> k&lt;&gt;<span class="nu0">6</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw1">begin</span> k<span class="sy0">:=</span><span class="nu0">0</span>; <span class="kw3">writeln</span>; <span class="kw1">end</span>; <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw1">begin</span>
            l<span class="sy0">:=</span>ci<span class="br0">&#91;</span>tot<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>; <span class="kw3">writeln</span>; <span class="kw1">end</span> <span class="kw1">end</span> <span class="kw1">else</span> <span class="kw3">writeln</span>;
          <span class="kw1">until</span> <span class="br0">&#40;</span>p<span class="sy0">=</span><span class="kw2">true</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>tot<span class="sy0">=</span>shu<span class="br0">&#41;</span>;
        <span class="kw1">if</span> tot<span class="sy0">=</span>shu <span class="kw1">then</span> <span class="kw1">break</span>;
      <span class="kw1">end</span>;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>; close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=11" title="编辑段落：代码8（为排序而写的）">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.818.EF.BC.88.E4.B8.BA.E6.8E.92.E5.BA.8F.E8.80.8C.E5.86.99.E7.9A.84.EF.BC.89">代码8（为排序而写的）</span></h2>
<p>因为主要依赖排序，所以这里用了效率最高的Hash表，同时能节省时间和空间。如果一边读入一边处理，那么空间复杂度还可以降下来。
</p><p>假如没有 sul 数组而直接对 rec 数组排序的话，Test 3 这个点会卡死快排和冒泡的（接近 0.9s）。
</p><p>注意写好Hash过程，保证输出的时候严格按照升序或降序。
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
Executing...
   Test 1: TEST OK [0.000 secs, 532 KB]
   Test 2: TEST OK [0.000 secs, 532 KB]
   Test 3: TEST OK [0.000 secs, 532 KB]
   Test 4: TEST OK [0.000 secs, 532 KB]
   Test 5: TEST OK [0.065 secs, 532 KB]
   Test 6: TEST OK [0.076 secs, 532 KB]
   Test 7: TEST OK [0.097 secs, 532 KB]
&#160;
All tests OK.
}</span>
<span class="coMULTI">{
ID:jiangan2
PROB:contact
LANG:PASCAL
}</span>
&#160;
<span class="kw1">program</span> contact;
&#160;
<span class="kw1">const</span>
  fn<span class="sy0">=</span><span class="st_h">'contact'</span>;
  bas<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">13</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">longint</span><span class="sy0">=</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="sy0">,</span><span class="nu0">2</span><span class="sy0">,</span><span class="nu0">6</span><span class="sy0">,</span><span class="nu0">14</span><span class="sy0">,</span><span class="nu0">30</span><span class="sy0">,</span><span class="nu0">62</span><span class="sy0">,</span><span class="nu0">126</span><span class="sy0">,</span><span class="nu0">254</span><span class="sy0">,</span><span class="nu0">510</span><span class="sy0">,</span>
                              <span class="nu0">1022</span><span class="sy0">,</span><span class="nu0">2046</span><span class="sy0">,</span><span class="nu0">4094</span><span class="sy0">,</span><span class="nu0">8190</span><span class="br0">&#41;</span>;
<span class="co1">//这里的 bas 数组是为 Hash 服务的，这样正好能保证 Hash表（rec 数组）的每一个元素都有用。</span>
&#160;
<span class="kw1">type</span>
  dat<span class="sy0">=</span><span class="kw4">record</span>
    code<span class="sy0">,</span>mou<span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">end</span>;<span class="co1">//code 是01串的Hash码，mou 是Hash码对应的01串的总数。</span>
&#160;
<span class="kw1">var</span>
  rec<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">8189</span><span class="br0">&#93;</span><span class="kw1">of</span> dat;
  sul<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">8190</span><span class="br0">&#93;</span><span class="kw1">of</span> dat;<span class="co1">//这里是记录 rec 数组中的 mou&gt;0 的元素，只有这里的元素才可能是有效的。</span>
  cont<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span><span class="kw1">of</span> <span class="kw4">char</span>;
  a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>le<span class="sy0">,</span>tps<span class="sy0">:</span><span class="kw4">longint</span>;
&#160;
<span class="kw1">procedure</span> swap<span class="br0">&#40;</span><span class="kw1">var</span> p<span class="sy0">,</span>q<span class="sy0">:</span>dat<span class="br0">&#41;</span>;
<span class="kw1">var</span> t<span class="sy0">:</span>dat;
<span class="kw1">begin</span>
  t<span class="sy0">:=</span>p;p<span class="sy0">:=</span>q;q<span class="sy0">:=</span>t;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> calh<span class="br0">&#40;</span>b<span class="sy0">,</span>l<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;<span class="co1">//这里没有用字符串，因为拼接字符串需要一定时间。</span>
<span class="co1">//这样的Hash过程，保证了输出的时候01串的顺序一定是升序。</span>
<span class="kw1">var</span>
  i<span class="sy0">,</span>d<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  d<span class="sy0">:=</span>bas<span class="br0">&#91;</span>l<span class="br0">&#93;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
    <span class="kw1">if</span> cont<span class="br0">&#91;</span>b<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span> inc<span class="br0">&#40;</span>d<span class="sy0">,</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>l<span class="sy0">-</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span>;<span class="co1">//用了位运算</span>
  inc<span class="br0">&#40;</span>rec<span class="br0">&#91;</span>d<span class="br0">&#93;</span>.<span class="me1">mou</span><span class="br0">&#41;</span>;<span class="co1">//没有用函数</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> unhash<span class="br0">&#40;</span>x<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;<span class="co1">//这里也没有用字符串</span>
<span class="kw1">var</span>
  i<span class="sy0">,</span>l<span class="sy0">,</span>d<span class="sy0">:</span><span class="kw4">longint</span>;
  s<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
<span class="kw1">begin</span>
  l<span class="sy0">:=</span>trunc<span class="br0">&#40;</span><span class="kw3">ln</span><span class="br0">&#40;</span>x<span class="sy0">+</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">/</span><span class="kw3">ln</span><span class="br0">&#40;</span><span class="nu0">2</span><span class="br0">&#41;</span><span class="sy0">+</span><span class="nu0">0.00001</span><span class="br0">&#41;</span>;
  d<span class="sy0">:=</span>x<span class="sy0">-</span>bas<span class="br0">&#91;</span>l<span class="br0">&#93;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
    <span class="kw1">if</span> <span class="kw3">odd</span><span class="br0">&#40;</span>d <span class="kw1">shr</span> <span class="br0">&#40;</span>l<span class="sy0">-</span>i<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">'1'</span><span class="br0">&#41;</span>
    <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span>;<span class="co1">//这里也有位运算</span>
<span class="kw1">end</span>;<span class="co1">//这里直接输出了。</span>
&#160;
<span class="kw1">procedure</span> init;
<span class="kw1">var</span>
  i<span class="sy0">:</span><span class="kw4">longint</span>;
  s<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#91;</span><span class="nu0">80</span><span class="br0">&#93;</span>;
<span class="kw1">begin</span>
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">8189</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      rec<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">:=</span>i;
      rec<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span><span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">end</span>;<span class="co1">//把每个 code 都初始化。</span>
  fillchar<span class="br0">&#40;</span>sul<span class="sy0">,</span>sizeof<span class="br0">&#40;</span>sul<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">0</span><span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  le<span class="sy0">:=</span><span class="nu0">0</span>;tps<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span><span class="co1">//假如一边读入一边处理，空间复杂度会下降很多，但时间复杂度会多一些。</span>
      <span class="kw3">readln</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
      <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span> cont<span class="br0">&#91;</span>le<span class="sy0">+</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
      inc<span class="br0">&#40;</span>le<span class="sy0">,</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;<span class="co1">//试过 SeekEof 不过出错过，这样读入保险一点。</span>
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;<span class="co1">//随机化快排，其实标准快排也可以，但最好取中点。</span>
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">,</span>x<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  i<span class="sy0">:=</span>l;j<span class="sy0">:=</span>r;x<span class="sy0">:=</span>sul<span class="br0">&#91;</span>random<span class="br0">&#40;</span>r<span class="sy0">-</span>l<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>;
  <span class="kw1">repeat</span>
    <span class="kw1">while</span> sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>&gt;x <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
    <span class="kw1">while</span> sul<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">mou</span>&lt;x <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
    <span class="kw1">begin</span>
      swap<span class="br0">&#40;</span>sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>sul<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
  <span class="kw1">until</span> i&gt;<span class="sy0">=</span>j;
  <span class="kw1">if</span> l&lt;j <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
  <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> main;
<span class="kw1">var</span>
  i<span class="sy0">,</span>j<span class="sy0">,</span>tot<span class="sy0">,</span>mh<span class="sy0">:</span><span class="kw4">longint</span>;
  m<span class="sy0">,</span>cd<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
  <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> le<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
      calh<span class="br0">&#40;</span>j<span class="sy0">,</span>i<span class="br0">&#41;</span>;<span class="co1">//Hash 过程</span>
  <span class="kw1">for</span> i<span class="sy0">:=</span>bas<span class="br0">&#91;</span>a<span class="br0">&#93;</span> <span class="kw1">to</span> bas<span class="br0">&#91;</span>b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span><span class="co1">//只有这一段的Hash值对应的01串是题目所求的。</span>
    <span class="kw1">if</span> rec<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      inc<span class="br0">&#40;</span>tps<span class="br0">&#41;</span>;
      sul<span class="br0">&#91;</span>tps<span class="br0">&#93;</span><span class="sy0">:=</span>rec<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;<span class="co1">//不这么做 Test 3 是很要命的。</span>
    <span class="kw1">end</span>;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>tps<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> tps<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span>
    <span class="kw1">for</span> j<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">to</span> tps <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw1">if</span> sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>&lt;&gt;sul<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">mou</span> <span class="kw1">then</span> <span class="kw1">break</span>;
        <span class="kw1">if</span> sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span>&gt;sul<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span> <span class="kw1">then</span> swap<span class="br0">&#40;</span>sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>sul<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>;<span class="co1">//快排不稳定，用冒泡修正一下。</span>
  tot<span class="sy0">:=</span><span class="nu0">0</span>;mh<span class="sy0">:=</span>maxlongint;m<span class="sy0">:=</span><span class="nu0">0</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> tps <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">if</span> sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>&lt;mh <span class="kw1">then</span>
    <span class="kw1">begin</span>
      mh<span class="sy0">:=</span>sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mou</span>;
      inc<span class="br0">&#40;</span>tot<span class="br0">&#41;</span>;m<span class="sy0">:=</span><span class="nu0">0</span>;
      <span class="kw1">if</span> <span class="br0">&#40;</span>tot&gt;n<span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>mh<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span> <span class="kw1">then</span> exit;
      <span class="kw3">writeln</span><span class="br0">&#40;</span>mh<span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    m<span class="sy0">:=</span><span class="br0">&#40;</span>m<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">mod</span> <span class="nu0">6</span>;
    unhash<span class="br0">&#40;</span>sul<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> <span class="br0">&#40;</span>m<span class="sy0">=</span><span class="nu0">0</span><span class="br0">&#41;</span><span class="kw1">or</span><span class="br0">&#40;</span>sul<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">mou</span>&lt;mh<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw3">writeln</span>
    <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;<span class="co1">//注意这里的输出。</span>
  <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span>fn<span class="sy0">+</span><span class="st_h">'.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span>fn<span class="sy0">+</span><span class="st_h">'.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  init;
  main;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=12" title="编辑段落：代码9">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.819">代码9</span></h2>
<p><b>130+的程序，空间消耗较大。</b>
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">USER<span class="sy0">:</span> Messi James <span class="br0">&#91;</span>usb__203<span class="br0">&#93;</span>
TASK<span class="sy0">:</span> contact
LANG<span class="sy0">:</span> PASCAL
&#160;
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">15264</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">15232</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.054</span> secs<span class="sy0">,</span> <span class="nu0">15328</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.032</span> secs<span class="sy0">,</span> <span class="nu0">15328</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.108</span> secs<span class="sy0">,</span> <span class="nu0">15328</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.292</span> secs<span class="sy0">,</span> <span class="nu0">15328</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.162</span> secs<span class="sy0">,</span> <span class="nu0">15328</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
&#160;
<span class="coMULTI">{
ID:usb__203
TASK:contact
LANG:PASCAL
}</span>
&#160;
<span class="kw1">type</span> node<span class="sy0">=</span><span class="kw4">record</span>
            code<span class="sy0">:</span><span class="kw4">string</span>;
            num<span class="sy0">,</span>time<span class="sy0">:</span><span class="kw4">integer</span>;
          <span class="kw1">end</span>;
&#160;
<span class="kw1">var</span> f<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">4095</span><span class="br0">&#93;</span> <span class="kw1">of</span> node;
    t<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10000</span><span class="br0">&#93;</span> <span class="kw1">of</span> node;
    a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>x<span class="sy0">:</span><span class="kw4">integer</span>;
    st<span class="sy0">:</span><span class="kw4">ansistring</span>;
&#160;
<span class="kw1">procedure</span> init;
  <span class="kw1">var</span> s<span class="sy0">:</span><span class="kw4">string</span>;
  <span class="kw1">begin</span>
    <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
    st<span class="sy0">:=</span><span class="st_h">''</span>;
    <span class="kw1">while</span> <span class="kw1">not</span><span class="br0">&#40;</span><span class="kw3">eof</span><span class="br0">&#41;</span> <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw3">readln</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
        st<span class="sy0">:=</span>st<span class="sy0">+</span>s;
      <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> change<span class="br0">&#40;</span>s<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
  <span class="kw1">var</span> i<span class="sy0">:</span><span class="kw4">integer</span>;
  <span class="kw1">begin</span>
    change<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>s<span class="br0">&#41;</span> <span class="kw1">do</span>
      change<span class="sy0">:=</span>change<span class="sy0">+</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="nu0">48</span><span class="br0">&#41;</span><span class="sy0">*</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">-</span>i<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> work;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">,</span>g<span class="sy0">:</span><span class="kw4">longint</span>;
      s<span class="sy0">:</span><span class="kw4">string</span>;
  <span class="kw1">begin</span>
    x<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>st<span class="br0">&#41;</span><span class="sy0">-</span>a<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
        <span class="kw1">begin</span>
          <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&gt;length<span class="br0">&#40;</span>st<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
          s<span class="sy0">:=</span>copy<span class="br0">&#40;</span>st<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="br0">&#41;</span>;
          g<span class="sy0">:=</span>change<span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
          f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">:=</span>s;
          <span class="kw1">if</span> f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
            <span class="kw1">begin</span>
              x<span class="sy0">:=</span>x<span class="sy0">+</span><span class="nu0">1</span>;
              f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">:=</span>x;
              t<span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>;
            <span class="kw1">end</span>;
          inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span>;
          inc<span class="br0">&#40;</span>t<span class="br0">&#91;</span>f<span class="br0">&#91;</span>j<span class="sy0">,</span>g<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#93;</span>.<span class="me1">time</span><span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> check1<span class="br0">&#40;</span>st1<span class="sy0">,</span>st2<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> length<span class="br0">&#40;</span>st1<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>st1<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> st1&lt;st2 <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="kw1">else</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> check2<span class="br0">&#40;</span>st1<span class="sy0">,</span>st2<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> length<span class="br0">&#40;</span>st1<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>st1<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>st2<span class="br0">&#41;</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> st1&gt;st2 <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span> <span class="kw1">else</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>r<span class="sy0">:</span><span class="kw4">integer</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span> i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">integer</span>;
      mid<span class="sy0">,</span>temp<span class="sy0">:</span>node;
  <span class="kw1">begin</span>
    i<span class="sy0">:=</span>l;
    j<span class="sy0">:=</span>r;
    mid<span class="sy0">:=</span>t<span class="br0">&#91;</span><span class="br0">&#40;</span>l<span class="sy0">+</span>r<span class="br0">&#41;</span> <span class="kw1">div</span> <span class="nu0">2</span><span class="br0">&#93;</span>;
    <span class="kw1">while</span> i&lt;j <span class="kw1">do</span>
      <span class="kw1">begin</span>
        <span class="kw1">while</span> <span class="br0">&#40;</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">time</span>&gt;mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw3">and</span> check1<span class="br0">&#40;</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">,</span>mid.<span class="me1">code</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">time</span>&lt;mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>mid.<span class="me1">time</span><span class="br0">&#41;</span> <span class="kw3">and</span> check2<span class="br0">&#40;</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">code</span><span class="sy0">,</span>mid.<span class="me1">code</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
        <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
          <span class="kw1">begin</span>
            temp<span class="sy0">:=</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
            t<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>t<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
            t<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>temp;
            inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
            dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
      <span class="kw1">end</span>;
    <span class="kw1">if</span> l&lt;j <span class="kw1">then</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span>j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>r<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> print;
  <span class="kw1">var</span> k<span class="sy0">,</span>i<span class="sy0">,</span>s<span class="sy0">,</span>tt<span class="sy0">:</span><span class="kw4">integer</span>;
  <span class="kw1">begin</span>
    k<span class="sy0">:=</span><span class="nu0">1</span>;
    i<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">while</span> k&lt;<span class="sy0">=</span>n <span class="kw1">do</span>
      <span class="kw1">begin</span>
        tt<span class="sy0">:=</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">time</span>;
        <span class="kw1">if</span> tt<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw1">break</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>tt<span class="br0">&#41;</span>;
        s<span class="sy0">:=</span><span class="nu0">1</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>tt<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>i&lt;<span class="sy0">=</span>x<span class="br0">&#41;</span> <span class="kw1">do</span>
          <span class="kw1">begin</span>
            <span class="kw3">write</span><span class="br0">&#40;</span>t<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">code</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> s <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span>
              <span class="kw3">writeln</span>
            <span class="kw1">else</span>
              <span class="kw1">if</span> t<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">time</span><span class="sy0">=</span>tt <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw3">writeln</span>;
            i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
            s<span class="sy0">:=</span>s<span class="sy0">+</span><span class="nu0">1</span>;
          <span class="kw1">end</span>;
        k<span class="sy0">:=</span>k<span class="sy0">+</span><span class="nu0">1</span>;
      <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  init;
  work;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>x<span class="br0">&#41;</span>;
  print;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=13" title="编辑段落：代码A">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.81A">代码A</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{By Indeed}</span>
<span class="coMULTI">{
ID:dotinde1
PROG:contact
LANG:PASCAL
}</span>
<span class="kw1">program</span> Contact;
&#160;
<span class="kw1">type</span>
  PNOde <span class="sy0">=</span> ^TNode;
&#160;
  TNode <span class="sy0">=</span> <span class="kw4">record</span>
    Count<span class="sy0">:</span> <span class="kw4">longint</span>;
    s<span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="st_h">'0'</span>..<span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="kw1">of</span> PNOde;
  <span class="kw1">end</span>;
  TStr <span class="sy0">=</span> <span class="kw4">string</span>
&#160;
    <span class="br0">&#91;</span><span class="nu0">12</span><span class="br0">&#93;</span>;
&#160;
  TEle <span class="sy0">=</span> <span class="kw4">record</span>
    num<span class="sy0">:</span> TStr;
    Count<span class="sy0">:</span> <span class="kw4">longint</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">var</span>
  s<span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>;
  re<span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">40960</span><span class="br0">&#93;</span> <span class="kw1">of</span> TEle;
  ec<span class="sy0">:</span> <span class="kw4">longint</span> <span class="sy0">=</span> <span class="nu0">0</span>;
  root<span class="sy0">:</span> PNode;
  a<span class="sy0">,</span> b<span class="sy0">,</span> n<span class="sy0">,</span> l<span class="sy0">:</span> <span class="kw4">longint</span>;
  i<span class="sy0">,</span> j<span class="sy0">:</span> <span class="kw4">longint</span>;
  ll<span class="sy0">:</span> <span class="kw4">longint</span> <span class="sy0">=</span> <span class="sy0">-</span><span class="nu0">1</span>;
  flag<span class="sy0">:</span> <span class="kw4">boolean</span>;
  First<span class="sy0">:</span> <span class="kw4">boolean</span> <span class="sy0">=</span> <span class="kw2">True</span>;
  oc<span class="sy0">:</span> <span class="kw4">longint</span> <span class="sy0">=</span> <span class="nu0">0</span>;
  oco<span class="sy0">:</span> <span class="kw4">longint</span>;
&#160;
  <span class="kw1">function</span> cmp<span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="sy0">:</span> TStr<span class="br0">&#41;</span> <span class="sy0">:</span> <span class="kw4">boolean</span>;
  <span class="kw1">var</span>
    i<span class="sy0">,</span> l<span class="sy0">:</span> <span class="kw4">longint</span>;
  <span class="kw1">begin</span>
    l <span class="sy0">:=</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>&gt;length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="kw1">then</span>
      exit<span class="br0">&#40;</span><span class="kw2">False</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> length<span class="br0">&#40;</span>a<span class="br0">&#41;</span>&lt;length<span class="br0">&#40;</span>b<span class="br0">&#41;</span> <span class="kw1">then</span>
      exit<span class="br0">&#40;</span><span class="kw2">True</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i <span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
      <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span>
        exit<span class="br0">&#40;</span><span class="kw2">True</span><span class="br0">&#41;</span>
      <span class="kw1">else</span> <span class="kw1">if</span> a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="kw1">then</span>
        exit<span class="br0">&#40;</span><span class="kw2">False</span><span class="br0">&#41;</span>;
    cmp <span class="sy0">:=</span> <span class="kw2">False</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>l<span class="sy0">,</span> r<span class="sy0">:</span> <span class="kw4">longint</span><span class="br0">&#41;</span>;
  <span class="kw1">var</span>
    i<span class="sy0">,</span> j<span class="sy0">:</span> <span class="kw4">longint</span>;
    m<span class="sy0">,</span> t<span class="sy0">:</span> TEle;
  <span class="kw1">begin</span>
    m <span class="sy0">:=</span> re<span class="br0">&#91;</span>l<span class="sy0">+</span>random<span class="br0">&#40;</span>r<span class="sy0">-</span>l<span class="br0">&#41;</span><span class="br0">&#93;</span>;
    i <span class="sy0">:=</span> l;
    j <span class="sy0">:=</span> r;
    <span class="kw1">repeat</span>
      <span class="kw1">while</span> <span class="br0">&#40;</span>re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">Count</span>&gt;m.<span class="me1">Count</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">Count</span> <span class="sy0">=</span> m.<span class="me1">Count</span><span class="br0">&#41;</span> <span class="kw3">and</span>
          cmp<span class="br0">&#40;</span>re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">,</span> m.<span class="me1">num</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
        Inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      <span class="kw1">while</span> <span class="br0">&#40;</span>re<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">Count</span>&lt;m.<span class="me1">Count</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>re<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">Count</span> <span class="sy0">=</span> m.<span class="me1">Count</span><span class="br0">&#41;</span> <span class="kw3">and</span>
          cmp<span class="br0">&#40;</span>m.<span class="me1">num</span><span class="sy0">,</span> re<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
        Dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
      <span class="kw1">begin</span>
        t <span class="sy0">:=</span> re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>;
        re<span class="br0">&#91;</span>i<span class="br0">&#93;</span> <span class="sy0">:=</span> re<span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
        re<span class="br0">&#91;</span>j<span class="br0">&#93;</span> <span class="sy0">:=</span> t;
        Inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        Dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">until</span> i&gt;j;
    <span class="kw1">if</span> l&lt;j <span class="kw1">then</span>
      qsort<span class="br0">&#40;</span>l<span class="sy0">,</span> j<span class="br0">&#41;</span>;
    <span class="kw1">if</span> i&lt;r <span class="kw1">then</span>
      qsort<span class="br0">&#40;</span>i<span class="sy0">,</span> r<span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> treedfs<span class="br0">&#40;</span>r<span class="sy0">:</span> PNode; s<span class="sy0">:</span> TStr<span class="br0">&#41;</span>;
  <span class="kw1">var</span>
    c<span class="sy0">:</span> <span class="kw4">char</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> r <span class="sy0">=</span> <span class="kw2">nil</span> <span class="kw1">then</span>
      exit;
    Inc<span class="br0">&#40;</span>ec<span class="br0">&#41;</span>;
    with re<span class="br0">&#91;</span>ec<span class="br0">&#93;</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      num <span class="sy0">:=</span> s;
      Count <span class="sy0">:=</span> r^.<span class="me1">Count</span>;
    <span class="kw1">end</span>;
    <span class="kw1">for</span> c <span class="sy0">:=</span> <span class="st_h">'0'</span> <span class="kw1">to</span> <span class="st_h">'1'</span> <span class="kw1">do</span>
      treedfs<span class="br0">&#40;</span>r^.<span class="me1">s</span><span class="br0">&#91;</span>c<span class="br0">&#93;</span><span class="sy0">,</span> s<span class="sy0">+</span>c<span class="br0">&#41;</span>;
&#160;
  <span class="kw1">end</span>;
&#160;
  <span class="kw1">procedure</span> dfs<span class="br0">&#40;</span>d<span class="sy0">,</span> p<span class="sy0">:</span> <span class="kw4">longint</span>; <span class="kw1">var</span> r<span class="sy0">:</span> PNode<span class="br0">&#41;</span>;
  <span class="kw1">begin</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>d <span class="sy0">=</span> b<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span>d<span class="sy0">+</span>p<span class="sy0">-</span><span class="nu0">1</span>&gt;l<span class="br0">&#41;</span> <span class="kw1">then</span>
      exit;
    <span class="kw1">if</span> r <span class="sy0">=</span> <span class="kw2">nil</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
      <span class="kw3">new</span><span class="br0">&#40;</span>r<span class="br0">&#41;</span>;
      r^.<span class="me1">Count</span> <span class="sy0">:=</span> <span class="nu0">0</span>;
      r^.<span class="me1">s</span><span class="br0">&#91;</span><span class="st_h">'0'</span><span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="kw2">nil</span>;
      r^.<span class="me1">s</span><span class="br0">&#91;</span><span class="st_h">'1'</span><span class="br0">&#93;</span> <span class="sy0">:=</span> <span class="kw2">nil</span>;
    <span class="kw1">end</span>;
    Inc<span class="br0">&#40;</span>r^.<span class="me1">Count</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> d<span class="sy0">+</span>p&lt;<span class="sy0">=</span>l <span class="kw1">then</span>
      dfs<span class="br0">&#40;</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span> p<span class="sy0">,</span> r^.<span class="me1">s</span><span class="br0">&#91;</span>s<span class="br0">&#91;</span>d<span class="sy0">+</span>p<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
  Assign<span class="br0">&#40;</span>input<span class="sy0">,</span> <span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  Assign<span class="br0">&#40;</span>output<span class="sy0">,</span> <span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span> b<span class="sy0">,</span> n<span class="br0">&#41;</span>;
  <span class="kw3">new</span><span class="br0">&#40;</span>root<span class="br0">&#41;</span>;
  fillchar<span class="br0">&#40;</span>root^<span class="sy0">,</span> sizeof<span class="br0">&#40;</span>root^<span class="br0">&#41;</span><span class="sy0">,</span> <span class="nu0">0</span><span class="br0">&#41;</span>;
  i <span class="sy0">:=</span> <span class="nu0">0</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">EOF</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eoln</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      Inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
      <span class="kw3">Read</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">end</span>;
    <span class="kw3">readln</span>;
  <span class="kw1">end</span>;
  l <span class="sy0">:=</span> i;
  <span class="kw1">for</span> i <span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> l <span class="kw1">do</span>
    dfs<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span> i<span class="sy0">,</span> root^.<span class="me1">s</span><span class="br0">&#91;</span>s<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
  treedfs<span class="br0">&#40;</span>root^.<span class="me1">s</span><span class="br0">&#91;</span><span class="st_h">'0'</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="st_h">'0'</span><span class="br0">&#41;</span>;
  treedfs<span class="br0">&#40;</span>root^.<span class="me1">s</span><span class="br0">&#91;</span><span class="st_h">'1'</span><span class="br0">&#93;</span><span class="sy0">,</span> <span class="st_h">'1'</span><span class="br0">&#41;</span>;
  qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span> ec<span class="br0">&#41;</span>;
  <span class="kw1">for</span> I <span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> ec <span class="kw1">do</span>
    <span class="kw1">if</span> length<span class="br0">&#40;</span>re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#41;</span>&gt;<span class="sy0">=</span>a <span class="kw1">then</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">Count</span>&lt;&gt;ll <span class="kw1">then</span>
      <span class="kw1">begin</span>
        <span class="kw1">if</span> oc <span class="sy0">=</span> n <span class="kw1">then</span>
          <span class="kw1">break</span>;
        <span class="kw1">if</span> <span class="kw1">not</span> First <span class="kw1">then</span>
          <span class="kw3">writeln</span>
        <span class="kw1">else</span>
          First <span class="sy0">:=</span> <span class="kw2">False</span>;
        Inc<span class="br0">&#40;</span>oc<span class="br0">&#41;</span>;
        ll <span class="sy0">:=</span> re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">Count</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>ll<span class="br0">&#41;</span>;
        flag <span class="sy0">:=</span> <span class="kw2">False</span>;
        oco <span class="sy0">:=</span> <span class="nu0">0</span>;
      <span class="kw1">end</span>
      <span class="kw1">else</span> <span class="kw1">if</span> oco <span class="sy0">=</span> <span class="nu0">6</span> <span class="kw1">then</span>
      <span class="kw1">begin</span>
        <span class="kw3">writeln</span>;
        flag <span class="sy0">:=</span> <span class="kw2">False</span>;
        oco <span class="sy0">:=</span> <span class="nu0">0</span>;
      <span class="kw1">end</span>;
      <span class="kw1">if</span> <span class="kw1">not</span> flag <span class="kw1">then</span>
      <span class="kw1">begin</span>
        <span class="kw3">Write</span><span class="br0">&#40;</span>re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#41;</span>;
        flag <span class="sy0">:=</span> <span class="kw2">True</span>;
        Inc<span class="br0">&#40;</span>oco<span class="br0">&#41;</span>;
      <span class="kw1">end</span>
      <span class="kw1">else</span>
      <span class="kw1">begin</span>
        <span class="kw3">Write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="sy0">,</span> re<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#41;</span>;
        Inc<span class="br0">&#40;</span>oco<span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  <span class="kw3">writeln</span>;
  Close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  Close<span class="br0">&#40;</span>Output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=14" title="编辑段落：Trie Plus">编辑</a>]</span> <span class="mw-headline" id="Trie_Plus">Trie Plus</span></h2>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1"><span class="coMULTI">{
ID: yw100101
PROB: contact
LANG: PASCAL
}</span>
<span class="kw1">program</span> c046;
<span class="kw1">const</span>
    inf <span class="sy0">=</span> <span class="st_h">'contact.in'</span>;
    ouf <span class="sy0">=</span> <span class="st_h">'contact.out'</span>;
&#160;
<span class="kw1">type</span>
    node <span class="sy0">=</span> <span class="kw4">record</span>        <span class="co1">// 储存结果</span>
        s   <span class="sy0">:</span> <span class="kw4">string</span>;
        c   <span class="sy0">:</span> <span class="kw4">longint</span>;
    <span class="kw1">end</span>;
&#160;
<span class="kw1">var</span>
    tre <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">20000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;  <span class="co1">// trie主体 用类似堆的方式储存</span>
    s   <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">char</span>;    <span class="co1">// 主串 为保证效率 用了字符数组</span>
    ls  <span class="sy0">:</span> <span class="kw4">longint</span>;                     <span class="co1">// 主串长度 </span>
    ans <span class="sy0">:</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">10000</span><span class="br0">&#93;</span> <span class="kw1">of</span> node;     <span class="co1">// 结果</span>
    la  <span class="sy0">:</span> <span class="kw4">longint</span>;                     <span class="co1">// 结果个数</span>
    a<span class="sy0">,</span>b<span class="sy0">,</span>
    n   <span class="sy0">:</span> <span class="kw4">byte</span>;
    y   <span class="sy0">:</span> <span class="kw4">string</span>;                      <span class="co1">// 快速排序和统计时的 临时字符串</span>
    x   <span class="sy0">:</span> <span class="kw4">longint</span>;                     <span class="co1">// 快速排序时的临时变量</span>
    t   <span class="sy0">:</span> node;
&#160;
<span class="kw1">procedure</span> readin;
<span class="kw1">begin</span>
    <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
    ls<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eoln</span> <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>ls<span class="br0">&#41;</span>;
                    <span class="kw3">read</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>ls<span class="br0">&#93;</span><span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
            <span class="kw3">readln</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> min<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    <span class="kw1">if</span> a&gt;b <span class="kw1">then</span>
        exit<span class="br0">&#40;</span>b<span class="br0">&#41;</span>
    <span class="kw1">else</span>
        exit<span class="br0">&#40;</span>a<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> work;
<span class="kw1">var</span>
    i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
    p<span class="sy0">:</span><span class="kw4">integer</span>;
<span class="kw1">begin</span>
    <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> ls <span class="kw1">do</span>
        <span class="kw1">begin</span>
            p<span class="sy0">:=</span><span class="nu0">1</span>;
            <span class="kw1">for</span> j<span class="sy0">:=</span>i <span class="kw1">to</span> min<span class="br0">&#40;</span>i<span class="sy0">+</span>b<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span>ls<span class="br0">&#41;</span> <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    <span class="kw1">if</span> s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span>
                        p<span class="sy0">:=</span>p <span class="kw1">shl</span> <span class="nu0">1</span> <span class="sy0">+</span> <span class="nu0">1</span>
                    <span class="kw1">else</span>
                        p<span class="sy0">:=</span>p <span class="kw1">shl</span> <span class="nu0">1</span>;
                    inc<span class="br0">&#40;</span>tre<span class="br0">&#91;</span>p<span class="br0">&#93;</span><span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> count<span class="br0">&#40;</span>d<span class="sy0">:</span><span class="kw4">byte</span>;pos<span class="sy0">:</span><span class="kw4">integer</span><span class="br0">&#41;</span>;    <span class="co1">// 统计过程</span>
<span class="kw1">begin</span>
    <span class="kw1">if</span> tre<span class="br0">&#91;</span>pos<span class="br0">&#93;</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">then</span> exit;
    <span class="kw1">if</span> d&gt;b <span class="kw1">then</span> exit;
    inc<span class="br0">&#40;</span>y<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> <span class="kw3">odd</span><span class="br0">&#40;</span>pos<span class="br0">&#41;</span> <span class="kw1">then</span>
        y<span class="br0">&#91;</span>d<span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'1'</span>
    <span class="kw1">else</span>
        y<span class="br0">&#91;</span>d<span class="br0">&#93;</span><span class="sy0">:=</span><span class="st_h">'0'</span>;
    <span class="kw1">if</span> d&gt;<span class="sy0">=</span>a <span class="kw1">then</span>
        <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>la<span class="br0">&#41;</span>;
            ans<span class="br0">&#91;</span>la<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">:=</span>y;
            ans<span class="br0">&#91;</span>la<span class="br0">&#93;</span>.<span class="me1">c</span><span class="sy0">:=</span>tre<span class="br0">&#91;</span>pos<span class="br0">&#93;</span>;
        <span class="kw1">end</span>;
&#160;
    <span class="kw1">if</span> tre<span class="br0">&#91;</span>pos <span class="kw1">shl</span> <span class="nu0">1</span><span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> count<span class="br0">&#40;</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>pos <span class="kw1">shl</span> <span class="nu0">1</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> tre<span class="br0">&#91;</span>pos <span class="kw1">shl</span> <span class="nu0">1</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span> count<span class="br0">&#40;</span>d<span class="sy0">+</span><span class="nu0">1</span><span class="sy0">,</span>pos <span class="kw1">shl</span> <span class="nu0">1</span> <span class="sy0">+</span> <span class="nu0">1</span><span class="br0">&#41;</span>;
&#160;
    dec<span class="br0">&#40;</span>y<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> swap<span class="br0">&#40;</span><span class="kw1">var</span> a<span class="sy0">,</span>b<span class="sy0">:</span>node<span class="br0">&#41;</span>;
<span class="kw1">var</span>
    t<span class="sy0">:</span>node;
<span class="kw1">begin</span>
    t<span class="sy0">:=</span>a;
    a<span class="sy0">:=</span>b;
    b<span class="sy0">:=</span>t;
<span class="kw1">end</span>;
&#160;
<span class="kw1">function</span> change<span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">:</span><span class="kw4">string</span><span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;   <span class="co1">// 比较字符串 需要交换时 返回false 否则为true</span>
<span class="kw1">var</span>
    i<span class="sy0">:</span><span class="kw4">byte</span>;
<span class="kw1">begin</span>
    change<span class="sy0">:=</span><span class="kw2">false</span>;
    <span class="kw1">if</span> a<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&gt;b<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
        exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
    <span class="kw1">if</span> a<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span>&lt;b<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span> <span class="kw1">then</span>
        exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> <span class="kw3">ord</span><span class="br0">&#40;</span>a<span class="br0">&#91;</span><span class="nu0">0</span><span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&lt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
            <span class="kw1">if</span> <span class="br0">&#40;</span>a<span class="br0">&#91;</span>i<span class="br0">&#93;</span>&gt;b<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">then</span>
                exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> sort<span class="br0">&#40;</span>b<span class="sy0">,</span>e<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;      <span class="co1">// 以次数为第一关键字 字符串为第二关键字的快排</span>
<span class="kw1">var</span>
    i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
<span class="kw1">begin</span>
    i<span class="sy0">:=</span>b;
    j<span class="sy0">:=</span>e;
    x<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="br0">&#41;</span> <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">c</span>;
    y<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="br0">&#40;</span>i<span class="sy0">+</span>j<span class="br0">&#41;</span> <span class="kw1">shr</span> <span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">s</span>;
    <span class="kw1">repeat</span>
        <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">c</span>&gt;x<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">c</span><span class="sy0">=</span>x<span class="br0">&#41;</span> <span class="kw3">and</span> change<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">,</span>y<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
            inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
        <span class="kw1">while</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">c</span>&lt;x<span class="br0">&#41;</span> <span class="kw1">or</span> <span class="br0">&#40;</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">c</span><span class="sy0">=</span>x<span class="br0">&#41;</span> <span class="kw3">and</span> change<span class="br0">&#40;</span>y<span class="sy0">,</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span>.<span class="me1">s</span><span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="kw1">do</span>
            dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
        <span class="kw1">if</span> i&lt;<span class="sy0">=</span>j <span class="kw1">then</span>
            <span class="kw1">begin</span>
                swap<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
                inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
                dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
            <span class="kw1">end</span>;
    <span class="kw1">until</span> i&gt;j;
    <span class="kw1">if</span> i&lt;e <span class="kw1">then</span>
        sort<span class="br0">&#40;</span>i<span class="sy0">,</span>e<span class="br0">&#41;</span>;
    <span class="kw1">if</span> j&gt;b <span class="kw1">then</span>
        sort<span class="br0">&#40;</span>b<span class="sy0">,</span>j<span class="br0">&#41;</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">procedure</span> print;
<span class="kw1">var</span>
    i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">:</span><span class="kw4">longint</span>;
    tc<span class="sy0">:</span><span class="kw4">longint</span>;
    s<span class="sy0">:</span><span class="kw4">ansistring</span>;
<span class="kw1">begin</span>
    tc<span class="sy0">:=</span>ans<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">c</span>;
    i<span class="sy0">:=</span><span class="nu0">0</span>;
    k<span class="sy0">:=</span><span class="nu0">1</span>;
    <span class="kw1">for</span> i<span class="sy0">:=</span> <span class="nu0">1</span> <span class="kw1">to</span> n <span class="kw1">do</span>
        <span class="kw1">begin</span>
            <span class="kw3">writeln</span><span class="br0">&#40;</span>tc<span class="br0">&#41;</span>;
            s<span class="sy0">:=</span><span class="st_h">''</span>;
            j<span class="sy0">:=</span><span class="nu0">0</span>;
            <span class="kw1">while</span> <span class="br0">&#40;</span>k&lt;<span class="sy0">=</span>la<span class="br0">&#41;</span> <span class="kw3">and</span> <span class="br0">&#40;</span>ans<span class="br0">&#91;</span>k<span class="br0">&#93;</span>.<span class="me1">c</span><span class="sy0">=</span>tc<span class="br0">&#41;</span> <span class="kw1">do</span>
                <span class="kw1">begin</span>
                    inc<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
                    s<span class="sy0">:=</span>s<span class="sy0">+</span>ans<span class="br0">&#91;</span>k<span class="br0">&#93;</span>.<span class="me1">s</span><span class="sy0">+</span><span class="st_h">' '</span>;
                    <span class="kw1">if</span> j <span class="kw1">mod</span> <span class="nu0">6</span> <span class="sy0">=</span> <span class="nu0">0</span> <span class="kw1">then</span>
                       <span class="kw1">begin</span>
                           delete<span class="br0">&#40;</span>s<span class="sy0">,</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
                           <span class="kw3">writeln</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
                           s<span class="sy0">:=</span><span class="st_h">''</span>;
                       <span class="kw1">end</span>;
                    inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
            <span class="kw1">if</span> j <span class="kw1">mod</span> <span class="nu0">6</span> &lt;&gt; <span class="nu0">0</span> <span class="kw1">then</span>
                <span class="kw1">begin</span>
                    delete<span class="br0">&#40;</span>s<span class="sy0">,</span>length<span class="br0">&#40;</span>s<span class="br0">&#41;</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#41;</span>;
                    <span class="kw3">writeln</span><span class="br0">&#40;</span>s<span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
            tc<span class="sy0">:=</span>ans<span class="br0">&#91;</span>k<span class="br0">&#93;</span>.<span class="me1">c</span>;
            <span class="kw1">if</span> k&gt;la <span class="kw1">then</span> <span class="kw1">break</span>;
        <span class="kw1">end</span>;
<span class="kw1">end</span>;
&#160;
<span class="kw1">begin</span>
    assign<span class="br0">&#40;</span>input<span class="sy0">,</span>inf<span class="br0">&#41;</span>;
    reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    assign<span class="br0">&#40;</span>output<span class="sy0">,</span>ouf<span class="br0">&#41;</span>;
    rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
&#160;
    readin;
    work;
    y<span class="sy0">:=</span><span class="st_h">''</span>;
    count<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">2</span><span class="br0">&#41;</span>;
    y<span class="sy0">:=</span><span class="st_h">''</span>;
    count<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">3</span><span class="br0">&#41;</span>;
    sort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>la<span class="br0">&#41;</span>;
    print;
&#160;
    close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
    close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<h2><span class="editsection">[<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit&amp;section=15" title="编辑段落：代码-K">编辑</a>]</span> <span class="mw-headline" id=".E4.BB.A3.E7.A0.81-K">代码-K</span></h2>
<p>动归+二进制优化
代码相对上面的有些不长
但效率不是特别高……最后0.086s才过。
大神BS吧……
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">USER<span class="sy0">:</span> Jin Yi <span class="br0">&#91;</span>z2874381<span class="br0">&#93;</span>
TASK<span class="sy0">:</span> contact
LANG<span class="sy0">:</span> PASCAL
&#160;
Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.011</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.065</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.086</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.086</span> secs<span class="sy0">,</span> <span class="nu0">5152</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
&#160;
&#160;
<span class="kw1">var</span>
a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">,</span>i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
c<span class="sy0">:</span><span class="kw4">char</span>;
len<span class="sy0">:</span><span class="kw4">longint</span>;
f<span class="sy0">:</span><span class="kw4">packed</span> <span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">200000</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">0</span>..<span class="nu0">4096</span><span class="sy0">,</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
<span class="kw1">procedure</span>  maxx;
<span class="kw1">var</span>
i<span class="sy0">,</span>j<span class="sy0">,</span>k<span class="sy0">,</span>max<span class="sy0">,</span>l<span class="sy0">:</span><span class="kw4">longint</span>;
t<span class="sy0">:</span><span class="kw4">boolean</span>;
<span class="kw1">begin</span>
max<span class="sy0">:=-</span><span class="nu0">1</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4096</span> <span class="kw1">do</span>
 <span class="kw1">for</span> j<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
   <span class="kw1">if</span> max&lt;ans<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span> <span class="kw1">then</span>
    <span class="kw1">begin</span>
	 max<span class="sy0">:=</span>ans<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span>;
	<span class="kw1">end</span>;
<span class="kw1">if</span> max<span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> exit;
<span class="kw3">writeln</span><span class="br0">&#40;</span>max<span class="br0">&#41;</span>;
t<span class="sy0">:=</span><span class="kw2">false</span>; k<span class="sy0">:=</span><span class="nu0">1</span>;
<span class="kw1">for</span> j<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
 <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">4096</span> <span class="kw1">do</span>
  <span class="kw1">if</span> ans<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">=</span>max <span class="kw1">then</span>
  <span class="kw1">begin</span>
   <span class="kw1">if</span> k <span class="sy0">=</span> <span class="nu0">7</span> <span class="kw1">then</span> <span class="kw1">begin</span>  k<span class="sy0">:=</span><span class="nu0">1</span>;<span class="kw3">writeln</span>;t<span class="sy0">:=</span><span class="kw2">false</span>;<span class="kw1">end</span>;
   <span class="kw1">if</span> <span class="kw1">not</span> t <span class="kw1">then</span> t<span class="sy0">:=</span><span class="kw2">true</span> <span class="kw1">else</span>  <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
   inc<span class="br0">&#40;</span>k<span class="br0">&#41;</span>;
   <span class="kw1">for</span> l<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> j <span class="kw1">do</span>
    <span class="kw1">if</span> <span class="br0">&#40;</span>i <span class="kw3">and</span><span class="br0">&#40;</span><span class="nu0">1</span> <span class="kw1">shl</span> <span class="br0">&#40;</span>j<span class="sy0">-</span>l<span class="br0">&#41;</span><span class="br0">&#41;</span> <span class="br0">&#41;</span>&lt;&gt;<span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="nu0">1</span><span class="br0">&#41;</span> <span class="kw1">else</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;
   ans<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">:=-</span><span class="nu0">1</span>;
  <span class="kw1">end</span>;
 <span class="kw3">writeln</span>;
<span class="kw1">end</span>;
<span class="kw1">begin</span>
assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
len<span class="sy0">:=</span><span class="nu0">0</span>;
 <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
  <span class="kw1">begin</span>
   <span class="kw3">read</span><span class="br0">&#40;</span>c<span class="br0">&#41;</span>;
   <span class="kw1">case</span> c <span class="kw1">of</span>
     <span class="st_h">'0'</span><span class="sy0">:</span><span class="kw1">begin</span> inc<span class="br0">&#40;</span>len<span class="br0">&#41;</span>;f<span class="br0">&#91;</span>len<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">0</span>; <span class="kw1">end</span>;
	 <span class="st_h">'1'</span><span class="sy0">:</span><span class="kw1">begin</span> inc<span class="br0">&#40;</span>len<span class="br0">&#41;</span>;f<span class="br0">&#91;</span>len<span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>; <span class="kw1">end</span>;
   <span class="kw1">end</span>;
  <span class="kw1">end</span>;
&#160;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> len <span class="kw1">do</span>
  <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> <span class="nu0">12</span> <span class="kw1">do</span>
  <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>len  <span class="kw1">then</span>
   f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span> <span class="kw1">shl</span> <span class="nu0">1</span> <span class="sy0">+</span> f<span class="br0">&#91;</span>i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="sy0">,</span><span class="nu0">1</span><span class="br0">&#93;</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> len <span class="kw1">do</span>
 <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> <span class="nu0">12</span> <span class="kw1">do</span>
   <span class="kw1">if</span> i<span class="sy0">+</span>j<span class="sy0">-</span><span class="nu0">1</span>&lt;<span class="sy0">=</span>len  <span class="kw1">then</span>
    ans<span class="br0">&#91;</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">:=</span>ans<span class="br0">&#91;</span>f<span class="br0">&#91;</span>i<span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">,</span>j<span class="br0">&#93;</span><span class="sy0">+</span><span class="nu0">1</span>;
<span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> n  <span class="kw1">do</span> maxx;
close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="pascal source-pascal"><pre class="de1">Compiling...
<span class="me1">Compile</span><span class="sy0">:</span> OK
&#160;
Executing...
   <span class="me1">Test</span> <span class="nu0">1</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">2</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">3</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">4</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.000</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">5</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.032</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">6</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.054</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
   Test <span class="nu0">7</span><span class="sy0">:</span> TEST OK <span class="br0">&#91;</span><span class="nu0">0.065</span> secs<span class="sy0">,</span> <span class="nu0">2064</span> KB<span class="br0">&#93;</span>
&#160;
All tests OK.
&#160;
&#160;
<span class="kw1">type</span>
  saver<span class="sy0">=</span><span class="kw4">record</span>
      num<span class="sy0">:</span><span class="kw4">longint</span>;
      v<span class="sy0">:</span><span class="kw4">longint</span>;
      mm<span class="sy0">:</span><span class="kw4">longint</span>;
    <span class="kw1">end</span>;
<span class="kw1">var</span>
  f<span class="sy0">:</span><span class="kw4">Array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">12</span><span class="sy0">,</span><span class="nu0">0</span>..<span class="nu0">8192</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  w<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">13</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">longint</span>;
  c<span class="sy0">:</span><span class="kw4">ansistring</span>;
  i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;     cc<span class="sy0">:</span><span class="kw4">ansistring</span>;
  a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="sy0">:</span><span class="kw4">longint</span>;
  kk<span class="sy0">:</span><span class="kw4">longint</span>;    zz<span class="sy0">:</span><span class="kw4">integer</span>;
  x<span class="sy0">,</span>h<span class="sy0">:</span><span class="kw4">longint</span>;
  s<span class="sy0">:</span><span class="kw4">string</span>;
  ansm<span class="sy0">:</span><span class="kw4">longint</span>;
  ans<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">120000</span><span class="br0">&#93;</span> <span class="kw1">of</span> saver;
    <span class="kw1">procedure</span> out_put<span class="br0">&#40;</span>x<span class="sy0">,</span>y<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
      <span class="kw1">var</span>
        i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
        an<span class="sy0">:</span><span class="kw4">array</span><span class="br0">&#91;</span><span class="nu0">1</span>..<span class="nu0">100</span><span class="br0">&#93;</span> <span class="kw1">of</span> <span class="kw4">integer</span>;
      <span class="kw1">begin</span>
        i<span class="sy0">:=</span><span class="nu0">1</span>;
        <span class="kw1">while</span> x&gt;<span class="nu0">0</span> <span class="kw1">do</span>
          <span class="kw1">begin</span>
            an<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>x <span class="kw1">mod</span> <span class="nu0">2</span>;
            x<span class="sy0">:=</span>x <span class="kw1">div</span> <span class="nu0">2</span>;
            inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
        <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> y<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span><span class="nu0">0</span><span class="br0">&#41;</span>;
        <span class="kw1">for</span> j<span class="sy0">:=</span>i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">downto</span> <span class="nu0">1</span> <span class="kw1">do</span> <span class="kw3">write</span><span class="br0">&#40;</span>an<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      <span class="kw1">end</span>;
          <span class="kw1">procedure</span> swap<span class="br0">&#40;</span><span class="kw1">var</span> num1<span class="sy0">,</span>num2<span class="sy0">:</span>saver<span class="br0">&#41;</span>;
            <span class="kw1">var</span>
              num3<span class="sy0">:</span>saver;
            <span class="kw1">begin</span>
              num3<span class="sy0">:=</span>num1;
              num1<span class="sy0">:=</span>num2;
              num2<span class="sy0">:=</span>num3;
            <span class="kw1">end</span>;
          <span class="kw1">function</span> cmp<span class="br0">&#40;</span>num1<span class="sy0">,</span>num2<span class="sy0">:</span>saver<span class="br0">&#41;</span><span class="sy0">:</span><span class="kw4">boolean</span>;
            <span class="kw1">begin</span>
              <span class="kw1">if</span> num1.<span class="me1">num</span>&gt;num2.<span class="me1">num</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
              <span class="kw1">if</span> num1.<span class="me1">num</span>&lt;num2.<span class="me1">num</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
              <span class="kw1">if</span> num1.<span class="me1">mm</span>&lt;num2.<span class="me1">mm</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
              <span class="kw1">if</span> num1.<span class="me1">mm</span>&gt;num2.<span class="me1">mm</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
              <span class="kw1">if</span> num1.<span class="me1">v</span>&lt;num2.<span class="me1">v</span> <span class="kw1">then</span> exit<span class="br0">&#40;</span><span class="kw2">true</span><span class="br0">&#41;</span>;
              exit<span class="br0">&#40;</span><span class="kw2">false</span><span class="br0">&#41;</span>;
            <span class="kw1">end</span>;
        <span class="kw1">procedure</span> qsort<span class="br0">&#40;</span>r<span class="sy0">,</span>l<span class="sy0">:</span><span class="kw4">longint</span><span class="br0">&#41;</span>;
          <span class="kw1">var</span>
            i<span class="sy0">,</span>j<span class="sy0">:</span><span class="kw4">longint</span>;
            x<span class="sy0">:</span>saver;
          <span class="kw1">begin</span>
            i<span class="sy0">:=</span>r;
            j<span class="sy0">:=</span>l;
            x<span class="sy0">:=</span>ans<span class="br0">&#91;</span>random<span class="br0">&#40;</span>j<span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#41;</span><span class="sy0">+</span>i<span class="br0">&#93;</span>;
            <span class="kw1">repeat</span>
              <span class="kw1">while</span> cmp<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>x<span class="br0">&#41;</span> <span class="kw1">do</span> inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
              <span class="kw1">while</span> cmp<span class="br0">&#40;</span>x<span class="sy0">,</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span> <span class="kw1">do</span> dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
              <span class="kw1">if</span> <span class="kw1">not</span><span class="br0">&#40;</span>i&gt;j<span class="br0">&#41;</span> <span class="kw1">then</span>
                <span class="kw1">begin</span>
                  swap<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span>;
                  inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;
                  dec<span class="br0">&#40;</span>j<span class="br0">&#41;</span>;
                <span class="kw1">end</span>;
            <span class="kw1">until</span> i&gt;j;
            <span class="kw1">if</span> i&lt;l <span class="kw1">then</span> qsort<span class="br0">&#40;</span>i<span class="sy0">,</span>l<span class="br0">&#41;</span>;
            <span class="kw1">if</span> j&gt;r <span class="kw1">then</span> qsort<span class="br0">&#40;</span>r<span class="sy0">,</span>j<span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
<span class="kw1">begin</span>
  ansm<span class="sy0">:=</span><span class="nu0">0</span>;
  randomize;
  assign<span class="br0">&#40;</span>input<span class="sy0">,</span><span class="st_h">'contact.in'</span><span class="br0">&#41;</span>;
  reset<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  assign<span class="br0">&#40;</span>output<span class="sy0">,</span><span class="st_h">'contact.out'</span><span class="br0">&#41;</span>;
  rewrite<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
  w<span class="br0">&#91;</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">:=</span><span class="nu0">1</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> <span class="nu0">13</span> <span class="kw1">do</span>
    w<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="sy0">:=</span>w<span class="br0">&#91;</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">*</span><span class="nu0">2</span>;
  <span class="kw3">readln</span><span class="br0">&#40;</span>a<span class="sy0">,</span>b<span class="sy0">,</span>n<span class="br0">&#41;</span>;
  c<span class="sy0">:=</span><span class="st_h">''</span>;
  <span class="kw1">while</span> <span class="kw1">not</span> <span class="kw3">eof</span> <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw3">readln</span><span class="br0">&#40;</span>cc<span class="br0">&#41;</span>;
      c<span class="sy0">:=</span>c<span class="sy0">+</span>cc;
    <span class="kw1">end</span>;
<span class="co1">//  out_put(3);</span>
  <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">if</span> i&gt;length<span class="br0">&#40;</span>c<span class="br0">&#41;</span> <span class="kw1">then</span> <span class="kw1">break</span>;
      x<span class="sy0">:=</span><span class="nu0">0</span>;
      s<span class="sy0">:=</span>copy<span class="br0">&#40;</span>c<span class="sy0">,</span><span class="nu0">1</span><span class="sy0">,</span>i<span class="br0">&#41;</span>;
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">1</span> <span class="kw1">to</span> i <span class="kw1">do</span>
        x<span class="sy0">:=</span>x<span class="sy0">+</span><span class="br0">&#40;</span><span class="kw3">ord</span><span class="br0">&#40;</span>s<span class="br0">&#91;</span>j<span class="br0">&#93;</span><span class="br0">&#41;</span><span class="sy0">-</span><span class="kw3">ord</span><span class="br0">&#40;</span><span class="st_h">'0'</span><span class="br0">&#41;</span><span class="br0">&#41;</span><span class="sy0">*</span>w<span class="br0">&#91;</span>i<span class="sy0">-</span>j<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
<span class="co1">//      out_put(x);</span>
      inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">2</span> <span class="kw1">to</span> length<span class="br0">&#40;</span>c<span class="br0">&#41;</span><span class="sy0">-</span>i<span class="sy0">+</span><span class="nu0">1</span> <span class="kw1">do</span>
        <span class="kw1">begin</span>
          x<span class="sy0">:=</span>x <span class="kw1">shl</span> <span class="nu0">1</span>;
          <span class="kw1">if</span> c<span class="br0">&#91;</span>j<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span>
            x<span class="sy0">:=</span>x <span class="kw1">xor</span> w<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>;
          <span class="kw1">if</span> c<span class="br0">&#91;</span>j<span class="sy0">+</span>i<span class="sy0">-</span><span class="nu0">1</span><span class="br0">&#93;</span><span class="sy0">=</span><span class="st_h">'1'</span> <span class="kw1">then</span> x<span class="sy0">:=</span>x <span class="kw1">xor</span> <span class="nu0">1</span>;
          inc<span class="br0">&#40;</span>f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>x<span class="br0">&#93;</span><span class="br0">&#41;</span>;
 <span class="co1">//         out_put(x);</span>
        <span class="kw1">end</span>;
    <span class="kw1">end</span>;
  close<span class="br0">&#40;</span>input<span class="br0">&#41;</span>;
  <span class="kw1">for</span> i<span class="sy0">:=</span>a <span class="kw1">to</span> b <span class="kw1">do</span>
    <span class="kw1">begin</span>
      <span class="kw1">for</span> j<span class="sy0">:=</span><span class="nu0">0</span> <span class="kw1">to</span> <span class="nu0">8192</span> <span class="kw1">do</span>
        <span class="kw1">if</span> f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span>&gt;<span class="nu0">0</span> <span class="kw1">then</span>
          <span class="kw1">begin</span>
            inc<span class="br0">&#40;</span>ansm<span class="br0">&#41;</span>;
            ans<span class="br0">&#91;</span>ansm<span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">:=</span>f<span class="br0">&#91;</span>i<span class="br0">&#93;</span><span class="br0">&#91;</span>j<span class="br0">&#93;</span>;
            ans<span class="br0">&#91;</span>ansm<span class="br0">&#93;</span>.<span class="me1">v</span><span class="sy0">:=</span>j;
            ans<span class="br0">&#91;</span>ansm<span class="br0">&#93;</span>.<span class="me1">mm</span><span class="sy0">:=</span>i;
          <span class="kw1">end</span>;
    <span class="kw1">end</span>;
    qsort<span class="br0">&#40;</span><span class="nu0">1</span><span class="sy0">,</span>ansm<span class="br0">&#41;</span>;
    i<span class="sy0">:=</span><span class="nu0">1</span>;
    x<span class="sy0">:=</span><span class="nu0">1</span>;
    kk<span class="sy0">:=</span><span class="nu0">0</span>;
    <span class="kw1">while</span> i&lt;<span class="sy0">=</span>ansm <span class="kw1">do</span>
      <span class="kw1">begin</span>
        zz<span class="sy0">:=</span><span class="nu0">0</span>;
        a<span class="sy0">:=</span><span class="nu0">1</span>;
        inc<span class="br0">&#40;</span>kk<span class="br0">&#41;</span>;
        <span class="kw1">while</span> ans<span class="br0">&#91;</span>i<span class="sy0">+</span><span class="nu0">1</span><span class="br0">&#93;</span>.<span class="me1">num</span><span class="sy0">=</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span> <span class="kw1">do</span> <span class="kw1">begin</span>
          inc<span class="br0">&#40;</span>i<span class="br0">&#41;</span>;inc<span class="br0">&#40;</span>a<span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
        <span class="kw3">writeln</span><span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">num</span><span class="br0">&#41;</span>;
        <span class="kw1">for</span> b<span class="sy0">:=</span>x <span class="kw1">to</span> i<span class="sy0">-</span><span class="nu0">1</span> <span class="kw1">do</span> <span class="kw1">begin</span>
          out_put<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>b<span class="br0">&#93;</span>.<span class="me1">v</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>b<span class="br0">&#93;</span>.<span class="me1">mm</span><span class="br0">&#41;</span>;
          inc<span class="br0">&#40;</span>zz<span class="br0">&#41;</span>;  <span class="kw1">if</span> zz <span class="kw1">mod</span> <span class="nu0">6</span><span class="sy0">=</span><span class="nu0">0</span> <span class="kw1">then</span> <span class="kw3">writeln</span> <span class="kw1">else</span>
          <span class="kw3">write</span><span class="br0">&#40;</span><span class="st_h">' '</span><span class="br0">&#41;</span>;
          <span class="kw1">end</span>;
        out_put<span class="br0">&#40;</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">v</span><span class="sy0">,</span>ans<span class="br0">&#91;</span>i<span class="br0">&#93;</span>.<span class="me1">mm</span><span class="br0">&#41;</span>;
        <span class="kw3">writeln</span>;
        x<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
        i<span class="sy0">:=</span>i<span class="sy0">+</span><span class="nu0">1</span>;
        <span class="kw1">if</span> kk&gt;<span class="sy0">=</span>n <span class="kw1">then</span> <span class="kw1">break</span>;
      <span class="kw1">end</span>;
  close<span class="br0">&#40;</span>output<span class="br0">&#41;</span>;
<span class="kw1">end</span>.</pre></div></div>

<!-- 
NewPP limit report
Preprocessor node count: 253/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key newnocow:pcache:idhash:382-0!*!*!!zh-cn!*!* and timestamp 20141218015923 -->
</div><div class="printfooter">
来自“<a href="http://www.nocow.cn/index.php?title=Code:USACO/contact/Pascal&amp;oldid=34260">http://www.nocow.cn/index.php?title=Code:USACO/contact/Pascal&amp;oldid=34260</a>”</div>
		<div id='catlinks' class='catlinks catlinks-allhidden'></div>		<!-- end content -->
				<div class="visualClear"></div>
	</div>
</div></div>
<div id="column-one">
	<div id="p-cactions" class="portlet">
		<h5>查看</h5>
		<div class="pBody">
			<ul>
				<li id="ca-nstab-code" class="selected"><a href="/index.php/Code:USACO/contact/Pascal">代码</a></li>
				<li id="ca-talk" class="new"><a href="/index.php?title=Code_Talk:USACO/contact/Pascal&amp;action=edit&amp;redlink=1" title="关于内容页面的讨论 [t]" accesskey="t">讨论</a></li>
				<li id="ca-edit"><a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=edit" title="你可以编辑本页。请在保存前预览一下。 [e]" accesskey="e">编辑</a></li>
				<li id="ca-history"><a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=history" title="本页面的早前修订版本 [h]" accesskey="h">历史</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-personal">
		<h5>个人工具</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="/index.php?title=%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E7%99%BB%E5%BD%95&amp;returnto=Code%3AUSACO%2Fcontact%2FPascal" title="我们希望您可以登入，但不强求 [o]" accesskey="o">登录/创建账户</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a title="访问首页" style="background-image: url(/skins/common/images/wiki.png);" href="/index.php/%E9%A6%96%E9%A1%B5"></a>
	</div>
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class="generated-sidebar portlet" id="p-navigation">
		<h5>导航</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage"><a href="/index.php/%E9%A6%96%E9%A1%B5" title="访问首页 [z]" accesskey="z">首页</a></li>
				<li id="n-portal"><a href="/index.php/NOCOW:%E7%A4%BE%E5%8C%BA%E4%B8%BB%E9%A1%B5" title="关于本项目，你可以做什么，在哪里找到你需要的事物">社区主页</a></li>
				<li id="n-currentevents"><a href="/index.php/NOCOW:NOCOW%E8%BF%91%E6%9C%9F%E5%8F%91%E5%B1%95%E8%AE%A1%E5%88%92" title="查看当前事件的背景信息">当前事件</a></li>
				<li id="n-recentchanges"><a href="/index.php/%E7%89%B9%E6%AE%8A:%E6%9C%80%E8%BF%91%E6%9B%B4%E6%94%B9" title="本wiki的最近更改列表 [r]" accesskey="r">最近更改</a></li>
				<li id="n-randompage"><a href="/index.php/%E7%89%B9%E6%AE%8A:%E9%9A%8F%E6%9C%BA%E9%A1%B5%E9%9D%A2" title="随机进入一个页面 [x]" accesskey="x">随机页面</a></li>
				<li id="n-help"><a href="/index.php/%E5%B8%AE%E5%8A%A9:%E7%9B%AE%E5%BD%95" title="寻求帮助的地方">使用帮助</a></li>
				<li id="n-sitemap-text"><a href="/index.php/NOCOW%E5%9C%B0%E5%9B%BE">NOCOW地图</a></li>
				<li id="n-sandbox-text"><a href="/index.php/NOCOW:%E6%96%B0%E6%89%8B%E8%AF%95%E7%BB%83%E5%9C%BA">新手试练场</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">搜索</label></h5>
		<div id="searchBody" class="pBody">
			<form action="/index.php" id="searchform">
				<input type='hidden' name="title" value="特殊:搜索"/>
				<input type="search" name="search" title="在NOCOW中搜索 [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="进入" title="如果相同的标题存在的话便直接前往该页面" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="搜索" title="搜索含这些文字的页面" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>工具箱</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="/index.php/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%85%A5%E9%A1%B5%E9%9D%A2/Code:USACO/contact/Pascal" title="所有链入本页的wiki页面列表 [j]" accesskey="j">链入页面</a></li>
				<li id="t-recentchangeslinked"><a href="/index.php/%E7%89%B9%E6%AE%8A:%E9%93%BE%E5%87%BA%E6%9B%B4%E6%94%B9/Code:USACO/contact/Pascal" title="本页链入的页面的最近更改 [k]" accesskey="k">链出更改</a></li>
				<li id="t-specialpages"><a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%89%B9%E6%AE%8A%E9%A1%B5%E9%9D%A2" title="所有特殊页面列表 [q]" accesskey="q">特殊页面</a></li>
				<li><a href="/index.php?title=Code:USACO/contact/Pascal&amp;printable=yes" rel="alternate">可打印版</a></li>
				<li id="t-permalink"><a href="/index.php?title=Code:USACO/contact/Pascal&amp;oldid=34260" title="本页面该修订版本的永久链接">永久链接</a></li>
			</ul>
		</div>
	</div>
</div><!-- end of the left (by default at least) column -->
<div class="visualClear"></div>
<div id="footer">
	<div id="f-copyrightico">
		<a href="http://www.gnu.org/copyleft/fdl.html"><img src="/skins/common/images/gnu-fdl.png" alt="GNU Free Documentation License 1.2" width="88" height="31" /></a>
	</div>
	<div id="f-poweredbyico">
		<a href="http://www.mediawiki.org/"><img src="/skins/common/images/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" width="88" height="31" /></a>
	</div>
	<ul id="f-list">
		<li id="viewcount">此页面已被浏览过11,623次。</li>
		<li id="credits">本页面由NOCOW用户<a href="/index.php?title=%E7%94%A8%E6%88%B7:Shooter&amp;action=edit&amp;redlink=1" class="new" title="用户:Shooter（尚未撰写）">Shooter</a>于2014年2月10日 (星期一) 23:15做出最后修改。 在NOCOW匿名用户<a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/61.141.0.202" title="特殊:用户贡献/61.141.0.202">61.141.0.202</a>、<a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/60.177.24.152" title="特殊:用户贡献/60.177.24.152">60.177.24.152</a>、<a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/218.71.239.67" title="特殊:用户贡献/218.71.239.67">218.71.239.67</a>和<a href="/index.php/%E7%89%B9%E6%AE%8A:%E7%94%A8%E6%88%B7%E8%B4%A1%E7%8C%AE/119.184.119.134" title="特殊:用户贡献/119.184.119.134">119.184.119.134</a>和<a href="/index.php?title=Code:USACO/contact/Pascal&amp;action=credits" title="Code:USACO/contact/Pascal">其他</a>的工作基础上。</li>
		<li id="copyright">本站全部文字内容使用<a class="external" href="http://www.gnu.org/copyleft/fdl.html">GNU Free Documentation License 1.2</a>授权。</li>
		<li id="privacy"><a href="/index.php/NOCOW:%E9%9A%90%E7%A7%81%E6%9D%83%E6%94%BF%E7%AD%96" title="NOCOW:隐私权政策">隐私权政策</a></li>
		<li id="about"><a href="/index.php/NOCOW:%E5%85%B3%E4%BA%8E" title="NOCOW:关于">关于NOCOW</a></li>
		<li id="disclaimer"><a href="/index.php/NOCOW:%E5%85%8D%E8%B4%A3%E5%A3%B0%E6%98%8E" title="NOCOW:免责声明">免责声明</a></li>
		<li id="miibeian"><a href="http://www.miibeian.gov.cn" rel="nofollow">陕ICP备09005692号</a></li>
	</ul>
</div>
</div>
<script>if(window.mw){
	mw.loader.load(["mediawiki.user", "mediawiki.util", "mediawiki.page.ready", "mediawiki.legacy.wikibits", "mediawiki.legacy.ajax"]);
}
</script>
<script src="/load.php?debug=false&amp;lang=zh-cn&amp;modules=site&amp;only=scripts&amp;skin=monobook&amp;*"></script>
<script>if(window.mw){
	mw.user.options.set({"ccmeonemails":0,"cols":80,"date":"default","diffonly":0,"disablemail":0,"disablesuggest":0,"editfont":"default","editondblclick":0,"editsection":1,"editsectiononrightclick":0,"enotifminoredits":0,"enotifrevealaddr":0,"enotifusertalkpages":1,"enotifwatchlistpages":0,"extendwatchlist":0,"externaldiff":0,"externaleditor":0,"fancysig":0,"forceeditsummary":0,"gender":"unknown","hideminor":0,"hidepatrolled":0,"highlightbroken":1,"imagesize":2,"justify":0,"math":1,"minordefault":0,"newpageshidepatrolled":0,"nocache":0,"noconvertlink":0,"norollbackdiff":0,"numberheadings":0,"previewonfirst":0,"previewontop":1,"quickbar":5,"rcdays":7,"rclimit":50,"rememberpassword":0,"rows":25,"searchlimit":20,"showhiddencats":0,"showjumplinks":1,"shownumberswatching":1,"showtoc":1,"showtoolbar":1,"skin":"monobook","stubthreshold":0,"thumbsize":2,"underline":2,"uselivepreview":0,"usenewrc":0,"watchcreations":0,"watchdefault":0,"watchdeletion":0,"watchlistdays":3,"watchlisthideanons":0,
	"watchlisthidebots":0,"watchlisthideliu":0,"watchlisthideminor":0,"watchlisthideown":0,"watchlisthidepatrolled":0,"watchmoves":0,"wllimit":250,"variant":"zh-cn","language":"zh-cn","searchNs0":true,"searchNs1":false,"searchNs2":false,"searchNs3":false,"searchNs4":false,"searchNs5":false,"searchNs6":false,"searchNs7":false,"searchNs8":false,"searchNs9":false,"searchNs10":false,"searchNs11":false,"searchNs12":false,"searchNs13":false,"searchNs14":false,"searchNs15":false,"searchNs100":true,"searchNs101":false,"searchNs102":true,"searchNs103":false,"searchNs104":false,"searchNs105":false,"searchNs106":true,"searchNs107":false,"searchNs108":true,"searchNs109":false,"searchNs110":true,"searchNs111":false,"searchNs112":true,"searchNs113":false,"searchNs114":true,"searchNs115":true,"searchNs116":true,"searchNs117":false,"searchNs118":true,"searchNs119":false,"searchNs120":true,"searchNs121":false,"searchNs122":true,"searchNs123":false,"searchNs124":true,"searchNs125":false,"searchNs126":true,
	"searchNs127":false});;mw.user.tokens.set({"editToken":"+\\","watchToken":false});;mw.loader.state({"user.options":"ready","user.tokens":"ready"});
	
	/* cache key: newnocow:resourceloader:filter:minify-js:4:9d09b6dc2353a89934e2338dc02930d3 */
}
</script><!-- Served in 1.202 secs. --><!-- google analytics -->
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-8008676-1");
pageTracker._trackPageview();
} catch(err) {}
</script></body></html>